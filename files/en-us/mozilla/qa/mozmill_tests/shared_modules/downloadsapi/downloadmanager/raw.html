
<p>This class simplifies the access of the Download Manager window for Firefox.</p>
<h2 id="Method_overview">Method overview</h2>
<table class="standard-table" style=""> <tbody> <tr> <td><code><a href="#downloadManager.28.29">downloadManager</a>();</code></td> </tr> <tr> <td><code><a href="#cancelActiveDownloads.28.29">cancelActiveDownloads</a>();</code></td> </tr> <tr> <td><a href="/en/Mozmill_Tests/Shared_Modules/DownloadsAPI/downloadManager#cleanAll" title="en/Mozmill Tests/Shared Modules/DownloadsAPI/downloadManager#cleanAll">cleanAll</a>();</td> </tr> <tr> <td><code><a href="#cleanUp.28.29">cleanUp</a>();</code></td> </tr> <tr> <td><code><a href="#close.28.29">close</a>(in boolean force);</code></td> </tr> <tr> <td><code><a href="#deleteDownloadedFiles.28.29">deleteDownloadedFiles</a>(in array {{ interface("nsIDownload") }} downloads);</code></td> </tr> <tr> <td><code>array </code><code>{{ interface("nsIDownload") }}</code><code> <a href="#getAllDownloads.28.29" title="#getAllDownloads.28.29">getAllDownloads</a>();<br> </code></td> </tr> <tr> <td><a href="/en/Mozmill_Tests/Shared_Modules/DownloadsAPI#downloadState_constants" title="en/Mozmill Tests/Shared Modules/DownloadsAPI#downloadState constants"><span style="font-family: monospace;">downloadState</span></a><code> </code><code><a href="#getDownloadState.28.29">getDownloadState</a>(in <a href="/en/Mozmill/Mozmill_Elements_Library_Object" title="en/Mozmill/Mozmill Elements
            Library Object">ElemBase</a> download);</code></td> </tr> <tr> <td><code><a href="/en/Mozmill/Mozmill_Elements_Library_Object" title="en/Mozmill/Mozmill Elements
            Library Object">ElemBase</a> <a href="#getElement.28.29" title="#getElement.28.29">getElement</a>(in object spec);</code></td> </tr> <tr> <td><code><a href="#open.28.29" title="#open.28.29">open</a>(in <code><a href="/en/Mozmill/Mozmill_Base_Object_Interfaces#mozmill.controller.MozMillController" title="en/Mozmill/Mozmill Base Object
            Interfaces#mozmill.controller.MozMillController">MozMillController</a> controller, in boolean shortcut);</code><br> </code></td> </tr> <tr> <td><code><a href="#waitForDownloadState.28.29">waitForDownloadState</a>(in <a href="/en/Mozmill/Mozmill_Elements_Library_Object" title="en/Mozmill/Mozmill Elements
            Library Object">ElemBase</a> download, in </code><a href="/en/Mozmill_Tests/Shared_Modules/DownloadsAPI#downloadState_constants" title="en/Mozmill Tests/Shared Modules/DownloadsAPI#downloadState
            constants"><span style="font-family: monospace;">downloadState</span></a><code> state, in number timeout</code><code>);</code></td> </tr> <tr> <td><code><a href="#waitForOpened.28.29" title="#waitForOpened.28.29">waitForOpened</a>(<code>in <a href="/en/Mozmill/Mozmill_Base_Object_Interfaces#mozmill.controller.MozMillController" title="en/Mozmill/Mozmill Base Object
            Interfaces#mozmill.controller.MozMillController">MozMillController</a> controller);</code></code></td> </tr> </tbody>
</table>
<h2 id="Attributes">Attributes</h2>
<table class="standard-table"> <thead> <tr> <th scope="col">Attribute</th> <th scope="col">Type</th> <th scope="col">Description</th> </tr> </thead> <tbody> <tr> <td><code>controller</code></td> <td><code><code> <a href="/en/Mozmill/Mozmill_Base_Object_Interfaces#mozmill.controller.MozMillController" title="en/Mozmill/Mozmill Base Object
            Interfaces#mozmill.controller.MozMillController">MozMillController</a></code></code></td> <td>Controller of the current Download Manager window</td> </tr> <tr> <td><code>activeDownloadCount</code></td> <td><code>number</code></td> <td>Count of currently active downloads.</td> </tr> </tbody>
</table>
<h2 id="Methods">Methods</h2>
<h3 id="downloadManager.28.29" name="downloadManager.28.29">downloadManager()</h3>
<p>The constructor of the class.</p>
<pre>downloadManager();
</pre>
<p>cancelActiveDownloads()</p>
<p>Cancel all active downloads.</p>
<pre><code>cancelActiveDownloads();</code></pre>
<h3 id="cleanAll()"><a name="cleanAll">cleanAll()</a></h3><a name="cleanAll">
<p>Cancels any active downloads, removes any downloaded files, and cleans up the Download Manager database.</p>
<pre>cleanAll();
</pre>
<h3 id="cleanUp()">cleanUp()</h3>
<p>Remove all downloads from the database.</p>
<pre>cleanUp();
</pre>
<h3 id="close.28.29" name="close.28.29">close()</h3>
<p>Close the Download Manager window.</p>
<pre><code>close(in boolean force);</code></pre>
<h6 id="Parameters">Parameters</h6>
<dl> <dt>force</dt> <dd>Force the closing of the DM window. When set to <code>true </code>the window will be closed by calling <code>window.close()</code>.</dd>
</dl>
<h3 id="deleteDownloadedFiles.28.29" name="deleteDownloadedFiles.28.29">deleteDownloadedFiles()</h3>
<p>Delete all the downloaded files from the local drive.</p>
</a><pre><a name="cleanAll"><code>deleteDownloadedFiles(<br>  in array </code></a><a title="en/nsIDownload"><code>nsIDownload</code></a><code> downloads<br>);</code></pre>
<h6 id="Parameters_2">Parameters</h6>
<dl> <dt>downloads</dt> <dd>List of <code>{{ interface("nsIDownload") }} instances</code> which specify the to be removed downloads.</dd>
</dl>
<h3 id="getAllDownloads.28.29" name="getAllDownloads.28.29">getAllDownloads()</h3>
<p>Get the list of all downloaded files from the sqlite3 database.</p>
<pre><code>array </code><code><a title="en/nsIDownload">nsIDownload</a> </code><code>getAllDownloads();</code></pre>
<h6 id="Return_value">Return value</h6>
<p>A list of <code>{{ interface("nsIDownload") }} instances </code>from the database.</p>
<h3 id="getDownloadState.28.29" name="getDownloadState.28.29">getDownloadState()</h3>
<p>Retrieves the download state of the given download.</p>
<pre><code><a title="en/Mozmill Tests/Shared
            Modules/DownloadsAPI#downloadState">downloadState</a> get</code><code>DownloadState(<br>  in <a title="en/Mozmill/Mozmill Elements
            Library Object">ElemBase</a> download<br>);</code></pre>
<h6 id="Parameters_3">Parameters</h6>
<dl> <dt>download</dt>
</dl>
<dl> <dd>Download which state should be checked</dd>
</dl>
<h6 id="Return_value_2">Return value</h6>
<p>The <a href="/en/Mozmill_Tests/Shared_Modules/DownloadsAPI#downloadState" title="en/Mozmill Tests/Shared Modules/DownloadsAPI#downloadState">download state</a> of the given download.</p>
<h3 id="getElement.28.29" name="getElement.28.29">getElement()</h3>
<p>Retrieve an UI element based on the given spec object.</p>
<pre><code><a title="en/Mozmill/Mozmill Elements
            Library Object">ElemBase</a> getElement(<br>  in object spec<br>);</code></pre>
<h6 id="Parameters_4">Parameters</h6>
<dl> <dt>spec</dt> <dd>JSON object which specifies the element to retrieve. Use <code>its </code>attributes to specify the exact element. This <a href="#Examples" title="#examples">example</a> will show the correct usage.<br> <table class="standard-table"> <thead> <tr> <th scope="col">spec.typeÂ  (<code>string</code>)<span id="1266966869729S" style="display: none;"><br> </span></th> <th scope="col">spec.subtype (<code>string</code>)</th> <th scope="col">spec.value (<code>mixed</code>)</th> <th scope="col">Description</th> </tr> </thead> <tbody> <tr> <td><code>"download</code>"</td> <td><code>nodeName<br> </code></td> <td><code>nodeValue (string)<br> </code></td> <td>Get the download specified by any node of the richtlistbox entry.</td> </tr> <tr> <td><code>"download_button"</code></td> <td><code>"cancel"<br> </code></td> <td><code>Download (<a href="/en/Mozmill/Mozmill_Elements_Library_Object" title="en/Mozmill/Mozmill Elements Library Object">ElemBase</a>)<br> </code></td> <td>Get the cancel button of the specified download.</td> </tr> <tr> <td><code>"download_button"</code></td> <td><code>"pause"</code></td> <td><code>Download (<a href="/en/Mozmill/Mozmill_Elements_Library_Object" title="en/Mozmill/Mozmill Elements Library
                Object">ElemBase</a>)</code></td> <td>Get the pause button of the specified download.</td> </tr> <tr> <td><code>"download_button"</code></td> <td><code>"resume"<br> </code></td> <td><code>Download (<a href="/en/Mozmill/Mozmill_Elements_Library_Object" title="en/Mozmill/Mozmill Elements Library
                Object">ElemBase</a>)</code></td> <td>Get the resume button of the specified download.</td> </tr> <tr> <td><code>"download_button"</code></td> <td><code>"retry"<br> </code></td> <td><code>Download (<a href="/en/Mozmill/Mozmill_Elements_Library_Object" title="en/Mozmill/Mozmill Elements Library
                Object">ElemBase</a>)</code></td> <td>Get the retry button of the specified download.</td> </tr> </tbody> </table> </dd>
</dl>
<h6 id="Return_value_3">Return value</h6>
<p><a href="/en/Mozmill_Tests/Shared_Modules/DownloadsAPI/downloadManager#getElement.28.29" title="https://developer.mozilla.org/en/Mozmill_Tests/Shared_Modules/DownloadsAPI/downloadManager#getElement.28.29">ElemBase</a> instance of the requested element which matches the specifications.</p>
<h3 id="open.28.29" name="open.28.29">open()</h3>
<p>Open the Download Manager.</p>
<pre><code>open(<br>  in <code><a title="en/Mozmill/Mozmill Base Object
            Interfaces#mozmill.controller.MozMillController">MozMillController</a> controller,<br>  in boolean shortcut<br>);</code></code></pre>
<h6 id="Parameters_5">Parameters</h6>
<dl> <dt>controller</dt> <dd>MozMillController of the browser window to operate on</dd> <dt>shortcut</dt> <dd>If <code>true</code> the keyboard shortcut is used to open the Download Manager window.</dd>
</dl>
<h3 id="waitForDownloadState.28.29" name="waitForDownloadState.28.29">waitForDownloadState()</h3>
<p>Waits until the given download has the expected download state or a timeout occurs.</p>
<pre><code>get</code><code>DownloadState(<br>  in <a title="en/Mozmill/Mozmill Elements
            Library Object">ElemBase</a> download,<br>  in </code><code><a title="en/Mozmill Tests/Shared
            Modules/DownloadsAPI#downloadState">downloadState</a></code><code> state,<br>  in number timeout<br>);</code></pre>
<h6 id="Parameters_6">Parameters</h6>
<dl> <dt>download</dt>
</dl>
<dl> <dd>Download which state should be checked</dd> <dt>state</dt> <dd>The <a href="/en/Mozmill_Tests/Shared_Modules/DownloadsAPI#downloadState" title="en/Mozmill Tests/Shared
    Modules/DownloadsAPI#downloadState">download state</a> to wait for.</dd> <dt>timeout</dt> <dd>(Optional) Maximal duration to wait before a timeout occurs.</dd>
</dl>
<h6 id="Return_value_4">Return value</h6>
<p>None.</p>
<h3 id="waitForOpened.28.29" name="waitForOpened.28.29">waitForOpened()</h3>
<p>Wait until the Download Manager window has been opened.</p>
<pre><code>waitForOpened(<br>  <code>in <a title="en/Mozmill/Mozmill Base Object
            Interfaces#mozmill.controller.MozMillController">MozMillController</a> controller<br>);</code></code></pre>
<h6 id="Parameters_7">Parameters</h6>
<dl> <dt>controller</dt> <dd>MozMillController of the Download Manager window to operate on.</dd>
</dl>
<h2 id="Examples">Examples</h2>
<p>In the example below the Download Manager gets opened by using the keyboard shortcut. Afterward the download with the specified URL is retrieved and used to get its resume button. With the click the download will be resumed. Finally the Download Manager gets closed again.</p>
<pre class="brush: js">var RELATIVE_ROOT = '../../shared-modules';
var MODULE_REQUIRES = ['DownloadsAPI'];

var setupModule = function(module)
{
  module.controller = mozmill.getBrowserController();
  module.dm = new DownloadsAPI.downloadManager();
}

var testResumeDownload = function()
{
  dm.open(controller, true);

  var download = dm.getElement({type: "download", subtype: "uri", value: "http://www.mozilla.org/favicon.ico"});
  var resumeButton = dm.getElement({type: "download_button", subtype: "resume", value: download});

  controller.click(resumeButton);

  dm.close();
}
</pre>
