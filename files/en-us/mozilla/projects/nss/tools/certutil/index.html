---
title: certutil
slug: Mozilla/Projects/NSS/Tools/certutil
---
<p>Name<br>
<br>
&nbsp;&nbsp; certutil â€” Manage keys and certificate in the NSS database.<br>
<br>
Synopsis<br>
<br>
&nbsp;&nbsp; certutil [options] <a href="arguments">arguments</a><br>
<br>
Description<br>
<br>
&nbsp;&nbsp; The Certificate Database Tool, certutil, is a command-line utility that<br>
&nbsp;&nbsp; can create and modify certificate and key database files. It can also<br>
&nbsp;&nbsp; list, generate, modify, or delete certificates within the database, create<br>
&nbsp;&nbsp; or change the password, generate new public and private key pairs, display<br>
&nbsp;&nbsp; the contents of the key database, or delete key pairs within the key<br>
&nbsp;&nbsp; database.<br>
<br>
&nbsp;&nbsp; The key and certificate management process generally begins with creating<br>
&nbsp;&nbsp; keys in the key database, then generating and managing certificates in the<br>
&nbsp;&nbsp; certificate database. This document discusses certificate and key database<br>
&nbsp;&nbsp; management. For information security module database management, see the<br>
&nbsp;&nbsp; modutil manpages.<br>
<br>
Options and Arguments<br>
<br>
&nbsp;&nbsp; Running certutil always requires one (and only one) option to specify the<br>
&nbsp;&nbsp; type of certificate operation. Each option may take arguments, anywhere<br>
&nbsp;&nbsp; from none to multiple arguments. Run the command option and -H to see the<br>
&nbsp;&nbsp; arguments available for each command option.<br>
<br>
&nbsp;&nbsp; Options<br>
<br>
&nbsp;&nbsp; Options specify an action and are uppercase.<br>
<br>
&nbsp;&nbsp; -A<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add an existing certificate to a certificate database. The<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate database should already exist; if one is not present,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this option will initialize one by default.<br>
<br>
&nbsp;&nbsp; -B<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Run a series of commands from the specified batch file. This<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requires the -i argument.<br>
<br>
&nbsp;&nbsp; -C<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create a new binary certificate file from a binary certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request file. Use the -i argument to specify the certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request file. If this argument is not used, certutil prompts for a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filename.<br>
<br>
&nbsp;&nbsp; -D<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Delete a certificate from the certificate database.<br>
<br>
&nbsp;&nbsp; -E<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add an email certificate to the certificate database.<br>
<br>
&nbsp;&nbsp; -F<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Delete a private key from a key database. Specify the key to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete with the -n argument. Specify the database from which to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete the key with the -d argument. Use the -k argument to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specify explicitly whether to delete a DSA, RSA, or ECC key. If<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; you don't use the -k argument, the option looks for an RSA key<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; matching the specified nickname.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When you delete keys, be sure to also remove any certificates<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; associated with those keys from the certificate database, by using<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -D. Some smart cards (for example, the Litronic card) do not let<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; you remove a public key you have generated. In such a case, only<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the private key is deleted from the key pair. You can display the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public key with the command certutil -K -h tokenname.<br>
<br>
&nbsp;&nbsp; -G<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Generate a new public and private key pair within a key database.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The key database should already exist; if one is not present, this<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; option will initialize one by default. Some smart cards (for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; example, the Litronic card) can store only one key pair. If you<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; create a new key pair for such a card, the previous pair is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; overwritten.<br>
<br>
&nbsp;&nbsp; -H<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Display a list of the options and arguments used by the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Certificate Database Tool.<br>
<br>
&nbsp;&nbsp; -K<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List the key ID of keys in the key database. A key ID is the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; modulus of the RSA key or the publicValue of the DSA key. IDs are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; displayed in hexadecimal ("0x" is not shown).<br>
<br>
&nbsp;&nbsp; -L<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List all the certificates, or display information about a named<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate, in a certificate database. Use the -h tokenname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; argument to specify the certificate database on a particular<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hardware or software token.<br>
<br>
&nbsp;&nbsp; -M<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Modify a certificate's trust attributes using the values of the -t<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; argument.<br>
<br>
&nbsp;&nbsp; -N<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create new certificate and key databases.<br>
<br>
&nbsp;&nbsp; -O<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Print the certificate chain.<br>
<br>
&nbsp;&nbsp; -R<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create a certificate request file that can be submitted to a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Certificate Authority (CA) for processing into a finished<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate. Output defaults to standard out unless you use -o<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output-file argument. Use the -a argument to specify ASCII output.<br>
<br>
&nbsp;&nbsp; -S<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create an individual certificate and add it to a certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; database.<br>
<br>
&nbsp;&nbsp; -T<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Reset the key database or token.<br>
<br>
&nbsp;&nbsp; -U<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List all available modules or print a single named module.<br>
<br>
&nbsp;&nbsp; -V<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Check the validity of a certificate and its attributes.<br>
<br>
&nbsp;&nbsp; -W<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Change the password to a key database.<br>
<br>
&nbsp;&nbsp; --merge<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Merge a source database into the target database. This is used to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; merge legacy NSS databases (cert8.db and key3.db) into the newer<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQLite databases (cert9.db and key4.db).<br>
<br>
&nbsp;&nbsp; --upgrade-merge<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Upgrade an old database and merge it into a new database. This is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used to migrate legacy NSS databases (cert8.db and key3.db) into<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the newer SQLite databases (cert9.db and key4.db).<br>
<br>
&nbsp;&nbsp; Arguments<br>
<br>
&nbsp;&nbsp; Option arguments modify an action and are lowercase.<br>
<br>
&nbsp;&nbsp; -a<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Use ASCII format or allow the use of ASCII format for input or<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output. This formatting follows RFC 1113. For certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requests, ASCII output defaults to standard output unless<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; redirected.<br>
<br>
&nbsp;&nbsp; -b validity-time<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify a time at which a certificate is required to be valid. Use<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when checking certificate validity with the -V option. The format<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; of the validity-time argument is YYMMDDHHMMSS[+HHMM|-HHMM|Z],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; which allows offsets to be set relative to the validity end time.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specifying seconds (SS) is optional. When specifying an explicit<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time, use a Z at the end of the term, YYMMDDHHMMSSZ, to close it.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; When specifying an offset time, use YYMMDDHHMMSS+HHMM or<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; YYMMDDHHMMSS-HHMM for adding or subtracting time, respectively.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If this option is not used, the validity check defaults to the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; current system time.<br>
<br>
&nbsp;&nbsp; -c issuer<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Identify the certificate of the CA from which a new certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; will derive its authenticity. Use the exact nickname or alias of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the CA certificate, or use the CA's email address. Bracket the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; issuer string with quotation marks if it contains spaces.<br>
<br>
&nbsp;&nbsp; -d [sql:]directory<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the database directory containing the certificate and key<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; database files.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certutil supports two types of databases: the legacy security<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; databases (cert8.db, key3.db, and secmod.db) and new SQLite<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; databases (cert9.db, key4.db, and pkcs11.txt). If the prefix sql:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is not used, then the tool assumes that the given databases are in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the old format.<br>
<br>
&nbsp;&nbsp; -e<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Check a certificate's signature during the process of validating a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate.<br>
<br>
&nbsp;&nbsp; -f password-file<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify a file that will automatically supply the password to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; include in a certificate or to access a certificate database. This<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is a plain-text file containing one password. Be sure to prevent<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unauthorized access to this file.<br>
<br>
&nbsp;&nbsp; -g keysize<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set a key size to use when generating new public and private key<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pairs. The minimum is 512 bits and the maximum is 8192 bits. The<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default is 1024 bits. Any size between the minimum and maximum is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allowed.<br>
<br>
&nbsp;&nbsp; -h tokenname<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the name of a token to use or act on. Unless specified<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; otherwise the default token is an internal slot (specifically,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal slot 2). This slot can also be explicitly named with the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string "internal". An internal slots is a virtual slot maintained<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in software, rather than a hardware device. Internal slot 2 is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used by key and certificate services. Internal slot 1 is used by<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cryptographic services.<br>
<br>
&nbsp;&nbsp; -i input_file<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pass an input file to the command. Depending on the command<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; option, an input file can be a specific certificate, a certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request file, or a batch file of commands.<br>
<br>
&nbsp;&nbsp; -k rsa|dsa|ec|all<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the type of a key. The valid options are RSA, DSA, ECC, or<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; all. The default value is rsa. Specifying the type of key can<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; avoid mistakes caused by duplicate nicknames.<br>
<br>
&nbsp;&nbsp; -k key-type-or-id<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the type or specific ID of a key. Giving a key type<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; generates a new key pair; giving the ID of an existing key reuses<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that key pair (which is required to renew certificates).<br>
<br>
&nbsp;&nbsp; -l<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Display detailed information when validating a certificate with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the -V option.<br>
<br>
&nbsp;&nbsp; -m serial-number<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assign a unique serial number to a certificate being created. This<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; operation should be performed by a CA. The default serial number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is 0 (zero). Serial numbers are limited to integers.<br>
<br>
&nbsp;&nbsp; -n nickname<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the nickname of a certificate or key to list, create, add<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to a database, modify, or validate. Bracket the nickname string<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with quotation marks if it contains spaces.<br>
<br>
&nbsp;&nbsp; -o output-file<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the output file name for new certificates or binary<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate requests. Bracket the output-file string with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; quotation marks if it contains spaces. If this argument is not<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used the output destination defaults to standard output.<br>
<br>
&nbsp;&nbsp; -P dbPrefix<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the prefix used on the certificate and key database file.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This option is provided as a special case. Changing the names of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the certificate and key databases is not recommended.<br>
<br>
&nbsp;&nbsp; -p phone<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify a contact telephone number to include in new certificates<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or certificate requests. Bracket this string with quotation marks<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if it contains spaces.<br>
<br>
&nbsp;&nbsp; -q pqgfile<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Read an alternate PQG value from the specified file when<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; generating DSA key pairs. If this argument is not used, certutil<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; generates its own PQG value. PQG files are created with a separate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DSA utility.<br>
<br>
&nbsp;&nbsp; -q curve-name<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set the elliptic curve name to use when generating ECC key pairs.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A complete list of ECC curves is given in the help (-H).<br>
<br>
&nbsp;&nbsp; -r<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Display a certificate's binary DER encoding when listing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; information about that certificate with the -L option.<br>
<br>
&nbsp;&nbsp; -s subject<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Identify a particular certificate owner for new certificates or<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate requests. Bracket this string with quotation marks if<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; it contains spaces. The subject identification format follows RFC<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #1485.<br>
<br>
&nbsp;&nbsp; -t trustargs<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify the trust attributes to modify in an existing certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or to apply to a certificate when creating it or adding it to a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; database. There are three available trust categories for each<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate, expressed in the order SSL, email, object signing for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; each trust setting. In each category position, use none, any, or<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; all of the attribute codes:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;p - Valid peer<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;P - Trusted peer (implies p)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;c - Valid CA<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;T - Trusted CA to issue client certificates (implies c)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;C - Trusted CA to issue server certificates (SSL only)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (implies c)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;u - Certificate can be used for authentication or signing<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;w - Send warning (use with other attributes to include a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; warning when the certificate is used in that context)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The attribute codes for the categories are separated by commas,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and the entire set of attributes enclosed by quotation marks. For<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; example:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -t "TCu,Cu,Tuw"<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Use the -L option to see a list of the current certificates and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trust attributes in a certificate database.<br>
<br>
&nbsp;&nbsp; -u certusage<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specify a usage context to apply when validating a certificate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with the -V option.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The contexts are the following:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;C (as an SSL client)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;V (as an SSL server)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;S (as an email signer)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;R (as an email recipient)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;O (as an OCSP status responder)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;J (as an object signer)<br>
<br>
&nbsp;&nbsp; -v valid-months<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set the number of months a new certificate will be valid. The<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; validity period begins at the current system time unless an offset<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is added or subtracted with the -w option. If this argument is not<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; used, the default validity period is three months. When this<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; argument is used, the default three-month period is automatically<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; added to any value given in the valid-month argument. For example,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using this option to set a value of 3 would cause 3 to be added to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the three-month default, creating a validity period of six months.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; You can use negative values to reduce the default period. For<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; example, setting a value of -2 would subtract 2 from the default<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and create a validity period of one month.<br>
<br>
&nbsp;&nbsp; -w offset-months<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set an offset from the current system time, in months, for the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; beginning of a certificate's validity period. Use when creating<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the certificate or adding it to a database. Express the offset in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; integers, using a minus sign (-) to indicate a negative offset. If<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this argument is not used, the validity period begins at the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; current system time. The length of the validity period is set with<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the -v argument.<br>
<br>
&nbsp;&nbsp; -X<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Force the key and certificate database to open in read-write mode.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This is used with the -U and -L command options.<br>
<br>
&nbsp;&nbsp; -x<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Use certutil to generate the signature for a certificate being<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; created or added to a database, rather than obtaining a signature<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from a separate CA.<br>
<br>
&nbsp;&nbsp; -y exp<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set an alternate exponent value to use in generating a new RSA<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public key for the database, instead of the default value of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 65537. The available alternate values are 3 and 17.<br>
<br>
&nbsp;&nbsp; -z noise-file<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Read a seed value from the specified file to generate a new<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private and public key pair. This argument makes it possible to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; use hardware-generated seed values or manually create a value from<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the keyboard. The minimum file size is 20 bytes.<br>
<br>
&nbsp;&nbsp; -0 SSO_password<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set a site security officer password on a token.<br>
<br>
&nbsp;&nbsp; -1 | --keyUsage keyword,keyword<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set a Netscape Certificate Type Extension in the certificate.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; There are several available keywords:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;digital signature<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;nonRepudiation<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;keyEncipherment<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;dataEncipherment<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;keyAgreement<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;certSigning<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;crlSigning<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;critical<br>
<br>
&nbsp;&nbsp; -2<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add a basic constraint extension to a certificate that is being<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; created or added to a database. This extension supports the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate chain verification process. certutil prompts for the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate constraint extension to select.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; -3<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add an authority key ID extension to a certificate that is being<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; created or added to a database. This extension supports the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; identification of a particular certificate, from among multiple<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificates associated with one subject name, as the correct<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; issuer of a certificate. The Certificate Database Tool will prompt<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; you to select the authority key ID extension.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; -4<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add a CRL distribution point extension to a certificate that is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; being created or added to a database. This extension identifies<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the URL of a certificate's associated certificate revocation list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (CRL). certutil prompts for the URL.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; -5 | --nsCertType keyword,keyword<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add a Netscape certificate type extension to a certificate that is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; being created or added to the database. There are several<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; available keywords:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;sslClient<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;sslServer<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;smime<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;objectSigning<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;sslCA<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;smimeCA<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;objectSigningCA<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;critical<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; -6 | --extKeyUsage keyword,keyword<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add an extended key usage extension to a certificate that is being<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; created or added to the database. Several keywords are available:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;serverAuth<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;clientAuth<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;codeSigning<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;emailProtection<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;timeStamp<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;ocspResponder<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;stepUp<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;critical<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; -7 emailAddrs<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add a comma-separated list of email addresses to the subject<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alternative name extension of a certificate or certificate request<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; that is being created or added to the database. Subject<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alternative name extensions are described in Section 4.2.1.7 of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RFC 3280.<br>
<br>
&nbsp;&nbsp; -8 dns-names<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add a comma-separated list of DNS names to the subject alternative<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; name extension of a certificate or certificate request that is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; being created or added to the database. Subject alternative name<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; extensions are described in Section 4.2.1.7 of RFC 3280.<br>
<br>
&nbsp;&nbsp; --extAIA<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add the Authority Information Access extension to the certificate.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; --extSIA<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add the Subject Information Access extension to the certificate.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; --extCP<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add the Certificate Policies extension to the certificate. X.509<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; --extPM<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add the Policy Mappings extension to the certificate. X.509<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; --extPC<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add the Policy Constraints extension to the certificate. X.509<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; --extIA<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add the Inhibit Any Policy Access extension to the certificate.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; X.509 certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; --extSKID<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add the Subject Key ID extension to the certificate. X.509<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate extensions are described in RFC 5280.<br>
<br>
&nbsp;&nbsp; --source-dir certdir<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Identify the certificate database directory to upgrade.<br>
<br>
&nbsp;&nbsp; --source-prefix certdir<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Give the prefix of the certificate and key databases to upgrade.<br>
<br>
&nbsp;&nbsp; --upgrade-id uniqueID<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Give the unique ID of the database to upgrade.<br>
<br>
&nbsp;&nbsp; --upgrade-token-name name<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set the name of the token to use while it is being upgraded.<br>
<br>
&nbsp;&nbsp; -@ pwfile<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Give the name of a password file to use for the database being<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; upgraded.<br>
<br>
Usage and Examples<br>
<br>
&nbsp;&nbsp; Most of the command options in the examples listed here have more<br>
&nbsp;&nbsp; arguments available. The arguments included in these examples are the most<br>
&nbsp;&nbsp; common ones or are used to illustrate a specific scenario. Use the -H<br>
&nbsp;&nbsp; option to show the complete list of arguments for each command option.<br>
<br>
&nbsp;&nbsp; Creating New Security Databases<br>
<br>
&nbsp;&nbsp; Certificates, keys, and security modules related to managing certificates<br>
&nbsp;&nbsp; are stored in three related databases:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;cert8.db or cert9.db<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;key3.db or key4.db<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;secmod.db or pkcs11.txt<br>
<br>
&nbsp;&nbsp; These databases must be created before certificates or keys can be<br>
&nbsp;&nbsp; generated.<br>
<br>
&nbsp;certutil -N -d [sql:]directory<br>
<br>
&nbsp;&nbsp; Creating a Certificate Request<br>
<br>
&nbsp;&nbsp; A certificate request contains most or all of the information that is used<br>
&nbsp;&nbsp; to generate the final certificate. This request is submitted separately to<br>
&nbsp;&nbsp; a certificate authority and is then approved by some mechanism<br>
&nbsp;&nbsp; (automatically or by human review). Once the request is approved, then the<br>
&nbsp;&nbsp; certificate is generated.<br>
<br>
&nbsp;$ certutil -R -k key-type-or-id [-q pqgfile|curve-name] -g key-size -s subject [-h tokenname] -d [sql:]directory [-p phone] [-o output-file] [-a]<br>
<br>
&nbsp;&nbsp; The -R command options requires four arguments:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;-k to specify either the key type to generate or, when renewing a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; certificate, the existing key pair to use<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;-g to set the keysize of the key to generate<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;-s to set the subject name of the certificate<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;-d to give the security database directory<br>
<br>
&nbsp;&nbsp; The new certificate request can be output in ASCII format (-a) or can be<br>
&nbsp;&nbsp; written to a specified file (-o).<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil -R -k ec -q nistb409 -g 512 -s "CN=John Smith,O=Example Corp,L=Mountain View,ST=California,C=US" -d sql:/home/my/sharednssdb -p 650-555-0123 -a -o cert.cer<br>
<br>
&nbsp;Generating key.&nbsp; This may take a few moments...<br>
<br>
<br>
&nbsp;Certificate request generated by Netscape<br>
&nbsp;Phone: 650-555-0123<br>
&nbsp;Common Name: John Smith<br>
&nbsp;Email: (not ed)<br>
&nbsp;Organization: Example Corp<br>
&nbsp;State: California<br>
&nbsp;Country: US<br>
<br>
&nbsp;-----BEGIN NEW CERTIFICATE REQUEST-----<br>
&nbsp;MIIBIDCBywIBADBmMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEW<br>
&nbsp;MBQGA1UEBxMNTW91bnRhaW4gVmlldzEVMBMGA1UEChMMRXhhbXBsZSBDb3JwMRMw<br>
&nbsp;EQYDVQQDEwpKb2huIFNtaXRoMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAMVUpDOZ<br>
&nbsp;KmHnOx7reP8Cc0Lk+fFWEuYIDX9W5K/BioQOKvEjXyQZhit9aThzBVMoSf1Y1S8J<br>
&nbsp;CzdUbCg1+IbnXaECAwEAAaAAMA0GCSqGSIb3DQEBBQUAA0EAryqZvpYrUtQ486Ny<br>
&nbsp;qmtyQNjIi1F8c1Z+TL4uFYlMg8z6LG/J/u1E5t1QqB5e9Q4+BhRbrQjRR1JZx3tB<br>
&nbsp;1hP9Gg==<br>
&nbsp;-----END NEW CERTIFICATE REQUEST-----<br>
<br>
&nbsp;&nbsp; Creating a Certificate<br>
<br>
&nbsp;&nbsp; A valid certificate must be issued by a trusted CA. This can be done by<br>
&nbsp;&nbsp; specifying a CA certificate (-c) that is stored in the certificate<br>
&nbsp;&nbsp; database. If a CA key pair is not available, you can create a self-signed<br>
&nbsp;&nbsp; certificate using the -x argument with the -S command option.<br>
<br>
&nbsp;$ certutil -S -k rsa|dsa|ec -n certname -s subject [-c issuer |-x] -t trustargs -d [sql:]directory [-m serial-number] [-v valid-months] [-w offset-months] [-p phone] [-1] [-2] [-3] [-4] [-5 keyword] [-6 keyword] [-7 emailAddress] [-8 dns-names] [--extAIA] [--extSIA] [--extCP] [--extPM] [--extPC] [--extIA] [--extSKID]<br>
<br>
&nbsp;&nbsp; The series of numbers and --ext* options set certificate extensions that<br>
&nbsp;&nbsp; can be added to the certificate when it is generated by the CA.<br>
<br>
&nbsp;&nbsp; For example, this creates a self-signed certificate:<br>
<br>
&nbsp;$ certutil -S -s "CN=Example CA" -n my-ca-cert -x -t "C,C,C" -1 -2 -5 -m 3650<br>
<br>
&nbsp;&nbsp; From there, new certificates can reference the self-signed certificate:<br>
<br>
&nbsp;$ certutil -S -s "CN=My Server Cert" -n my-server-cert -c "my-ca-cert" -t "u,u,u" -1 -5 -6 -8 -m 730<br>
<br>
&nbsp;&nbsp; Generating a Certificate from a Certificate Request<br>
<br>
&nbsp;&nbsp; When a certificate request is created, a certificate can be generated by<br>
&nbsp;&nbsp; using the request and then referencing a certificate authority signing<br>
&nbsp;&nbsp; certificate (the issuer specified in the -c argument). The issuing<br>
&nbsp;&nbsp; certificate must be in the certificate database in the specified<br>
&nbsp;&nbsp; directory.<br>
<br>
&nbsp;certutil -C -c issuer -i cert-request-file -o output-file [-m serial-number] [-v valid-months] [-w offset-months] -d [sql:]directory [-1] [-2] [-3] [-4] [-5 keyword] [-6 keyword] [-7 emailAddress] [-8 dns-names]<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil -C -c "my-ca-cert" -i /home/certs/cert.req -o cert.cer -m 010 -v 12 -w 1 -d sql:/home/my/sharednssdb -1 nonRepudiation,dataEncipherment -5 sslClient -6 clientAuth -7 <a class=" link-mailto" href="mailto:jsmith@example.com">jsmith@example.com</a><br>
<br>
&nbsp;&nbsp; Generating Key Pairs<br>
<br>
&nbsp;&nbsp; Key pairs are generated automatically with a certificate request or<br>
&nbsp;&nbsp; certificate, but they can also be generated independently using the -G<br>
&nbsp;&nbsp; command option.<br>
<br>
&nbsp;certutil -G -d [sql:]directory | -h tokenname -k key-type -g key-size [-y exponent-value] -q pqgfile|curve-name<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil -G -h lunasa -k ec -g 256 -q sect193r2<br>
<br>
&nbsp;&nbsp; Listing Certificates<br>
<br>
&nbsp;&nbsp; The -L command option lists all of the certificates listed in the<br>
&nbsp;&nbsp; certificate database. The path to the directory (-d) is required.<br>
<br>
&nbsp;$ certutil -L -d sql:/home/my/sharednssdb<br>
<br>
&nbsp;Certificate Nickname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Trust Attributes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SSL,S/MIME,JAR/XPI<br>
<br>
&nbsp;CA Administrator of Instance pki-ca1's Example Domain ID&nbsp;&nbsp;&nbsp;&nbsp; u,u,u<br>
&nbsp;TPS Administrator's Example Domain ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; u,u,u<br>
&nbsp;Google Internet Authority&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ,,<br>
&nbsp;Certificate Authority - Example Domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CT,C,C<br>
<br>
&nbsp;&nbsp; Using additional arguments with -L can return and print the information<br>
&nbsp;&nbsp; for a single, specific certificate. For example, the -n argument passes<br>
&nbsp;&nbsp; the certificate name, while the -a argument prints the certificate in<br>
&nbsp;&nbsp; ASCII format:<br>
<br>
&nbsp;$ certutil -L -d sql:/home/my/sharednssdb -a -n "Certificate Authority - Example Domain"<br>
<br>
&nbsp;-----BEGIN CERTIFICATE-----<br>
&nbsp;MIIDmTCCAoGgAwIBAgIBATANBgkqhkiG9w0BAQUFADA5MRcwFQYDVQQKEw5FeGFt<br>
&nbsp;cGxlIERvbWFpbjEeMBwGA1UEAxMVQ2VydGlmaWNhdGUgQXV0aG9yaXR5MB4XDTEw<br>
&nbsp;MDQyOTIxNTY1OFoXDTEyMDQxODIxNTY1OFowOTEXMBUGA1UEChMORXhhbXBsZSBE<br>
&nbsp;b21haW4xHjAcBgNVBAMTFUNlcnRpZmljYXRlIEF1dGhvcml0eTCCASIwDQYJKoZI<br>
&nbsp;hvcNAQEBBQADggEPADCCAQoCggEBAO/bqUli2KwqXFKmMMG93KN1SANzNTXA/Vlf<br>
&nbsp;Tmrih3hQgjvR1ktIY9aG6cB7DSKWmtHp/+p4PUCMqL4ZrSGt901qxkePyZ2dYmM2<br>
&nbsp;RnelK+SEUIPiUtoZaDhNdiYsE/yuDE8vQWj0vHCVL0w72qFUcSQ/WZT7FCrnUIUI<br>
&nbsp;udeWnoPSUn70gLhcj/lvxl7K9BHyD4Sq5CzktwYtFWLiiwV+ZY/Fl6JgbGaQyQB2<br>
&nbsp;bP4iRMfloGqsxGuB1evWVDF1haGpFDSPgMnEPSLg3/3dXn+HDJbZ29EU8/xKzQEb<br>
&nbsp;3V0AHKbu80zGllLEt2Zx/WDIrgJEN9yMfgKFpcmL+BvIRsmh0VsCAwEAAaOBqzCB<br>
&nbsp;qDAfBgNVHSMEGDAWgBQATgxHQyRUfKIZtdp55bZlFr+tFzAPBgNVHRMBAf8EBTAD<br>
&nbsp;AQH/MA4GA1UdDwEB/wQEAwIBxjAdBgNVHQ4EFgQUAE4MR0MkVHyiGbXaeeW2ZRa/<br>
&nbsp;rRcwRQYIKwYBBQUHAQEEOTA3MDUGCCsGAQUFBzABhilodHRwOi8vbG9jYWxob3N0<br>
&nbsp;LmxvY2FsZG9tYWluOjkxODAvY2Evb2NzcDANBgkqhkiG9w0BAQUFAAOCAQEAi8Gk<br>
&nbsp;L3XO43u7/TDOeEsWPmq+jZsDZ3GZ85Ajt3KROLWeKVZZZa2E2Hnsvf2uXbk5amKe<br>
&nbsp;lRxdSeRH9g85pv4KY7Z8xZ71NrI3+K3uwmnqkc6t0hhYb1mw/gx8OAAoluQx3biX<br>
&nbsp;JBDxjI73Cf7XUopplHBjjiwyGIJUO8BEZJ5L+TF4P38MJz1snLtzZpEAX5bl0U76<br>
&nbsp;bfu/tZFWBbE8YAWYtkCtMcalBPj6jn2WD3M01kGozW4mmbvsj1cRB9HnsGsqyHCu<br>
&nbsp;U0ujlL1H/RWcjn607+CTeKH9jLMUqCIqPJNOa+kq/6F7NhNRRiuzASIbZc30BZ5a<br>
&nbsp;nI7q5n1USM3eWQlVXw==<br>
&nbsp;-----END CERTIFICATE-----<br>
<br>
&nbsp;&nbsp; Listing Keys<br>
<br>
&nbsp;&nbsp; Keys are the original material used to encrypt certificate data. The keys<br>
&nbsp;&nbsp; generated for certificates are stored separately, in the key database.<br>
<br>
&nbsp;&nbsp; To list all keys in the database, use the -K command option and the<br>
&nbsp;&nbsp; (required) -d argument to give the path to the directory.<br>
<br>
&nbsp;$ certutil -K -d sql:/home/my/sharednssdb<br>
&nbsp;certutil: Checking token "NSS Certificate DB" in slot "NSS User Private Key and Certificate Services&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "<br>
&nbsp;&lt; 0&gt; rsa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 455a6673bde9375c2887ec8bf8016b3f9f35861d&nbsp;&nbsp; Thawte Freemail Member's Thawte Consulting (Pty) Ltd. ID<br>
&nbsp;&lt; 1&gt; rsa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 40defeeb522ade11090eacebaaf1196a172127df&nbsp;&nbsp; Example Domain Administrator Cert<br>
&nbsp;&lt; 2&gt; rsa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1d0b06f44f6c03842f7d4f4a1dc78b3bcd1b85a5&nbsp;&nbsp; John Smith user cert<br>
<br>
&nbsp;&nbsp; There are ways to narrow the keys listed in the search results:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;To return a specific key, use the -n name argument with the name of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the key.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;If there are multiple security devices loaded, then the -h tokenname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; argument can search a specific token or all tokens.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;If there are multiple key types available, then the -k key-type<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; argument can search a specific type of key, like RSA, DSA, or ECC.<br>
<br>
&nbsp;&nbsp; Listing Security Modules<br>
<br>
&nbsp;&nbsp; The devices that can be used to store certificates -- both internal<br>
&nbsp;&nbsp; databases and external devices like smart cards -- are recognized and used<br>
&nbsp;&nbsp; by loading security modules. The -U command option lists all of the<br>
&nbsp;&nbsp; security modules listed in the secmod.db database. The path to the<br>
&nbsp;&nbsp; directory (-d) is required.<br>
<br>
&nbsp;$ certutil -U -d sql:/home/my/sharednssdb<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; slot: NSS User Private Key and Certificate Services<br>
&nbsp;&nbsp;&nbsp; token: NSS Certificate DB<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; slot: NSS Internal Cryptographic Services<br>
&nbsp;&nbsp;&nbsp; token: NSS Generic Crypto Services<br>
<br>
&nbsp;&nbsp; Adding Certificates to the Database<br>
<br>
&nbsp;&nbsp; Existing certificates or certificate requests can be added manually to the<br>
&nbsp;&nbsp; certificate database, even if they were generated elsewhere. This uses the<br>
&nbsp;&nbsp; -A command option.<br>
<br>
&nbsp;certutil -A -n certname -t trustargs -d [sql:]directory [-a] [-i input-file]<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil -A -n "CN=My SSL Certificate" -t "u,u,u" -d sql:/home/my/sharednssdb -i /home/example-certs/cert.cer<br>
<br>
&nbsp;&nbsp; A related command option, -E, is used specifically to add email<br>
&nbsp;&nbsp; certificates to the certificate database. The -E command has the same<br>
&nbsp;&nbsp; arguments as the -A command. The trust arguments for certificates have the<br>
&nbsp;&nbsp; format SSL,S/MIME,Code-signing, so the middle trust settings relate most<br>
&nbsp;&nbsp; to email certificates (though the others can be set). For example:<br>
<br>
&nbsp;$ certutil -E -n "CN=John Smith Email Cert" -t ",Pu," -d sql:/home/my/sharednssdb -i /home/example-certs/email.cer<br>
<br>
&nbsp;&nbsp; Deleting Certificates to the Database<br>
<br>
&nbsp;&nbsp; Certificates can be deleted from a database using the -D option. The only<br>
&nbsp;&nbsp; required options are to give the security database directory and to<br>
&nbsp;&nbsp; identify the certificate nickname.<br>
<br>
&nbsp;certutil -D -d [sql:]directory -n "nickname"<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil -D -d sql:/home/my/sharednssdb -n "my-ssl-cert"<br>
<br>
&nbsp;&nbsp; Validating Certificates<br>
<br>
&nbsp;&nbsp; A certificate contains an expiration date in itself, and expired<br>
&nbsp;&nbsp; certificates are easily rejected. However, certificates can also be<br>
&nbsp;&nbsp; revoked before they hit their expiration date. Checking whether a<br>
&nbsp;&nbsp; certificate has been revoked requires validating the certificate.<br>
&nbsp;&nbsp; Validation can also be used to ensure that the certificate is only used<br>
&nbsp;&nbsp; for the purposes it was initially issued for. Validation is carried out by<br>
&nbsp;&nbsp; the -V command option.<br>
<br>
&nbsp;certutil -V -n certificate-name [-b time] [-e] [-u cert-usage] -d [sql:]directory<br>
<br>
&nbsp;&nbsp; For example, to validate an email certificate:<br>
<br>
&nbsp;$ certutil -V -n "John Smith's Email Cert" -e -u S,R -d sql:/home/my/sharednssdb<br>
<br>
&nbsp;&nbsp; Modifying Certificate Trust Settings<br>
<br>
&nbsp;&nbsp; The trust settings (which relate to the operations that a certificate is<br>
&nbsp;&nbsp; allowed to be used for) can be changed after a certificate is created or<br>
&nbsp;&nbsp; added to the database. This is especially useful for CA certificates, but<br>
&nbsp;&nbsp; it can be performed for any type of certificate.<br>
<br>
&nbsp;certutil -M -n certificate-name -t trust-args -d [sql:]directory<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil -M -n "My CA Certificate" -d sql:/home/my/sharednssdb -t "CTu,CTu,CTu"<br>
<br>
&nbsp;&nbsp; Printing the Certificate Chain<br>
<br>
&nbsp;&nbsp; Certificates can be issued in chains because every certificate authority<br>
&nbsp;&nbsp; itself has a certificate; when a CA issues a certificate, it essentially<br>
&nbsp;&nbsp; stamps that certificate with its own fingerprint. The -O prints the full<br>
&nbsp;&nbsp; chain of a certificate, going from the initial CA (the root CA) through<br>
&nbsp;&nbsp; ever intermediary CA to the actual certificate. For example, for an email<br>
&nbsp;&nbsp; certificate with two CAs in the chain:<br>
<br>
&nbsp;$ certutil -d sql:/home/my/sharednssdb -O -n "<a class=" link-mailto" href="mailto:jsmith@example.com">jsmith@example.com</a>"<br>
&nbsp;"Builtin Object Token:Thawte Personal Freemail CA" [<a class=" link-mailto" href="mailto:E=personal-freemail@thawte.com,CN=Thawte">E=personal-freemail@thawte.com,CN=Thawte</a> Personal Freemail CA,OU=Certification Services Division,O=Thawte Consulting,L=Cape Town,ST=Western Cape,C=ZA]<br>
<br>
&nbsp;&nbsp; "Thawte Personal Freemail Issuing CA - Thawte Consulting" [CN=Thawte Personal Freemail Issuing CA,O=Thawte Consulting (Pty) Ltd.,C=ZA]<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; "(null)" [<a class=" link-mailto" href="mailto:E=jsmith@example.com,CN=Thawte">E=jsmith@example.com,CN=Thawte</a> Freemail Member]<br>
<br>
&nbsp;&nbsp; Resetting a Token<br>
<br>
&nbsp;&nbsp; The device which stores certificates -- both external hardware devices and<br>
&nbsp;&nbsp; internal software databases -- can be blanked and reused. This operation<br>
&nbsp;&nbsp; is performed on the device which stores the data, not directly on the<br>
&nbsp;&nbsp; security databases, so the location must be referenced through the token<br>
&nbsp;&nbsp; name (-h) as well as any directory path. If there is no external token<br>
&nbsp;&nbsp; used, the default value is internal.<br>
<br>
&nbsp;certutil -T -d [sql:]directory -h token-name -0 security-officer-password<br>
<br>
&nbsp;&nbsp; Many networks have dedicated personnel who handle changes to security<br>
&nbsp;&nbsp; tokens (the security officer). This person must supply the password to<br>
&nbsp;&nbsp; access the specified token. For example:<br>
<br>
&nbsp;$ certutil -T -d sql:/home/my/sharednssdb -h nethsm -0 secret<br>
<br>
&nbsp;&nbsp; Upgrading or Merging the Security Databases<br>
<br>
&nbsp;&nbsp; Many networks or applications may be using older BerkeleyDB versions of<br>
&nbsp;&nbsp; the certificate database (cert8.db). Databases can be upgraded to the new<br>
&nbsp;&nbsp; SQLite version of the database (cert9.db) using the --upgrade-merge<br>
&nbsp;&nbsp; command option or existing databases can be merged with the new cert9.db<br>
&nbsp;&nbsp; databases using the ---merge command.<br>
<br>
&nbsp;&nbsp; The --upgrade-merge command must give information about the original<br>
&nbsp;&nbsp; database and then use the standard arguments (like -d) to give the<br>
&nbsp;&nbsp; information about the new databases. The command also requires information<br>
&nbsp;&nbsp; that the tool uses for the process to upgrade and write over the original<br>
&nbsp;&nbsp; database.<br>
<br>
&nbsp;certutil --upgrade-merge -d [sql:]directory [-P dbprefix] --source-dir directory --source-prefix dbprefix --upgrade-id id --upgrade-token-name name [-@ password-file]<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil --upgrade-merge -d sql:/home/my/sharednssdb --source-dir /opt/my-app/alias/ --source-prefix serverapp- --upgrade-id 1 --upgrade-token-name internal<br>
<br>
&nbsp;&nbsp; The --merge command only requires information about the location of the<br>
&nbsp;&nbsp; original database; since it doesn't change the format of the database, it<br>
&nbsp;&nbsp; can write over information without performing interim step.<br>
<br>
&nbsp;certutil --merge -d [sql:]directory [-P dbprefix] --source-dir directory --source-prefix dbprefix [-@ password-file]<br>
<br>
&nbsp;&nbsp; For example:<br>
<br>
&nbsp;$ certutil --merge -d sql:/home/my/sharednssdb --source-dir /opt/my-app/alias/ --source-prefix serverapp-<br>
<br>
&nbsp;&nbsp; Running certutil Commands from a Batch File<br>
<br>
&nbsp;&nbsp; A series of commands can be run sequentially from a text file with the -B<br>
&nbsp;&nbsp; command option. The only argument for this specifies the input file.<br>
<br>
&nbsp;$ certutil -B -i /path/to/batch-file<br>
<br>
NSS Database Types<br>
<br>
&nbsp;&nbsp; NSS originally used BerkeleyDB databases to store security information.<br>
&nbsp;&nbsp; The last versions of these legacy databases are:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;cert8.db for certificates<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;key3.db for keys<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;secmod.db for PKCS #11 module information<br>
<br>
&nbsp;&nbsp; BerkeleyDB has performance limitations, though, which prevent it from<br>
&nbsp;&nbsp; being easily used by multiple applications simultaneously. NSS has some<br>
&nbsp;&nbsp; flexibility that allows applications to use their own, independent<br>
&nbsp;&nbsp; database engine while keeping a shared database and working around the<br>
&nbsp;&nbsp; access issues. Still, NSS requires more flexibility to provide a truly<br>
&nbsp;&nbsp; shared security database.<br>
<br>
&nbsp;&nbsp; In 2009, NSS introduced a new set of databases that are SQLite databases<br>
&nbsp;&nbsp; rather than BerkleyDB. These new databases provide more accessibility and<br>
&nbsp;&nbsp; performance:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;cert9.db for certificates<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;key4.db for keys<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;pkcs11.txt, which is listing of all of the PKCS #11 modules contained<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in a new subdirectory in the security databases directory<br>
<br>
&nbsp;&nbsp; Because the SQLite databases are designed to be shared, these are the<br>
&nbsp;&nbsp; shared database type. The shared database type is preferred; the legacy<br>
&nbsp;&nbsp; format is included for backward compatibility.<br>
<br>
&nbsp;&nbsp; By default, the tools (certutil, pk12util, modutil) assume that the given<br>
&nbsp;&nbsp; security databases follow the more common legacy type. Using the SQLite<br>
&nbsp;&nbsp; databases must be manually specified by using the sql: prefix with the<br>
&nbsp;&nbsp; given security directory. For example:<br>
<br>
&nbsp;$ certutil -L -d sql:/home/my/sharednssdb<br>
<br>
&nbsp;&nbsp; To set the shared database type as the default type for the tools, set the<br>
&nbsp;&nbsp; NSS_DEFAULT_DB_TYPE environment variable to sql:<br>
<br>
&nbsp;export NSS_DEFAULT_DB_TYPE="sql"<br>
<br>
&nbsp;&nbsp; This line can be set added to the ~/.bashrc file to make the change<br>
&nbsp;&nbsp; permanent.<br>
<br>
&nbsp;&nbsp; Most applications do not use the shared database by default, but they can<br>
&nbsp;&nbsp; be configured to use them. For example, this how-to article covers how to<br>
&nbsp;&nbsp; configure Firefox and Thunderbird to use the new shared NSS databases:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;<a class=" link-https" href="https://wiki.mozilla.org/NSS_Shared_DB_Howto">https://wiki.mozilla.org/NSS_Shared_DB_Howto</a><br>
<br>
&nbsp;&nbsp; For an engineering draft on the changes in the shared NSS databases, see<br>
&nbsp;&nbsp; the NSS project wiki:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;<a class=" link-https" href="https://wiki.mozilla.org/NSS_Shared_DB">https://wiki.mozilla.org/NSS_Shared_DB</a><br>
<br>
See Also<br>
<br>
&nbsp;&nbsp; pk12util (1)<br>
<br>
&nbsp;&nbsp; modutil (1)<br>
<br>
&nbsp;&nbsp; certutil has arguments or operations that use features defined in several<br>
&nbsp;&nbsp; IETF RFCs.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;<a class=" external" href="https://datatracker.ietf.org/doc/html/rfc5280">http://tools.ietf.org/html/rfc5280</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;<a class=" external" href="https://datatracker.ietf.org/doc/html/rfc1113">http://tools.ietf.org/html/rfc1113</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;<a class=" external" href="https://datatracker.ietf.org/doc/html/rfc1485">http://tools.ietf.org/html/rfc1485</a><br>
<br>
&nbsp;&nbsp; The NSS wiki has information on the new database design and how to<br>
&nbsp;&nbsp; configure applications to use it.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;<a class=" link-https" href="https://wiki.mozilla.org/NSS_Shared_DB_Howto">https://wiki.mozilla.org/NSS_Shared_DB_Howto</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; o&nbsp;<a class=" link-https" href="https://wiki.mozilla.org/NSS_Shared_DB">https://wiki.mozilla.org/NSS_Shared_DB</a><br>
<br>
Additional Resources<br>
<br>
&nbsp;&nbsp; For information about NSS and other tools related to NSS (like JSS), check<br>
&nbsp;&nbsp; out the NSS project wiki at<br>
&nbsp;&nbsp; [1]<a class=" external" href="https://www.mozilla.org/projects/security/pki/nss/">http://www.mozilla.org/projects/security/pki/nss/</a>. The NSS site relates<br>
&nbsp;&nbsp; directly to NSS code changes and releases.<br>
<br>
&nbsp;&nbsp; Mailing lists: <a class=" link-https" href="https://lists.mozilla.org/listinfo/dev-tech-crypto">https://lists.mozilla.org/listinfo/dev-tech-crypto</a><br>
<br>
&nbsp;&nbsp; IRC: Freenode at #dogtag-pki<br>
<br>
Authors<br>
<br>
&nbsp;&nbsp; The NSS tools were written and maintained by developers with Netscape, Red<br>
&nbsp;&nbsp; Hat, and Sun.<br>
<br>
&nbsp;&nbsp; Authors: Elio Maldonado &lt;<a class=" link-mailto" href="mailto:emaldona@redhat.com">emaldona@redhat.com</a>&gt;, Deon Lackey<br>
&nbsp;&nbsp; &lt;<a class=" link-mailto" href="mailto:dlackey@redhat.com">dlackey@redhat.com</a>&gt;.<br>
<br>
Copyright<br>
<br>
&nbsp;&nbsp; (c) 2010, Red Hat, Inc. Licensed under the GNU Public License version 2.<br>
<br>
References<br>
<br>
&nbsp;&nbsp; Visible links<br>
&nbsp;&nbsp; 1. <a class=" external" href="https://www.mozilla.org/projects/security/pki/nss/">http://www.mozilla.org/projects/security/pki/nss/</a></p>
