<div>{{SpiderMonkeySidebar}}</div>

<p>This article documents future directions in functionality, design, and coding practices for SpiderMonkey. It can be read as something like an "ideal future state" for the engine. That means the code as it is today won't match this document, and that's OK. Whenever practical, new code and changes should move code closer to the ideal future. And of course, the idea of the future is always evolving in time as things change and we learn more.</p>

<h2 id="Concurrent_and_wasm_GC">Concurrent and wasm GC</h2>

<p>We are working towards a concurrent collector.</p>

<p>We would also like to allow WebAssembly to interact with GC-managed data.</p>

<h2 id="Parallelism">Parallelism</h2>

<p>Most machines that run SpiderMonkey have multiple cores, so parallelism is almost certainly part of our future. It will take some experimentation to build the right set of parallel facilities. During that experimentation, we must take care to apply parallelism with conceptual clarity and discipline.</p>

<h2 id="The_API">The API</h2>

<p>The SpiderMonkey API is C++.</p>

<p>For the near future, we do not intend to provide a stable API, because too many things are changing. Also, we will someday want a more modern C++ API. Going forward from now, the API will likely be semi-stable, but there is no guarantee.</p>

<p>The public API is gradually moving from jsapi.h and jsfriendapi.h into header files in js/public. Much more cleanup and organization is still required.</p>

<h2 id="Practical_coding_bits">Practical coding bits</h2>

<h3 id="Experimental_language_features">Experimental language features</h3>

<p>New language features (ES6+) and APIs often get added to SpiderMonkey while the spec is still being drafted, or before the feature has stabilized. This is good, because it helps the spec work. For these features:</p>

<ul>
 <li>Do not add vendor prefixes. See <a href="http://hsivonen.iki.fi/vendor-prefixes/" title="http://hsivonen.iki.fi/vendor-prefixes/">http://hsivonen.iki.fi/vendor-prefixes/</a> for an extended argument.</li>
 <li>Disable the feature before the Beta channel. Nightly and Aurora are the good channels for experimental work.</li>
</ul>

<h3 id="NSPR">NSPR</h3>

<p>The plan is to make SpiderMonkey not depend on <a href="/en-US/docs/Mozilla/Projects/NSPR">NSPR</a>. No fundamental blockers currently exist, but ctypes is still using NSPR's runtime library loading facilities.</p>

<h3 id="Directories_and_filenames">Directories and filenames</h3>

<p>See <a href="https://wiki.mozilla.org/JS_engine_modularization" title="https://wiki.mozilla.org/JS_engine_modularization">https://wiki.mozilla.org/JS_engine_modularization</a>.</p>