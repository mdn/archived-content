<div>{{SpiderMonkeySidebar("JSAPI")}}</div>

<div class="summary">
<p>Create a new property on an object.</p>
</div>

<h2 id="Syntax" name="Syntax">Syntax</h2>

<pre class="brush: cpp">bool
JS_DefineProperty(JSContext *cx, JS::HandleObject obj, const char *name, JS::HandleValue value,
                  unsigned attrs,
                  JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineProperty(JSContext *cx, JS::HandleObject obj, const char *name, JS::HandleObject value,
                  unsigned attrs,
                  JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineProperty(JSContext *cx, JS::HandleObject obj, const char *name, JS::HandleString value,
                  unsigned attrs,
                  JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineProperty(JSContext *cx, JS::HandleObject obj, const char *name, int32_t value,
                  unsigned attrs,
                  JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineProperty(JSContext *cx, JS::HandleObject obj, const char *name, uint32_t value,
                  unsigned attrs,
                  JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineProperty(JSContext *cx, JS::HandleObject obj, const char *name, double value,
                  unsigned attrs,
                  JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineUCProperty(JSContext *cx, JS::HandleObject obj, const char16_t *name, size_t namelen,
                    JS::HandleValue value, unsigned attrs,
                    JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineUCProperty(JSContext *cx, JS::HandleObject obj, const char16_t *name, size_t namelen,
                    JS::HandleObject value, unsigned attrs,
                    JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineUCProperty(JSContext *cx, JS::HandleObject obj, const char16_t *name, size_t namelen,
                    JS::HandleString value, unsigned attrs,
                    JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineUCProperty(JSContext *cx, JS::HandleObject obj, const char16_t *name, size_t namelen,
                    int32_t value, unsigned attrs,
                    JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineUCProperty(JSContext *cx, JS::HandleObject obj, const char16_t *name, size_t namelen,
                    uint32_t value, unsigned attrs,
                    JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefineUCProperty(JSContext *cx, JS::HandleObject obj, const char16_t *name, size_t namelen,
                    double value, unsigned attrs,
                    JSNative getter = nullptr, JSNative setter = nullptr);

// ---- Added in SpiderMonkey 45 ----

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id,
                      JS::Handle&lt;JSPropertyDescriptor&gt; desc,
                      JS::ObjectOpResult &amp;result);

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id,
                      JS::Handle&lt;JSPropertyDescriptor&gt; desc);

bool
JS_DefineUCProperty(JSContext *cx, JS::HandleObject obj, const char16_t *name, size_t namelen,
                    JS::Handle&lt;JSPropertyDescriptor&gt; desc);


// ---- Added in SpiderMonkey 1.8.1 ----

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id, JS::HandleValue value,
                      unsigned attrs,
                      JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id, JS::HandleObject value,
                      unsigned attrs,
                      JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id, JS::HandleString value,
                      unsigned attrs,
                      JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id, int32_t value,
                      unsigned attrs,
                      JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id, uint32_t value,
                      unsigned attrs,
                      JSNative getter = nullptr, JSNative setter = nullptr);

bool
JS_DefinePropertyById(JSContext *cx, JS::HandleObject obj, JS::HandleId id, double value,
                      unsigned attrs,
                      JSNative getter = nullptr, JSNative setter = nullptr);
</pre>

<table class="fullwidth-table">
 <tbody>
  <tr>
   <th>Name</th>
   <th>Type</th>
   <th>Description</th>
  </tr>
  <tr>
   <td><code>cx</code></td>
   <td>{{jsapixref("JSRuntime", "JSContext *")}}</td>
   <td>The context in which to define the property. {{ Jsapi-requires-request() }}</td>
  </tr>
  <tr>
   <td><code>obj</code></td>
   <td>{{jsapixref("JSObject", "JS::HandleObject")}}</td>
   <td>The object on which to create the new property.</td>
  </tr>
  <tr>
   <td><code>name</code> <em>or<em> <code>id</code></em></em></td>
   <td><code>const char *</code> <em>or</em> <code>const char16_t *<em>or</em> {{jsapixref("jsid", "JS::HandleId")}}</code></td>
   <td>The name of the new property.</td>
  </tr>
  <tr>
   <td><code>namelen</code></td>
   <td><code>size_t</code></td>
   <td><em>(only in <code>JS_DefineUCProperty</code>)</em> The length of <code>name</code>, in characters; or <code>(size_t) -1</code> to indicate that <code>name</code> is null-terminated.</td>
  </tr>
  <tr>
   <td><code>value</code></td>
   <td>{{jsapixref("JS::Value", "JS::HandleValue")}} <em>or</em> {{jsapixref("JSObject", "JS::HandleObject")}} <em>or</em> {{jsapixref("JSString", "JS::HandleString")}} <em>or</em> <code>int32_t</code> <em>or</em> <code>uint32_t</code> <em>or</em> <code>double</code></td>
   <td>Initial {{jsapixref("Stored_value", "stored value", "", 1)}} for the new property.</td>
  </tr>
  <tr>
   <td><code>getter</code></td>
   <td>{{jsapixref("JSNative")}}</td>
   <td>The property getter callback, which the JavaScript engine will call each time the property's value is accessed; or <code>NULL</code>.</td>
  </tr>
  <tr>
   <td><code>setter</code></td>
   <td>{{jsapixref("JSNative")}}</td>
   <td>The property setter callback, which the JavaScript engine will call each time the property is assigned; or <code>NULL</code>.</td>
  </tr>
  <tr>
   <td><code>attrs</code></td>
   <td><code>unsigned</code></td>
   <td>{{jsapixref("Property_attributes", "Property attributes", "", 1)}}.</td>
  </tr>
  <tr>
   <td><code>desc</code></td>
   <td>{{jsapixref("JSPropertyDescriptor", "JS::Handle&lt;JSPropertyDescriptor&gt;")}}</td>
   <td>The property descriptor for the property to be defined.</td>
  </tr>
  <tr>
   <td><code>result</code></td>
   <td>{{jsapixref("JS::ObjectOpResult", "JS::ObjectOpResult &amp;")}}</td>
   <td>(out parameter) Receives the result of the operation.</td>
  </tr>
 </tbody>
</table>

<h2 id="Description" name="Description">Description</h2>

<p><strong><code>JS_DefineProperty</code></strong> defines a single property in a specified object, <code>obj</code>. <strong><code>JS_DefineUCProperty</code></strong> is the Unicode version of the function. <strong><code>JS_DefinePropertyById</code></strong> is the same but takes a {{jsapixref("jsid", "JS::HandleId")}} for the property name.</p>

<p><code>JS_DefineProperty</code> is the fundamental operation on which several more convenient, higher-level functions are based, including {{jsapixref("JS_DefineFunction")}}, {{jsapixref("JS_DefineFunctions")}}, {{jsapixref("JS_DefineProperties")}}, {{jsapixref("JS_DefineConstDoubles")}}, {{jsapixref("JS_DefineObject")}}, and {{jsapixref("JS_InitClass")}}. It differs from {{jsapixref("JS_SetProperty")}} in that:</p>

<ul>
 <li>it does not behave like ordinary property assignment in the JavaScript language;</li>
 <li>it allows the application to specify additional details (<code>getter</code>, <code>setter</code>, and <code>attrs</code>) governing the new property's behavior;</li>
 <li>it never calls a setter;</li>
 <li>it can call the {{jsapixref("JSPropertyOp", "JSClass.addProperty")}} callback when <code>JS_SetProperty</code> would not, because it can replace an existing property.</li>
</ul>

<p>The parameters specify the new property's <code>name</code>, initial {{jsapixref("Stored_value", "stored value")}}, <code>getter</code>, <code>setter</code>, and {{jsapixref("Property_attributes", "Property attributes", "", 1)}} (<code>attrs</code>).</p>

<p>If <code>obj</code> already has an own property with the given <code>name</code> or <code>id</code>, the existing property is replaced. These functions can currently replace {{jsapixref("Property_attributes", "JSPROP_PERMANENT")}} properties, but such usage is deprecated.</p>

<p>The JavaScript engine will call the getter or setter callback each time the property is read or written, whether from JavaScript code or via JSAPI functions like {{jsapixref("JS_GetProperty")}} and {{jsapixref("JS_SetProperty")}}. (Exception: If <code>attrs</code> contains the {{jsapixref("Property_attributes", "JSPROP_READONLY")}} flag, the setter will never be called, as property assignment will fail before it gets that far. Also note that certain JSAPI functions, including {{jsapixref("JS_LookupProperty")}}, {{jsapixref("JS_HasProperty")}}, and {{jsapixref("Property_attributes")}}, can detect or examine a property without calling its getter.) If <code>getter</code> (or <code>setter</code>) is <code>NULL</code>, the new property will use the {{jsapixref("JSPropertyOp", "JSClass.getProperty")}} (or {{jsapixref("JSPropertyOp", "JSClass.setProperty")}}) callback from <code>obj</code>'s class.</p>

<p>If <code>attrs</code> contains the {{jsapixref("Property_attributes", "JSPROP_GETTER")}} (or {{jsapixref("Property_attributes", "JSPROP_SETTER")}}) flag, then <code>getter</code> (or <code>setter</code>) must point to a JavaScript <code>Function</code>, not a C/C++ function. That is, it must be a <code>JSObject *</code> that points to a JavaScript <code>Function</code>, cast to type <code>JSPropertyOp</code>. For more about JavaScript getters and setters, see <a href="/en/JavaScript/Guide/Obsolete_Pages/Creating_New_Objects/Defining_Getters_and_Setters" title="en/Core_JavaScript_1.5_Guide/Creating_New_Objects/Defining_Getters_and_Setters">Defining Getters and Setters</a>.</p>

<p>On success, <code>JS_DefineProperty</code> returns <code>true</code>. On error or exception, it returns <code>false</code>.</p>

<h2 id="See_Also" name="See_Also">See Also</h2>

<ul>
 <li>{{ LXRSearch("ident", "i", "JS_DefineProperty") }}</li>
 <li>{{ LXRSearch("ident", "i", "JS_DefineUCProperty") }}</li>
 <li>{{ LXRSearch("ident", "i", "JS_DefinePropertyById") }}</li>
 <li>{{jsapixref("JS_DefineElement")}}</li>
 <li>{{bug(461163)}}</li>
 <li>{{bug(1113369)}} -- added <code>desc</code> and <code>result</code> parameters</li>
</ul>