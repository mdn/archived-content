---
title: nsITelemetry
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsITelemetry
tags:
  - Developing Mozilla
  - Interfaces
  - 'Interfaces:Scriptable'
  - Performance
  - XPCOM
  - XPCOM Interface Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/nsITelemetry.idl" rel="custom">toolkit/components/telemetry/nsITelemetry.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

A service to gather performance data that can be tracked over time to allow generating histograms.
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>

  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 14.285714285714285%;"></div>

<div style="height: 8px; top: 16px; left: 14.285714285714285%; background: #00dd00; position: absolute; width: 85.71428571428572%;" title="Introduced in Gecko 6.0 (Firefox 6.0 / Thunderbird 6.0 / SeaMonkey 2.3)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 14.285714285714285%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 14.285714285714285%;">Gecko 6.0</div>

    <div style="height: 8px; top: 16px; left: 15.214285714285714%; background: #eeee00; position: absolute; width: 1%; border-radius: 4px; -webkit-border-radius: 4px;" title="Last changed in Gecko 7.0 (Firefox 7.0 / Thunderbird 7.0 / SeaMonkey 2.4)"></div>

</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title>nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 7.0 (Firefox 7.0 / Thunderbird 7.0 / SeaMonkey 2.4)</span></div>
</div><p></p>

<p>Implemented by: <code>@mozilla.org/base/telemetry;1</code> as a service:</p>

<pre class="eval">let telemetry = Components.classes[&quot;@mozilla.org/base/telemetry;1&quot;]
                .getService(Components.interfaces.nsITelemetry);
</pre>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>jsval <a href="#getHistogramById()">getHistogramById</a>(in ACString id);</code> </td>
  </tr>
  <tr>
   <td><code>jsval snapshotHistograms(in uint32_t aDataset, in boolean aSubsession, in boolean aClear);</code></td>
  </tr>
  <tr>
   <td><code>jsval <a href="#getKeyedHistogramById()">getKeyedHistogramById</a>(in ACString id);</code> </td>
  </tr>
  <tr>
   <td><code>void captureStack(in ACString name);</code></td>
  </tr>
  <tr>
   <td><code>jsval snapshotCapturedStacks([optional] in boolean clear);</code></td>
  </tr>
  <tr>
   <td><code>nsISupports getLoadedModules();</code></td>
  </tr>
  <tr>
   <td><code>jsval snapshotKeyedHistograms(in uint32_t aDataset, in boolean aSubsession, in boolean aClear);</code></td>
  </tr>
  <tr>
   <td><code>void setHistogramRecordingEnabled(in ACString id, in boolean enabled);</code> <span title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></td>
  </tr>
  <tr>
   <td><code>void asyncFetchTelemetryData(in nsIFetchTelemetryDataCallback aCallback);</code></td>
  </tr>
  <tr>
   <td><code>double msSinceProcessStart();</code></td>
  </tr>
  <tr>
   <td><code>void scalarAdd(in ACString aName, in jsval aValue);</code></td>
  </tr>
  <tr>
   <td><code>void scalarSet(in ACString aName, in jsval aValue);</code></td>
  </tr>
  <tr>
   <td><code>void scalarSetMaximum(in ACString aName, in jsval aValue);</code></td>
  </tr>
  <tr>
   <td><code>jsval snapshotScalars(in uint32_t aDataset, [optional] in boolean aClear);</code></td>
  </tr>
  <tr>
   <td><code>void keyedScalarAdd(in ACString aName, in AString aKey, in jsval aValue);</code></td>
  </tr>
  <tr>
   <td><code>void keyedScalarSet(in ACString aName, in AString aKey, in jsval aValue);</code></td>
  </tr>
  <tr>
   <td><code>void keyedScalarSetMaximum(in ACString aName, in AString aKey, in jsval aValue);</code></td>
  </tr>
  <tr>
   <td><code>jsval snapshotKeyedScalars(in uint32_t aDataset, [optional] in boolean aClear);</code></td>
  </tr>
  <tr>
   <td><code>void clearScalars();</code> <em>test only</em></td>
  </tr>
  <tr>
   <td><code>void flushBatchedChildTelemetry();</code></td>
  </tr>
  <tr>
   <td><code>void recordEvent(in ACString aCategory, in ACString aMethod, in ACString aObject, [optional] in jsval aValue, [optional] in jsval extra);</code></td>
  </tr>
  <tr>
   <td><code>void setEventRecordingEnabled(in ACString aCategory, in boolean aEnabled);</code></td>
  </tr>
  <tr>
   <td><code>jsval snapshotEvents(in uint32_t aDataset, [optional] in boolean aClear);</code></td>
  </tr>
  <tr>
   <td><code>void registerEvents(in ACString aCategory, in jsval aEventData);</code></td>
  </tr>
  <tr>
   <td><code>void registerScalars(in ACString aCategoryName, in jsval aScalarData);</code></td>
  </tr>
  <tr>
   <td><code>void clearEvents();</code> <em>test only</em></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>canRecordBase</code><span title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></td>
   <td><code><a href="/en-US/docs/Glossary/Boolean">boolean</a></code></td>
   <td>A flag indicating if Telemetry can record base data (FHR data). This is <code>true</code> if the FHR data reporting service or the self-support service is enabled.</td>
  </tr>
  <tr>
   <td><code>canRecordExtended</code> <span title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></td>
   <td><code><a href="/en-US/docs/Glossary/Boolean">boolean</a></code></td>
   <td>A flag indicating if Telemetry is allowed to record extended data. Returns <code>false</code> if the user has not opted into &quot;extended Telemetry&quot; on the Release channel, when the user has explicitly opted out of Telemetry on Nightly/Aurora/Beta or if manually set to <code>false</code> during tests.</td>
  </tr>
  <tr>
   <td><code>canRecordReleaseData</code></td>
   <td><code>readonly</code> <code><a href="/en-US/docs/Glossary/Boolean">boolean</a></code></td>
   <td>A flag indicating whether Telemetry is recording release data. Does not indicate whether Telemetry will send any data. That is governed by user preference and other mechanisms.</td>
  </tr>
  <tr>
   <td><code>canRecordPreReleaseData</code></td>
   <td><code>readonly</code> <code><a href="/en-US/docs/Glossary/Boolean">boolean</a></code></td>
   <td>A flag indicating whether Telemetry is recording pre-release data. Does not indicate whether Telemetry will send any data. That is governed by user preference and other mechanisms.</td>
  </tr>
  <tr>
   <td><code>histogramSnapshots</code></td>
   <td><a href="/en-US/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/jsval"><code>jsval</code></a></td>
   <td>
    <p>An object containing a snapshot from all of the currently registered histograms. { name1: {data1}, name2:{data2}...} where data consists of the following properties:</p>

    <ul>
     <li>min - Minimal bucket size</li>
     <li>max - Maximum bucket size</li>
     <li>histogram_type - <code>HISTOGRAM_EXPONENTIAL</code> or <code>HISTOGRAM_LINEAR</code></li>
     <li>counts - An array representing the values of buckets in the histogram.</li>
     <li>ranges - An array with corresponding bucket sizes.</li>
     <li>sum - Sum of the counts array.</li>
     <li>static - <code>true</code> for histograms defined in <a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/Histograms.json" rel="custom">Histograms.json</a>, <code>false</code> for ones defined with <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITelemetry#newHistogram()">newHistogram()</a></code>.</li>
    </ul>
    <strong>Read only.</strong></td>
  </tr>
 </tbody>
</table>

<h2 id="Constants" name="Constants">Constants</h2>

<h3 id="Histogram_Types">Histogram Types</h3>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Constant</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>HISTOGRAM_EXPONENTIAL</code></td>
   <td><code>0</code></td>
   <td>Buckets increase exponentially.</td>
  </tr>
  <tr>
   <td><code>HISTOGRAM_LINEAR</code></td>
   <td><code>1</code></td>
   <td>Buckets increase linearly.</td>
  </tr>
  <tr>
   <td><code>HISTOGRAM_BOOLEAN</code></td>
   <td><code>2</code></td>
   <td>For storing 0/1 values. </td>
  </tr>
  <tr>
   <td><code>HISTOGRAM_FLAG</code></td>
   <td><code>3</code></td>
   <td>For storing a single value; its count is always == 1. </td>
  </tr>
  <tr>
   <td><code>HISTOGRAM_COUNT</code></td>
   <td><code>4</code></td>
   <td>For storing counter values without bucketing. </td>
  </tr>
  <tr>
   <td><code>HISTOGRAM_CATEGORICAL</code></td>
   <td><code>5</code></td>
   <td>For storing enumerated values by label.</td>
  </tr>
 </tbody>
</table>

<h3 id="Methods" name="Methods">Scalar Types</h3>

<table class="standard-table">
 <thead>
  <tr>
   <th scope="col">Constant</th>
   <th scope="col">Value</th>
   <th scope="col">Description</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><code>SCALAR_TYPE_COUNT</code></td>
   <td><code>0</code></td>
   <td>For storing a numeric value.</td>
  </tr>
  <tr>
   <td><code>SCALAR_TYPE_STRING</code></td>
   <td><code>1</code></td>
   <td>For storing a string value.</td>
  </tr>
  <tr>
   <td><code>SCALAR_TYPE_BOOLEAN</code></td>
   <td><code>2</code></td>
   <td>For storing a boolean value.</td>
  </tr>
 </tbody>
</table>

<h3 id="Methods" name="Methods">Dataset Types</h3>

<table class="standard-table">
 <thead>
  <tr>
   <th scope="col">Constant</th>
   <th scope="col">Value</th>
   <th scope="col">Description</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><code>DATASET_RELEASE_CHANNEL_OPTOUT</code></td>
   <td><code>0</code></td>
   <td>The basic dataset that is on-by-default on all channels.</td>
  </tr>
  <tr>
   <td><code>DATASET_RELEASE_CHANNEL_OPTIN</code></td>
   <td><code>1</code></td>
   <td>The extended dataset that is opt-in on release, opt-out on pre-release channels.</td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<p></p><h3 id="getHistogramById()">getHistogramById()</h3><p></p>

<p>Get an histogram by id for histograms registered in <a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/Histograms.json" rel="custom">Histograms.json</a>.</p>

<pre class="eval">jsval getHistogramById(
  in ACString id
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>id</code></dt>
 <dd>Unique identifier from <code><a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/Histograms.json" rel="custom">toolkit/components/telemetry/Histograms.json</a></code>.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>The returned <a href="/en-US/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/jsval" title="The documentation about this has not yet been written; please consider contributing!"><code>jsval</code></a> object has the following functions:</p>

<ul>
 <li><code>add(value)</code> - Adds an integer value to the appropriate bucket</li>
 <li><code>snapshot()</code> - Returns a snapshot of the histogram with the same data fields as in <code>histogramSnapshots</code>.</li>
</ul>

<p></p><h3 id="getKeyedHistogramById()">getKeyedHistogramById()</h3><p></p>

<p>Get a keyed histogram for histograms registered in <a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/Histograms.json" rel="custom">Histograms.json</a>.</p>

<pre class="eval">jsval getKeyedHistogramById(
  in ACString id
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>id</code></dt>
 <dd>Unique identifier from <code><a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/Histograms.json" rel="custom">toolkit/components/telemetry/Histograms.json</a></code>.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>The returned <a href="/en-US/docs/Mozilla/Projects/SpiderMonkey/JSAPI_reference/jsval" title="The documentation about this has not yet been written; please consider contributing!"><code>jsval</code></a> object has the following functions:</p>

<ul>
 <li><code>add(key, [optional] value)</code> - Adds an integer value to the appropriate bucket. For count histograms providing the value is optional.</li>
 <li><code>snapshot([optional] key)</code> - Returns a snapshot of the keyed histogram or (if <code>key</code> is provided) the snapshot of the contained histogram with that key.</li>
 <li><code>keys()</code> - Returns an array with the string keys of the currently registered histograms.</li>
 <li><code>clear()</code> - Clear out the registered histograms and keys.</li>
</ul>

<h2 id="Example" name="Example">Example</h2>

<p>You can find detailed information on adding a new Telemetry probe and recording  Telemetry data at <a href="/en-US/docs/Performance/Adding_a_new_Telemetry_probe" title="/en-US/docs/Performance/Adding_a_new_Telemetry_probe">Adding a new Telemetry probe [en-US]</a>.</p>

<h2 id="See_also" name="See_also">See also</h2>

<ul>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=649502">bug 649502</a> - Expose histograms to JS</li>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=585196">bug 585196</a> - Telemetry infrastructure</li>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=668312">bug 668312</a> - Report only probes defined in <a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/Histograms.json" rel="custom">Histograms.json</a></li>
 <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1069874">bug 1069874</a> - <span id="summary_alias_container"><span id="short_desc_nonedit_display">Add keyed histogram types</span></span></li>
 <li><span><span><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1426453">bug 1426453</a> - Documentation of <a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/telemetry/nsITelemetry.idl" rel="custom">nsITelemetry</a> not up to date</span></span></li>
</ul>
