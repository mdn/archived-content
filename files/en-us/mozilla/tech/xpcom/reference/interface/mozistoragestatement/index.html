---
title: mozIStorageStatement
slug: Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement
tags:
  - Interfaces
  - Storage
  - XPCOM
  - XPCOM API Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/storage/public/mozIStorageStatement.idl" rel="custom">storage/public/mozIStorageStatement.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface lets you create and execute SQL statements on a mozIStorageConnection.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageValueArray" title>mozIStorageValueArray</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.9.2 (Firefox 3.6 / Thunderbird 3.1 / Fennec 1.0)</span></div>
</div><p></p>

<p>For an introduction on how to use this interface, see the <a href="/en/Storage" title="eStorage">Storage overview document</a>.</p>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#initialize()">initialize</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageConnection">mozIStorageConnection</a></code> aDBConnection, in AUTF8String aSQLStatement);</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#finalize()">finalize</a>(); </code></td>
  </tr>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement">mozIStorageStatement</a></code> <a href="#clone()">clone</a>();</code></td>
  </tr>
  <tr>
   <td><code>AUTF8String <a href="#getParameterName()">getParameterName</a>(in unsigned long aParamIndex);</code></td>
  </tr>
  <tr>
   <td><code>unsigned long <a href="#getParameterIndex()">getParameterIndex</a>(in AUTF8String aName);</code></td>
  </tr>
  <tr>
   <td><code>AUTF8String <a href="#getColumnName()">getColumnName</a>(in unsigned long aColumnIndex);</code></td>
  </tr>
  <tr>
   <td><code>unsigned long <a href="#getColumnIndex()">getColumnIndex</a>(in AUTF8String aName);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#reset()">reset</a>();</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#escapeStringForLIKE()">escapeStringForLIKE</a>(in AString aValue, in wchar aEscapeChar);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#bindParameters()">bindParameters</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParamsArray">mozIStorageBindingParamsArray</a></code> aParameters);</code> </td>
  </tr>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParamsArray">mozIStorageBindingParamsArray</a></code> <a href="#newBindingParamsArray()">newBindingParamsArray</a>();</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#bindUTF8StringParameter()">bindUTF8StringParameter</a>(in unsigned long aParamIndex, in AUTF8String aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#bindStringParameter()">bindStringParameter</a>(in unsigned long aParamIndex, in AString aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#bindDoubleParameter()">bindDoubleParameter</a>(in unsigned long aParamIndex, in double aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#bindInt32Parameter()">bindInt32Parameter</a>(in unsigned long aParamIndex, in long aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#bindInt64Parameter()">bindInt64Parameter</a>(in unsigned long aParamIndex, in long long aValue);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#bindNullParameter()">bindNullParameter</a>(in unsigned long aParamIndex);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#bindBlobParameter()">bindBlobParameter</a>(in unsigned long aParamIndex, [array,const,size_is(aValueSize)] in octet aValue, in unsigned long aValueSize);</code></td>
  </tr>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStoragePendingStatement">mozIStoragePendingStatement</a></code> <a href="#executeAsync()">executeAsync</a>(<code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatementCallback">mozIStorageStatementCallback</a></code> aCallback);</code> </td>
  </tr>
  <tr>
   <td><code>boolean <a href="#executeStep()">executeStep</a>();</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#step()">step</a>();</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#execute()">execute</a>();</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>columnCount</code></td>
   <td><code>unsigned long</code></td>
   <td>Number of columns returned. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>parameterCount</code></td>
   <td><code>unsigned long</code></td>
   <td>Number of parameters. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>params</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatementParams">mozIStorageStatementParams</a></code></td>
   <td>The current list of named parameters, which may be set. Only available to JavaScript code. <strong>Read only.</strong> </td>
  </tr>
  <tr>
   <td><code>row</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatementRow">mozIStorageStatementRow</a></code></td>
   <td>The current row, with access to all data members by name. Available only to JavaScript code. <strong>Read only.</strong> </td>
  </tr>
  <tr>
   <td><code>state</code></td>
   <td><code>long</code></td>
   <td>The current state defined by <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageStatement#MOZ_STORAGE_STATEMENT_INVALID">mozIStorageStatement.MOZ_STORAGE_STATEMENT_INVALID</a></code>, <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageStatement#MOZ_STORAGE_STATEMENT_READY">mozIStorageStatement.MOZ_STORAGE_STATEMENT_READY</a></code>, or <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageStatement#MOZ_STORAGE_STATEMENT_EXECUTING">mozIStorageStatement.MOZ_STORAGE_STATEMENT_EXECUTING</a></code>. <strong>Read only.</strong></td>
  </tr>
 </tbody>
</table>

<h2 id="Statement_status_constants">Statement status constants</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Constant</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>MOZ_STORAGE_STATEMENT_INVALID</code></td>
   <td>0</td>
   <td>The SQL statement is Invalid.</td>
  </tr>
  <tr>
   <td><code>MOZ_STORAGE_STATEMENT_READY</code></td>
   <td>1</td>
   <td>The SQL statement is ready to be executed.</td>
  </tr>
  <tr>
   <td><code>MOZ_STORAGE_STATEMENT_EXECUTING</code></td>
   <td>2</td>
   <td>The SQL statement is executing at the moment.</td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<p id="initialize()"></p><div class="headingWithIndicator">
        <h3 id="initialize()_2">initialize()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span>
        </div><p></p>

<p></p><div class="note notecard"><strong>Note:</strong> This method has been removed for Gecko 1.9.1. To initialize a statement, consumers should call <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#createStatement()">mozIStorageConnection.createStatement()</a></code>. This method exists back to Gecko 1.8.0.</div><p></p>

<p>Initialize this query with the given SQL statement.</p>

<pre class="eval">void initialize(
  in mozIStorageConnection aDBConnection,
  in AUTF8String aSQLStatement
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aDBConnection</code></dt>
 <dd>A <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageConnection" title>mozIStorageConnection</a></code> database connection.</dd>
 <dt><code>aSQLStatement</code></dt>
 <dd>String key representing the SQL statement.</dd>
</dl>

<h3 id="finalize()" name="finalize()">finalize()</h3>

<p>Finalizes a statement which releases all resources that were allocated for it. You must call this method on every active statement before you try to call <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#close()">mozIStorageConnection.close()</a></code>.</p>

<pre class="eval">void finalize();
</pre>

<p></p><div class="note notecard"><strong>Note:</strong> This method does not need to be used from native callers because you have to release the statement in order to not leak. Finalize will be called for you when the reference count on the statement goes to zero.</div><p></p>

<h3 id="clone()" name="clone()">clone()</h3>

<p>Creates a copy of the statement whose state will be <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageStatement#MOZ_STORAGE_STATEMENT_READY">mozIStorageStatement.MOZ_STORAGE_STATEMENT_READY</a></code>.</p>

<pre class="eval">mozIStorageStatement clone();</pre>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>A <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement" title>mozIStorageStatement</a></code> that is a copy of the current statement.</p>

<h3 id="getParameterName()" name="getParameterName()">getParameterName()</h3>

<p>Obtains the name of the parameter for the specified index.</p>

<pre class="eval">AUTF8String getParameterName(
  in unsigned long aParamIndex
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>
 <p>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</p>
 </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>An <code><a href="/en/AUTF8String" title="en/AUTF8String">AUTF8String</a></code> representing the parameter name for the specified index.</p>

<h3 id="getParameterIndex()" name="getParameterIndex()">getParameterIndex()</h3>

<p>Obtains the index of the parameter with the specified name. This method was added in 1.9.0. In 1.8.1 you had to use <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement#getParameterIndexes()">getParameterIndexes()</a></code>. See <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=388048" title="FIXED: mozIStorageStatement::getParameterIndexes is useless">bug 388048</a> for details.</p>

<pre class="eval">unsigned long getParameterIndex(
  in AUTF8String aName
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aName</code></dt>
 <dd>Name of the parameter to get the index for. For parameter &apos;foo&apos;, name&apos;s format is &apos;:foo&apos; in 1.9.0 and 1.9.1. In 1.9.2 the &apos;:&apos; was dropped and name&apos;s value should be just &apos;foo&apos;. See <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=528166" title="mozIStorageStatement getParameterIndex causes NS_ERROR_ILLEGAL_VALUE">bug 528166</a> for details.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</p>

<h3 id="getColumnName()" name="getColumnName()">getColumnName()</h3>

<p>Obtains the name of the column for the specified index.</p>

<pre class="eval">AUTF8String getColumnName(
  in unsigned long aColumnIndex
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aColumnIndex</code></dt>
 <dd>
 <p>The zero-based numerical index for the column to get data from.</p>
 </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>An <code><a href="/en/AUTF8String" title="en/AUTF8String">AUTF8String</a></code> with the of the column name for the specified index.</p>

<h3 id="getColumnIndex()" name="getColumnIndex()">getColumnIndex()</h3>

<p>Obtains the index of the column with the specified name.</p>

<pre class="eval">unsigned long getColumnIndex(
  in AUTF8String aName
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aName</code></dt>
 <dd>Name of the column.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>The zero-based numerical index for the column to get data from.</p>

<h3 id="reset()" name="reset()">reset()</h3>

<p>Resets the bound parameters and statement execution state. This <strong>must</strong> be called before reusing the statement.</p>

<p></p><div class="note notecard"><strong>Note:</strong> JavaScript callers should always wrap their execution in a try block, and have a reset statement in a finally block.</div><p></p>

<p>See the <a class="internal" href="/en/Storage#Resetting_a_Statement" title="Resetting a Statement">overview document on storage</a> for more details.</p>

<pre class="eval">void reset()
</pre>

<h3 id="escapeStringForLIKE()" name="escapeStringForLIKE()">escapeStringForLIKE()</h3>

<p>Escapes a string for SQL LIKE search.</p>

<p></p><div class="note notecard"><strong>Note:</strong> Consumers will have to use same escape char when doing statements such as: <code>...LIKE &apos;?1&apos; ESCAPE &apos;/&apos;...</code>. See the sample code for more details.</div><p></p>

<pre class="eval">AString escapeStringForLIKE(
  in AString aValue,
  in wchar aEscapeChar
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aValue</code></dt>
 <dd>String to escape for SQL LIKE.</dd>
 <dt><code>aEscapeChar</code></dt>
 <dd>The escape character to use. Generally, <code>/</code> will be sufficient.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>An UTF-16 encoded string that has characters that have special meaning escaped from <code>aValue</code>.</p>

<h6 id="Sample_Code">Sample Code</h6>

<pre class="brush: js">var statement = dbConn.createStatement(
  &quot;SELECT * &quot; +
  &quot;FROM table_name &quot; +
  &quot;WHERE column_name LIKE :userInput ESCAPE &apos;/&apos;&quot;
);
statement.params.userInput = statement.escapeStringForLIKE(someUserInput, &quot;/&quot;);</pre>

<h2 id="Binding_functions" name="Binding_functions">Binding Functions</h2>

<p>These functions are discussed in more detail with sample code in the <a class="internal" href="/en/Storage#Binding_Parameters" title="Binding Parameters">overview document</a>.</p>

<p id="newBindingParamsArray()"></p><h3 id="newBindingParamsArray()_2">newBindingParamsArray()</h3><p></p>

<p>Creates and returns a new <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParamsArray" title>mozIStorageBindingParamsArray</a></code> object that can be used to bind multiple values to parameters in preparation for calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement#executeAsync()">executeAsync()</a></code>.</p>

<pre>mozIStorageBindingParamsArray newBindingParamsArray();
</pre>

<h6 id="Parameters_2">Parameters</h6>

<p>None.</p>

<p id="bindParameters()"></p><h3 id="bindParameters()_2">bindParameters()</h3><p></p>

<p>Binds all the parameters in the specified array to the statement in preparation for calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement#executeAsync()">executeAsync()</a></code>.</p>

<div class="note notecard"><strong>Note:</strong> Starting in <span title="(Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)">Gecko 2.0</span>, this method returns <code>NS_ERROR_UNEXPECTED</code> if the specified <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParamsArray" title>mozIStorageBindingParamsArray</a></code> is empty.</div>

<pre>void bindParameters(
  in mozIStorageBindingParamsArray aParameters
);
</pre>

<h6 id="Parameters_3">Parameters</h6>

<dl>
 <dt>aParameters</dt>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParamsArray" title>mozIStorageBindingParamsArray</a></code> object containing one or more <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParams" title>mozIStorageBindingParams</a></code> objects with the parameters to be bound to the statement prior to execution.</dd>
</dl>

<h3 id="bindUTF8StringParameter()" name="bindUTF8StringParameter()">bindUTF8StringParameter()</h3>

<p>Binds a UTF8String to the specified index.</p>

<pre class="eval">void bindUTF8StringParameter(
  in unsigned long aParamIndex,
  in AUTF8String aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</dd>
 <dt><code>aValue</code></dt>
 <dd>to be bound to the specified index.</dd>
</dl>

<h3 id="bindStringParameter()" name="bindStringParameter()">bindStringParameter()</h3>

<p>Binds a string parameter to the specified index.</p>

<pre class="eval">void bindStringParameter(
  in unsigned long aParamIndex,
  in AString aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</dd>
 <dt><code>aValue</code></dt>
 <dd>to be bound to the specified index.</dd>
</dl>

<h3 id="bindDoubleParameter()" name="bindDoubleParameter()">bindDoubleParameter()</h3>

<p>Binds a double parameter to the specified index.</p>

<pre class="eval">void bindDoubleParameter(
  in unsigned long aParamIndex,
  in double aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</dd>
 <dt><code>aValue</code></dt>
 <dd>to be bound to the specified index.</dd>
</dl>

<h3 id="bindInt32Parameter()" name="bindInt32Parameter()">bindInt32Parameter()</h3>

<p>Binds an Int32 parameter to the specified index.</p>

<pre class="eval">void bindInt32Parameter(
  in unsigned long aParamIndex,
  in long aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</dd>
 <dt><code>aValue</code></dt>
 <dd>to be bound to the specified index.</dd>
</dl>

<h3 id="bindInt64Parameter()" name="bindInt64Parameter()">bindInt64Parameter()</h3>

<p>Binds an Int64 parameter to the specified index.</p>

<pre class="eval">void bindInt64Parameter(
  in unsigned long aParamIndex,
  in long long aValue
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</dd>
 <dt><code>aValue</code></dt>
 <dd>to be bound to the specified index.</dd>
</dl>

<h3 id="bindNullParameter()" name="bindNullParameter()">bindNullParameter()</h3>

<p>Binds a null parameter to the specified index.</p>

<pre class="eval">void bindNullParameter(
  in unsigned long aParamIndex
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</dd>
</dl>

<h3 id="bindBlobParameter()" name="bindBlobParameter()">bindBlobParameter()</h3>

<p>Binds a blob parameter to the specified index.</p>

<pre class="eval">void bindBlobParameter(
  in unsigned long aParamIndex,
  [array,const,size_is(aValueSize)] in octet aValue,
  in unsigned long aValueSize
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aParamIndex</code></dt>
 <dd>The zero-based numerical index for the parameter to be bound. This will be one less than the number used in the SQL (&lt;code&gt;?1&lt;/code&gt; maps to &lt;code&gt;0&lt;/code&gt;, and so on).</dd>
 <dt><code>aValue</code></dt>
 <dd>to be bound to the specified index.</dd>
 <dt><code>aValueSize</code></dt>
 <dd>Size of <code>aValue</code>.</dd>
</dl>

<h2 id="Execution_Functions">Execution Functions</h2>

<p>These functions are discussed in more detail with sample code in the <a class="internal" href="/en/Storage#Executing_a_Statement" title="Executing a Statement">overview document</a>.</p>

<p id="executeAsync()"></p><h3 id="executeAsync()_2">executeAsync()</h3><p></p>

<p>Starts the execution of a query asynchronously using the currently bound parameters. The optional callback routine receives notifications about the progress of the query. For sample code and more details, see the <a class="internal" href="/en/Storage#Asynchronously" title="Asynchronous Statement Execution">overview document</a>.</p>

<p></p><div class="note notecard"><strong>Note:</strong> The statement does not have to be reset before being reused.</div><p></p>

<pre>mozIStoragePendingStatement executeAsync(
  [optional] mozIStorageStatementCallback aCallback
);
</pre>

<h6 id="Parameters_4">Parameters</h6>

<dl>
 <dt><code>aCallback</code></dt>
 <dd>A callback object that will be notified of progress, errors, and query completion. This parameter is optional.</dd>
</dl>

<h6 id="Return_value_2">Return value</h6>

<p>A <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStoragePendingStatement" title>mozIStoragePendingStatement</a></code> object that can be used to cancel the execution of the statement.</p>

<h3 id="executeStep()">executeStep()</h3>

<p>Executes a query with the currently bound parameters, and steps through the results one row at a time. For sample code and more details, see the <a class="internal" href="/en/Storage#Synchronously" title="Executing a Statement Synchronously">overview document</a>.</p>

<p></p><div class="note notecard"><strong>Note:</strong> The statement must be reset before being reused.</div><p></p>

<pre class="eval">boolean executeStep();
</pre>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Returns a <code>boolean</code> indicating whether there are more rows or not. Row data may be accessed using <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageValueArray" title>mozIStorageValueArray</a></code> methods on the statement.</p>

<p id="step()"></p><h3 id="step()_2">step()</h3><p></p>

<p>Identical to calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement#executeStep()">executeStep()</a></code>, and then calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement#reset()">reset()</a></code> when no more rows are returned.</p>

<div class="note notecard"><strong>Note:</strong> This method may only be called from JavaScript code.</div>

<pre>boolean step()</pre>

<h6 id="Return_value_3">Return value</h6>

<p><code>true</code> if there are more rows left in the results, otherwise <code>false</code>.</p>

<h3 id="execute()">execute()</h3>

<p>Execute the query, ignoring any results. This is accomplished by calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement#executeStep()">executeStep()</a></code>, and then calling <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement#reset()">reset()</a></code>.</p>

<pre class="eval"> void execute();
</pre>

<h2 id="See_also" name="See_also">See also</h2>

<ul>
 <li><a href="/en/Storage">Storage</a> introduction and how-to article</li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageConnection">mozIStorageConnection</a></code> Database connection to a specific file or in-memory data storage</li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageValueArray">mozIStorageValueArray</a></code> Wraps an array of SQL values, such as a result row.</li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageFunction">mozIStorageFunction</a></code> Create a new SQLite function.</li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAggregateFunction">mozIStorageAggregateFunction</a></code> Create a new SQLite aggregate function.</li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageProgressHandler">mozIStorageProgressHandler</a></code> Monitor progress during the execution of a statement.</li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAsyncStatement">mozIStorageAsyncStatement</a></code></li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatementWrapper">mozIStorageStatementWrapper</a></code> Storage statement wrapper</li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParams">mozIStorageBindingParams</a></code></li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBindingParamsArray">mozIStorageBindingParamsArray</a></code></li>
</ul>
