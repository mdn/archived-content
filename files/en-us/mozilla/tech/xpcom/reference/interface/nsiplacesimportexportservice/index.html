---
title: nsIPlacesImportExportService
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIPlacesImportExportService
tags:
  - Bookmarks
  - Interfaces
  - 'Interfaces:Scriptable'
  - Places
  - XPCOM Interface Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/places/nsIPlacesImportExportService.idl" rel="custom">toolkit/components/places/nsIPlacesImportExportService.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

Provides methods for exporting Places data.
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>

  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 8.571428571428571%;"></div>

<div style="height: 8px; top: 16px; left: 8.571428571428571%; background: #00dd00; position: absolute; width: 91.42857142857143%;" title="Introduced in Gecko 1.9 (Firefox 3)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 8.571428571428571%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 8.571428571428571%;">Gecko 1.9</div>

    <div style="height: 8px; top: 16px; left: 25.21428571428571%; background: #eeee00; position: absolute; width: 1%; border-radius: 4px; -webkit-border-radius: 4px;" title="Last changed in Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)"></div>

</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)</span></div>
</div><p></p>

<p>In the past, this interface also offered methods for importing Places data, but those methods are now part of the BookmarkHTMLUtils.jsm JavaScript code module. The interface name has been kept for compatibility reasons for code using the export service.</p>

<p>Implemented by: <code>@mozilla.org/import-export-service;1</code> as a service:</p>

<pre class="eval">var placesImportExportService = Components.classes["@mozilla.org/<span id="the-code"><span class="s">import-export-service;1</span></span>"]
                                .getService(Components.interfaces.nsIPlacesImportExportService);
</pre>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#backupBookmarksFile()">backupBookmarksFile</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#exportHTMLToFile()">exportHTMLToFile</a>(in nsILocalFile aFile);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#importHTMLFromFile()">importHTMLFromFile</a>(in nsILocalFile aFile, in boolean aIsInitialImport);</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)">Obsolete since Gecko 14.0</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#importHTMLFromFileToFolder()">importHTMLFromFileToFolder</a>(in nsILocalFile aFile, in PRInt64 aFolder, in boolean aIsInitialImport);</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)">Obsolete since Gecko 14.0</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#importHTMLFromURI()">importHTMLFromURI</a>(in nsIURI aURI, in boolean aIsInitialImport);</code>  <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)">Obsolete since Gecko 14.0</span></td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="backupBookmarksFile()" name="backupBookmarksFile()">backupBookmarksFile()</h3>

<p>Backs up the bookmarks.html file.</p>

<pre class="eval">void backupBookmarksFile();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="exportHTMLToFile()" name="exportHTMLToFile()">exportHTMLToFile()</h3>

<p>Saves the current bookmarks hierarchy to a <code>bookmarks.html</code> file.</p>

<pre class="eval">void exportHTMLToFile(
  in nsILocalFile aFile
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aFile</code></dt>
 <dd>An <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsILocalFile" title="">nsILocalFile</a></code> indicating where to save the new <code>bookmarks.html</code> file.</dd>
</dl>

<p></p><div class="headingWithIndicator">
        <h3 id="importHTMLFromFile()">importHTMLFromFile()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)</span>
        </div><p></p>

<div class="note"><strong>Note:</strong> This method has been removed; use the BookmarkHTMLUtils.jsm JavaScript code module instead.</div>

<p>Loads the given <code>bookmarks.html</code> file and replaces it with the current bookmarks hierarchy (if aIsInitialImport is <code>true</code>) or appends it (if <code>aIsInitialImport</code> is <code>false</code>).</p>

<p>Three <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIObserverService" title="">nsIObserverService</a></code> notifications are fired as a result of the import. "bookmarks-restore-begin" is fired just before the import is started. "bookmarks-restore-success" is fired right after the bookmarks are successfully imported. "bookmarks-restore-failed" is fired right after a failure occurs when importing the bookmarks. Observers will be passed through their data parameters either "html" if <code>aIsInitialImport</code> is <code>false</code> or "html-initial" if <code>aIsInitialImport</code> is <code>true</code>. The observer subject will be <code>null</code>.</p>

<pre class="eval">void importHTMLFromFile(
  in nsILocalFile aFile,
  in boolean aIsInitialImport
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aFile</code></dt>
 <dd>The HTML file to import into Places.</dd>
 <dt><code>aIsInitialImport</code></dt>
 <dd>Whether this is an initial import or not.</dd>
</dl>

<p></p><div class="headingWithIndicator">
        <h3 id="importHTMLFromFileToFolder()">importHTMLFromFileToFolder()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)</span>
        </div><p></p>

<div class="note"><strong>Note:</strong> This method has been removed; use the BookmarkHTMLUtils.jsm JavaScript code module instead.Loads the given bookmarks.html file and puts it in the given folder.</div>

<p>Three <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIObserverService" title="">nsIObserverService</a></code> notifications are fired as a result of the import. "bookmarks-restore-begin" is fired just before the import is started. "bookmarks-restore-success" is fired right after the bookmarks are successfully imported. "bookmarks-restore-failed" is fired right after a failure occurs when importing the bookmarks. Observers will be passed through their data parameters either "html" if aIsInitialImport is <code>false</code> or "html-initial" if <code>aIsInitialImport</code> is <code>true</code>. The observer subject will be an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupportsPRInt64" title="">nsISupportsPRInt64</a></code> whose value is aFolder.</p>

<pre class="eval">void importHTMLFromFileToFolder(
  in nsILocalFile aFile,
  in PRInt64 aFolder,
  in boolean aIsInitialImport
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aFile</code></dt>
 <dd>The file to import.</dd>
 <dt><code>aFolder</code></dt>
 <dd>The ID of the bookmarks folder into which to import the bookmarks.</dd>
 <dt><code>aIsInitialImport</code></dt>
 <dd>Whether or not this is an initial import.</dd>
</dl>

<p></p><h3 id="importHTMLFromURI()">importHTMLFromURI()</h3><p></p>

<p></p><div class="blockIndicator obsolete obsoleteHeader"><p><strong><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span> Obsolete since Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)</strong><br>This feature is obsolete. Although it may still work in some browsers, its use is discouraged since it could be removed at any time. Try to avoid using it.</p></div><p></p>

<div class="note"><strong>Note:</strong> This method has been removed; use the BookmarkHTMLUtils.jsm JavaScript code module instead.</div>

<p>Same thing as <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPlacesImportExportService#importHTMLFromFile()">importHTMLFromFile()</a></code>, but takes a URI instead.</p>

<pre class="eval">void importHTMLFromURI(
  in nsIURI aURI,
  in boolean aIsInitialImport
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aURI</code></dt>
 <dd>The URI from which to import bookmarks.</dd>
 <dt><code>aIsInitialImport</code></dt>
 <dd>Whether or not this is an initial import.</dd>
</dl>

<h2 id="See_also" name="See_also">See also</h2>

<ul>
 <li>BookmarkHTMLUtils.jsm</li>
</ul>
