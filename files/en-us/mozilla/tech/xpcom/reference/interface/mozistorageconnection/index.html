---
title: mozIStorageConnection
slug: Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageConnection
tags:
  - Interfaces
  - Storage
  - XPCOM
  - XPCOM API Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/storage/public/mozIStorageConnection.idl" rel="custom">storage/public/mozIStorageConnection.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface represents a database connection attached to a specific file or an in-memory database. It is the primary interface for interacting with a database, including creating prepared statements, executing SQL, and examining database errors.
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">68</div>

  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 5.555555555555555%;"></div>

<div style="height: 8px; top: 16px; left: 5.555555555555555%; background: #00dd00; position: absolute; width: 94.44444444444444%;" title="Introduced in Gecko 1.8 (Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 5.555555555555555%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 5.555555555555555%;">Gecko 1.8</div>

    <div style="height: 8px; top: 16px; left: 10.61111111111111%; background: #eeee00; position: absolute; width: 1%; border-radius: 4px; -webkit-border-radius: 4px;" title="Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)"></div>

</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title>nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span></div>
</div><p></p>

<p>For a general overview on how to use this interface, see <a href="/en/Storage" title="en/Storage">Storage</a>.</p>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
	<tbody>
		<tr>
			<td><code>void <a href="#asyncClose()">asyncClose</a>([optional] in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageCompletionCallback" title>mozIStorageCompletionCallback</a></code> aCallback);</code> </td>
		</tr>
		<tr>
			<td><code>void <a href="#beginTransaction()">beginTransaction</a>();</code></td>
		</tr>
		<tr>
			<td><code>void <a href="#beginTransactionAs()">beginTransactionAs</a>(in PRInt32 transactionType);</code></td>
		</tr>
		<tr>
			<td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement" title>mozIStorageStatement</a></code> <a href="#clone()">clone</a>([optional] in boolean aReadOnly);</code> </td>
		</tr>
		<tr>
			<td><code>void <a href="#close()">close</a>();</code> </td>
		</tr>
		<tr>
			<td><code>void <a href="#commitTransaction()">commitTransaction</a>();</code></td>
		</tr>
		<tr>
			<td><code>void <a href="#createAggregateFunction()">createAggregateFunction</a>(in AUTF8String aFunctionName, in long aNumArguments, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAggregateFunction" title>mozIStorageAggregateFunction</a></code> aFunction);</code> </td>
		</tr>
		<tr>
			<td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAsyncStatement" title>mozIStorageAsyncStatement</a></code> <a href="#createAsyncStatement()">createAsyncStatement</a>(in AUTF8String aSQLStatement);</code> </td>
		</tr>
		<tr>
			<td><code>void <a href="#createFunction()">createFunction</a>(in AUTF8String aFunctionName, in long aNumArguments, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageFunction" title>mozIStorageFunction</a></code> aFunction);</code></td>
		</tr>
		<tr>
			<td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement" title>mozIStorageStatement</a></code> <a href="#createStatement()">createStatement</a>(in AUTF8String aSQLStatement);</code></td>
		</tr>
		<tr>
			<td><code>void <a href="#createTable()">createTable</a>(in string aTableName, in string aTableSchema);</code></td>
		</tr>
		<tr>
			<td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStoragePendingStatement" title>mozIStoragePendingStatement</a></code> <a href="#executeAsync()">executeAsync</a>([array, size_is(aNumStatements)] in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageBaseStatement" title>mozIStorageBaseStatement</a></code> aStatements, in unsigned long aNumStatements, [optional] in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatementCallback" title>mozIStorageStatementCallback</a></code> aCallback );</code> </td>
		</tr>
		<tr>
			<td><code>void <a href="#executeSimpleSQL()">executeSimpleSQL</a>(in AUTF8String aSQLStatement);</code></td>
		</tr>
		<tr>
			<td><code>boolean <a href="#indexExists()">indexExists</a>(in AUTF8String aIndexName);</code></td>
		</tr>
		<tr>
			<td><code>void <a href="#preload()">preload</a>();</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 3)">Obsolete since Gecko 1.9</span></td>
		</tr>
		<tr>
			<td><code>void <a href="#removeFunction()">removeFunction</a>(in AUTF8String aFunctionName);</code> </td>
		</tr>
		<tr>
			<td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageProgressHandler" title>mozIStorageProgressHandler</a></code> <a href="#removeProgressHandler()">removeProgressHandler</a>();</code> </td>
		</tr>
		<tr>
			<td><code>void <a href="#rollbackTransaction()">rollbackTransaction</a>();</code></td>
		</tr>
		<tr>
			<td><code>void <a href="#setGrowthIncrement()">setGrowthIncrement</a>(in PRInt32 aIncrement, in AUTF8String aDatabaseName);</code> </td>
		</tr>
		<tr>
			<td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageProgressHandler" title>mozIStorageProgressHandler</a></code> <a href="#setProgressHandler()">setProgressHandler</a>(in PRInt32 aGranularity, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageProgressHandler" title>mozIStorageProgressHandler</a></code> aHandler);</code> </td>
		</tr>
		<tr>
			<td><code>boolean <a href="#tableExists()">tableExists</a>(in AUTF8String aTableName);</code></td>
		</tr>
	</tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
	<tbody>
		<tr>
			<td class="header">Attribute</td>
			<td class="header">Type</td>
			<td class="header">Description</td>
		</tr>
		<tr>
			<td><code>connectionReady</code></td>
			<td><code><a href="/en/boolean" title="en/boolean">boolean</a></code></td>
			<td>Indicates if the connection is open and ready to use. This will be <code>false</code> if the connection failed to open, or it has been closed. <strong>Read only.</strong></td>
		</tr>
		<tr>
			<td><code>databaseFile</code></td>
			<td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIFile" title>nsIFile</a></code></code></td>
			<td>The current database <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIFile" title>nsIFile</a></code>. <code>null</code> if the database connection refers to an in-memory database. <strong>Read only.</strong></td>
		</tr>
		<tr>
			<td><code>lastError</code></td>
			<td><code><a href="/en/long" title="en/long">long</a></code></td>
			<td>The last SQLite error code that occurred. <strong>Read only.</strong>
			<p></p><div class="note notecard"><strong>Note:</strong> This is not reliable if you are using asynchronous statements or if you are using the connection on multiple threads.</div><p></p>
			</td>
		</tr>
		<tr>
			<td><code>lastErrorString</code></td>
			<td><code><a href="/en/AUTF8String" title="en/AUTF8String">AUTF8String</a></code></td>
			<td>The English error string reported by the SQLite library for the last SQLite operation. <strong>Read only.</strong>
			<p></p><div class="note notecard"><strong>Note:</strong> This is not reliable if you are using asynchronous statements or if you are using the connection on multiple threads.</div><p></p>
			</td>
		</tr>
		<tr>
			<td><code>lastInsertRowID</code></td>
			<td><code><a href="/en/long_long" title="en/long long">long long</a></code></td>
			<td>The row ID from the last SQL <code>INSERT</code> operation. <strong>Read only.</strong>
			<p></p><div class="note notecard"><strong>Note:</strong> This is not reliable if you are using asynchronous statements or if you are using the connection on multiple threads.</div><p></p>
			</td>
		</tr>
		<tr>
			<td><code>schemaVersion</code></td>
			<td><code><a href="/en/long" title="en/long">long</a></code></td>
			<td>The schema version of the database. This should not be used until the database is ready. The version will be reported as 0 if it is not set. </td>
		</tr>
		<tr>
			<td><code>transactionInProgress</code></td>
			<td><code><a href="/en/boolean" title="en/boolean">boolean</a></code></td>
			<td>Returns <code>true</code> if there is a transaction in progress on the database. Otherwise returns <code>false</code>. <strong>Read only.</strong></td>
		</tr>
	</tbody>
</table>

<h2 id="Constants" name="Constants">Constants</h2>

<h3 id="Transaction_execution_time_constants.">Transaction execution time constants.</h3>

<table class="standard-table">
	<tbody>
		<tr>
			<td class="header">Constant</td>
			<td class="header">Value</td>
			<td class="header">Description</td>
		</tr>
		<tr>
			<td><code>TRANSACTION_DEFERRED</code></td>
			<td><code>0</code></td>
			<td>No database lock is obtained until the first statement is run.</td>
		</tr>
		<tr>
			<td><code>TRANSACTION_IMMEDIATE</code></td>
			<td><code>1</code></td>
			<td>A <a class="external" href="http://sqlite.org/lockingv3.html#reserved_lock" title="http://sqlite.org/lockingv3.html#reserved_lock">reserved lock</a> is obtained on the database.</td>
		</tr>
		<tr>
			<td><code>TRANSACTION_EXCLUSIVE</code></td>
			<td><code>2</code></td>
			<td>An <a class="external" href="http://sqlite.org/lockingv3.html#exclusive_lock" title="http://sqlite.org/lockingv3.html#exclusive_lock">exclusive lock</a> is obtained on the database.</td>
		</tr>
	</tbody>
</table>

<h3 id="SQLite_database_page_size_constant">SQLite database page size constant</h3>

<table class="standard-table">
	<tbody>
		<tr>
			<td class="header">Constant</td>
			<td class="header">Value</td>
			<td class="header">Description</td>
		</tr>
		<tr>
			<td><code>DEFAULT_PAGE_SIZE</code></td>
			<td><code>32768</code></td>
			<td>The default size for SQLite database pages. This is used by the Storage API when creating new databases, and must match the <code>SQLITE_DEFAULT_PAGE_SIZE</code> configured in <code><a href="https://dxr.mozilla.org/mozilla-central/source/db/sqlite3/src/Makefile.in" rel="custom">db/sqlite3/src/Makefile.in</a></code>. </td>
		</tr>
	</tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<p></p><h3 id="asyncClose()">asyncClose()</h3><p></p>

<p>Asynchronously closes a database connection, allowing all pending asynchronous statements to complete first.</p>

<pre class="eval">void asyncClose(
  in mozIStorageCompletionCallback aCallback <span class="optional optionalInline notecard inline">Optional</span>
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aCallback</code> <span class="optional optionalInline notecard inline">Optional</span></dt>
	<dd>An optional callback handler to be executed when the connection is successfully closed. That object&apos;s <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageCompletionCallback#complete()">mozIStorageCompletionCallback.complete()</a></code> routine will be called once the connection is closed.</dd>
</dl>

<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>

<dl>
	<dt><code>NS_ERROR_UNEXPECTED</code></dt>
	<dd>Thrown if the method was called on a thread other than the one that opened the connection.</dd>
</dl>

<h3 id="beginTransaction()" name="beginTransaction()">beginTransaction()</h3>

<p>Starts a new transaction DEFERRED transaction. This is the same as calling <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageConnection" title>mozIStorageConnection</a></code> with <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#TRANSACTION_DEFERRED">mozIStorageConnection.TRANSACTION_DEFERRED.</a></code></p>

<pre class="eval"> void beginTransaction();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="beginTransactionAs()" name="beginTransactionAs()">beginTransactionAs()</h3>

<p>This method starts a new transaction of the given transaction type. See the <a class="external" href="http://sqlite.org/lang_transaction.html" title="http://sqlite.org/lang_transaction.html">SQLite documentation on transactions</a> for more details.</p>

<p>In JavaScript, managing transactions can be difficult when you are using the same connection on different threads, or are using a combination of asynchronous and synchronous statement execution. The best way to deal with this is to only execute your statements asynchronously using <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#executeAsync()">mozIStorageConnection.executeAsync()</a></code>. This method will manage the transactions for you, so you don&apos;t have to worry about them.</p>

<p></p><div class="note notecard"><strong>Note:</strong> The database engine does not support nested transactions, so attempting to start a transaction when one is already active will throw an exception.</div><p></p>

<pre class="eval"> void beginTransactionAs(
   in PRInt32 transactionType
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>transactionType</code></dt>
	<dd>One of the transaction constants (<code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#TRANSACTION_DEFERRED">mozIStorageConnection.TRANSACTION_DEFERRED</a></code>, <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#TRANSACTION_IMMEDIATE">mozIStorageConnection.TRANSACTION_IMMEDIATE</a></code>, <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#TRANSACTION_EXCLUSIVE">mozIStorageConnection.TRANSACTION_EXCLUSIVE</a></code>)</dd>
</dl>

<p></p><h3 id="clone()">clone()</h3><p></p>

<p>Clones a database connection, optionally making the new connection read only.</p>

<p></p><div class="note notecard"><strong>Note:</strong> If your connection is already read-only, you will get a read-only clone.</div><p></p>

<div class="note"><strong>Note:</strong> Due to a bug in SQLite, if you use the shared cache (by calling <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageService#openDatabase()">mozIStorageService.openDatabase()</a></code>), the cloned connection&apos;s access privileges will be the same as the original connection, regardless of the value you specify for the <code>aReadOnly</code> parameter.</div>

<pre class="eval">mozIStorageConnection clone(
  in boolean aReadOnly <span class="optional optionalInline notecard inline">Optional</span>
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aReadOnly</code></dt>
	<dd>If <code>true</code>, the returned database connection is in read only mode. This is <code>false</code> by default.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>A new <code>mozIStorageConnection</code> object representing the cloned connection.</p>

<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>

<dl>
	<dt><code>NS_ERROR_UNEXPECTED</code></dt>
	<dd>The connection is to a memory database.</dd>
</dl>

<p></p><h3 id="close()">close()</h3><p></p>

<p>Closes a database connection. Before closing the connection, you need to finalize all statements created for the connection.</p>

<div class="note"><strong>Note:</strong> You must not call this method if any asynchronous statements have been executed on the connection. Instead, you should call <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageConnection#asyncClose()">asyncClose()</a></code>.</div>

<pre class="eval">void close();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>

<dl>
	<dt><code>NS_ERROR_UNEXPECTED</code></dt>
	<dd>Thrown if any statement has been executed asynchronously on the connection, or if the method was called on a thread other than the one that opened the connection.</dd>
</dl>

<h3 id="commitTransaction()" name="commitTransaction()">commitTransaction()</h3>

<p>This method commits the current transaction.</p>

<pre class="eval"> void commitTransaction();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><h3 id="createAggregateFunction()">createAggregateFunction()</h3><p></p>

<p>This method creates a new aggregate function that can be used in SQL. See <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAggregateFunction" title>mozIStorageAggregateFunction</a></code> for sample code and more details.</p>

<p>If you use your connection on multiple threads, your function needs to be threadsafe, or it should only be called on one thread.</p>

<pre class="eval"> void createAggregateFunction(
   in AUTF8String aFunctionName,
   in long aNumArguments,
   in mozIStorageAggregateFunction aFunction
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aFunctionName</code></dt>
	<dd>The name of the aggregate function to create, as seen in SQL.</dd>
	<dt><code>aNumArguments</code></dt>
	<dd>The number of arguments the function takes. Pass <code>-1</code> for variable-argument functions.</dd>
	<dt><code>aFunction</code></dt>
	<dd>The instance of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAggregateFunction" title>mozIStorageAggregateFunction</a></code> that implements the function.</dd>
</dl>

<p></p><h3 id="createAsyncStatement()">createAsyncStatement()</h3><p></p>

<p>Creates a <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAsyncStatement" title>mozIStorageAsyncStatement</a></code> for the given SQL expression. An asynchronous statement can only be used to dispatch asynchronous requests to the asynchronous execution thread and cannot be used to take any synchronous actions on the database.</p>

<p>The expression may use <code>&quot;?#&quot;</code> to indicate sequentially numbered parameters (?1, ?2, etc) or <code>&quot;:name&quot;</code> to indicate named parameters. JavaScript callers should use named parameters.</p>

<pre class="eval">mozIStorageAsyncStatement createAsyncStatement(
   in AUTF8String aSQLStatement
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aSQLStatement</code></dt>
	<dd>The SQL statement to execute.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Returns a new <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageAsyncStatement" title>mozIStorageAsyncStatement</a></code> to be used to execute the specified statement.</p>

<h3 id="createFunction()" name="createFunction()">createFunction()</h3>

<p>Creates a new function that can be used in SQL. See <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageFunction" title>mozIStorageFunction</a></code> for sample code and more details.</p>

<p>If you use your connection on multiple threads, your function needs to be threadsafe, or it should only be called on one thread.</p>

<pre class="eval"> void createFunction(
   in AUTF8String aFunctionName,
   in long aNumArguments,
   in mozIStorageFunction aFunction
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aFunctionName</code></dt>
	<dd>The name of function to create, as seen in SQL.</dd>
	<dt><code>aNumArguments</code></dt>
	<dd>The number of arguments the function takes. Pass <code>-1</code> for variable-argument functions.</dd>
	<dt><code>aFunction</code></dt>
	<dd>The instance of <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageFunction" title>mozIStorageFunction</a></code> that implements the function.</dd>
</dl>

<h3 id="createStatement()" name="createStatement()">createStatement()</h3>

<p>Creates a <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement" title>mozIStorageStatement</a></code> for the given SQL expression. The expression may use <code>&quot;?#&quot;</code> to indicate sequentially numbered parameters (?1, ?2, etc) or <code>&quot;:name&quot;</code> to indicate named parameters. JavaScript callers should use named parameters.</p>

<pre class="eval"> mozIStorageStatement createStatement(
   in AUTF8String aSQLStatement
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aSQLStatement</code></dt>
	<dd>The SQL statement to execute.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Returns a new <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement" title>mozIStorageStatement</a></code> to be used to execute the specified statement.</p>

<div class="note">
<p><strong>Note</strong></p>

<p>If the statement is meant to be executed asynchronously, you should rather create it with <a href="#createAsyncStatement()" title="#createAsyncStatement()">createAsyncStatement</a>. The resulting statement will be faster to execute. Additionally, the system will be able to inform you if you erroneously attempt to execute it synchronously.</p>
</div>

<h3 id="createTable()" name="createTable()">createTable()</h3>

<p>This method creates a table with the given table name and schema.</p>

<pre class="eval"> void createTable(
   in string aTableName,
   in string aTableSchema
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aTableName</code></dt>
	<dd>The name of the table to create; table names may consist of the letters A-Z in either upper or lower case, the underscore, and the digits 0-9. The first character must be a letter.</dd>
	<dt><code>aTableSchema</code></dt>
	<dd>The table&apos;s schema. This should be specified using the same syntax the <code>CREATE TABLE</code> statement uses. For example: <code>&quot;foo INTEGER, bar STRING&quot;</code>.</dd>
</dl>

<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>

<dl>
	<dt><code>NS_ERROR_FAILURE</code></dt>
	<dd>Table already exists or the requested table couldn&apos;t be created.</dd>
</dl>

<p></p><h3 id="executeAsync()">executeAsync()</h3><p></p>

<p>Asynchronously executes an array of queries created with this connection, using any currently bound parameters. The statements are run wrapped in a transaction.</p>

<p></p><div class="note notecard"><strong>Note:</strong> The statements may be reused immediately, and the statements do not need to be reset individually.</div><p></p>

<pre class="eval">mozIStoragePendingStatement executeAsync(
  [array, size_is(aNumStatements)] in mozIStorageBaseStatement aStatements,
  in unsigned long aNumStatements,
  in mozIStorageStatementCallback aCallback <span class="optional optionalInline notecard inline">Optional</span>
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aStatements</code></dt>
	<dd>The array of statements to execute asynchronously. They will be executed sequentially, in the order in which they appear in the array. Prior to <span title="(Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)">Gecko 2.0</span> this was type <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatement" title>mozIStorageStatement</a></code>.</dd>
	<dt><code>aNumStatements</code></dt>
	<dd>The number of statements in aStatements.</dd>
	<dt><code>aCallback</code> <span class="optional optionalInline notecard inline">Optional</span></dt>
	<dd>A <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageStatementCallback" title>mozIStorageStatementCallback</a></code> object to receive progress, error, and completion notifications.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>A <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStoragePendingStatement" title>mozIStoragePendingStatement</a></code> object that can be used to cancel the statements&apos; execution.</p>

<h3 id="executeSimpleSQL()" name="executeSimpleSQL()">executeSimpleSQL()</h3>

<p>Executes an SQL expression that has no bound parameters.</p>

<p></p><div class="warning notecard">
    <p><strong>Warning:</strong> Performing synchronous IO on the main thread can cause serious performance problems. As a result, this method of modifying the database is <strong>strongly</strong> discouraged!</p>
</div><p></p>

<pre class="eval"> void executeSimpleSQL(
   in AUTF8String aSQLStatement
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aSQLStatement</code></dt>
	<dd>The SQL statement to execute.</dd>
</dl>

<h3 id="indexExists()" name="indexExists()">indexExists()</h3>

<p>This method determines whether or not the given index exists.</p>

<pre class="eval"> boolean indexExists(
   in AUTF8String aIndexName
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aIndexName</code></dt>
	<dd>The index to check.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p><code>true</code> if the index exists, <code>false</code> otherwise.</p>

<p></p><div class="headingWithIndicator">
        <h3 id="preload()">preload()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 1.9 (Firefox 3)</span>
        </div><p></p>

<p>This is used to <code>preload</code> the database cache. It loads pages from the start of the database file until the memory cache (specified by &quot;PRAGMA cache_size=&quot;) is full or the entire file is read.</p>

<p>The cache MUST be active on the database for this to work. This means that you must have a transaction open on the connection, or have a transaction open on another connection that shares the same pager cache. This cached data will go away when the transaction is closed.</p>

<p>This <code>preload</code> operation can dramatically speed up read operations because the data is loaded as one large block. Normally, pages are read in on demand, which can cause many disk seeks.</p>

<pre class="eval">void preload();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><h3 id="removeFunction()">removeFunction()</h3><p></p>

<p>Deletes a custom SQL function that was created with either <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#createFunction()">mozIStorageConnection.createFunction()</a></code> or <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#createAggregateFunction()">mozIStorageConnection.createAggregateFunction()</a></code>.</p>

<pre class="eval"> void removeFunction(
   in AUTF8String aFunctionName
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aFunctionName</code></dt>
	<dd>The name of the function to remove.</dd>
</dl>

<p></p><h3 id="removeProgressHandler()">removeProgressHandler()</h3><p></p>

<p>Removes the progress handler that was registered with <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/mozIStorageConnection#registerProgressHandler()">mozIStorageConnection.registerProgressHandler()</a></code>.</p>

<pre class="eval"> mozIStorageProgressHandler removeProgressHandler();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Returns the previous registered handler.</p>

<h3 id="rollbackTransaction()" name="rollbackTransaction()">rollbackTransaction()</h3>

<p>This method rolls back the current transaction. This is essentially an &quot;undo,&quot; and returns the database to the state it was in before the transaction began.</p>

<pre class="eval"> void rollbackTransaction();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><h3 id="setGrowthIncrement()">setGrowthIncrement()</h3><p></p>

<p>Lets you set the amount by which the SQLite database file is grown or shrunk when resizing is necessary. This helps avoid disk fragmentation by letting you help SQLite make intelligent decisions about resizing of the file.</p>

<p></p><div class="note notecard"><strong>Note:</strong> This works by adjusting the <code>SQLITE_FCNTL_CHUNK_SIZE</code> setting in SQLite.</div><p></p>

<pre class="eval">void setGrowthIncrement(
  in PRInt32 aIncrement,
  in AUTF8String aDatabaseName
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aIncrement</code></dt>
	<dd>The number of bytes at a time the database file should grow by.</dd>
	<dt><code>aDatabaseName</code></dt>
	<dd>The database file for which to adjust the increment size. If you specify an empty string, the main database file is used. See <a class="external" href="http://sqlite.org/c3ref/file_control.html">file_control</a> for more details.</dd>
</dl>

<p></p><h3 id="setProgressHandler()">setProgressHandler()</h3><p></p>

<p>This method sets a progress handler. Only one handler can be registered at a time, so if you need more than one, you will have to chain them.</p>

<p></p><div class="note notecard"><strong>Note:</strong> If you use the asynchronous storage APIs or use your database on multiple threads, the progress handler you register must be threadsafe</div><p></p>

<pre class="eval"> mozIStorageProgressHandler setProgressHandler(
   in PRInt32 aGranularity,
   in mozIStorageProgressHandler aHandler
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aGranularity</code></dt>
	<dd>The number of SQL virtual machine steps between progress handler callbacks.</dd>
	<dt><code>aHandler</code></dt>
	<dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/mozIStorageProgressHandler" title>mozIStorageProgressHandler</a></code> instance that is being registered.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Returns the previous registered handler, or <code>null</code> if none was previously registered.</p>

<h3 id="tableExists()" name="tableExists()">tableExists()</h3>

<p>Determines if there exists a table with the given name.</p>

<pre class="eval"> boolean tableExists(
   in AUTF8String aTableName
 );
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
	<dt><code>aTableName</code></dt>
	<dd>The SQL table whose existence should be checked.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Returns <code>true</code> if the table exists, <code>false</code> otherwise.</p>

<h2 id="See_also" name="See_also">See also</h2>

<ul>
	<li><a href="/en/Storage">Storage</a> mozStorage introduction and how-to article</li>
	<li><a href="/en/mozIStorageStatement">mozIStorageStatement</a> Create and execute SQL statements on a SQLite database.</li>
	<li><a href="/en/mozIStorageValueArray">mozIStorageValueArray</a> Wraps an array of SQL values, such as a result row.</li>
	<li><a href="/en/mozIStorageFunction">mozIStorageFunction</a> Create a new SQLite function.</li>
	<li><a href="/En/MozIStorageAggregateFunction">mozIStorageAggregateFunction</a> Create a new SQLite aggregate function.</li>
	<li><a href="/en/mozIStorageProgressHandler">mozIStorageProgressHandler</a> Monitor progress during the execution of a statement.</li>
	<li><a href="/en/mozIStorageStatementWrapper">mozIStorageStatementWrapper</a> Storage statement wrapper</li>
</ul>
