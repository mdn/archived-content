<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/caps/nsIPrincipal.idl" rel="custom">caps/nsIPrincipal.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

Provides the interface to a principal, which represents a security context. On the web, for example, a typical principal is comprised of an URL scheme, host, and port.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISerializable" title="">nsISerializable</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span></div>
</div><p></p>
<p>For details on principals, how they work, and how to get the appropriate one, see <a href="/en/Security_check_basics" title="en/Security check basics">Security check basics</a>.</p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>short <a href="#canEnableCapability()">canEnableCapability</a>(in string capability);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#checkMayLoad()">checkMayLoad</a>(in nsIURI uri, in boolean report);</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#disableCapability()">disableCapability</a>(in string capability, inout voidPtr annotation);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#enableCapability()">enableCapability</a>(in string capability, inout voidPtr annotation);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#equals()">equals</a>(in nsIPrincipal other);</code></td>
  </tr>
  <tr>
   <td><code>JSPrincipals <a href="#getJSPrincipals()">getJSPrincipals</a>(in JSContext cx);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#getPreferences()">getPreferences</a>(out string prefBranch, out string id, out string subjectName, out string grantedList, out string deniedList, out boolean isTrusted);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#isCapabilityEnabled()">isCapabilityEnabled</a>(in string capability, in voidPtr annotation);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#revertCapability()">revertCapability</a>(in string capability, inout voidPtr annotation);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#setCanEnableCapability()">setCanEnableCapability</a>(in string capability, in short canEnable);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#subsumes()">subsumes</a>(in nsIPrincipal other);</code> </td>
  </tr>
 </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>certificate</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code></code></td>
   <td>The <code>certificate</code> associated with this principal, if any. If there isn't one, this will return <code>null</code>. Getting this attribute never throws. <strong>Read only.</strong> </td>
  </tr>
  <tr>
   <td><code>certificateID</code></td>
   <td><code><a href="/en/string" title="en/string">string</a></code></td>
   <td>The <code>fingerprint</code> ID of this principal's <code>certificate</code>. Throws if there is no <code>certificate</code> associated with this principal. <strong>Read only.</strong> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td>
  </tr>
  <tr>
   <td><code>commonName</code></td>
   <td><code><a href="/en/string" title="en/string">string</a></code></td>
   <td>The common name for the <code>certificate</code>. This pertains to the <code>certificate</code> authority organization. Throws if there is no <code>certificate</code> associated with this principal. <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td>
  </tr>
  <tr>
   <td><code>csp</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIContentSecurityPolicy" title="">nsIContentSecurityPolicy</a></code></code></td>
   <td>A Content Security Policy associated with this principal. <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>domain</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI" title="">nsIURI</a></code></code></td>
   <td>The <code>domain</code> <code>URI</code> to which this principal pertains. This is congruent with HTMLDocument.<code>domain</code>, and may be <code>null</code>. Setting this has no effect on the <code>URI</code>. <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>fingerprint</code></td>
   <td><code><a href="/en/AUTF8String" title="en/AUTF8String">AUTF8String</a></code></td>
   <td>The <code>fingerprint</code> ID of this principal's <code>certificate</code>. Throws if there is no <code>certificate</code> associated with this principal. <strong>Read only.</strong> </td>
  </tr>
  <tr>
   <td><code>hasCertificate</code></td>
   <td><code><a href="/en/boolean" title="en/boolean">boolean</a></code></td>
   <td>Whether this principal is associated with a <code>certificate</code>. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>hashValue</code></td>
   <td><code><a href="/en/unsigned_long" title="en/unsigned long">unsigned long</a></code></td>
   <td>Returns a hash value for the principal. <strong>Read only.</strong> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>origin</code></td>
   <td><code><a href="/en/string" title="en/string">string</a></code></td>
   <td>The <code>origin</code> of this principal's codebase <code>URI</code>. An <code>origin</code> is defined as: scheme + host + port. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>prettyName</code></td>
   <td><code><a href="/en/AUTF8String" title="en/AUTF8String">AUTF8String</a></code></td>
   <td>
    <p>The pretty name for the <code>certificate</code>. This sort of (but not really) identifies the subject of the <code>certificate</code> (the entity that stands behind the <code>certificate</code>). Note that this may be empty; prefer to get the <code>certificate</code> itself and get this information from it, since that may provide more information.</p>
    Throws if there is no <code>certificate</code> associated with this principal. <strong>Read only.</strong> </td>
  </tr>
  <tr>
   <td><code>securityPolicy</code></td>
   <td><code><a href="/en/voidPtr" title="en/voidPtr">voidPtr</a></code></td>
   <td>The <code>domain</code> security policy of the principal. <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>subjectName</code></td>
   <td><code><a href="/en/AUTF8String" title="en/AUTF8String">AUTF8String</a></code></td>
   <td>
    <p>The subject name for the <code>certificate</code>. This actually identifies the subject of the <code>certificate</code>. This may well not be a string that would mean much to a typical user on its own (e.g. it may have a number of different names all concatenated together with some information on what they mean in between).</p>
    Throws if there is no <code>certificate</code> associated with this principal. <strong>Read only.</strong> </td>
  </tr>
  <tr>
   <td><code>URI</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIURI" title="">nsIURI</a></code></code></td>
   <td>
    <p>The codebase <code>URI</code> to which this principal pertains. This is generally the document <code>URI</code>. <strong>Read only.</strong></p>
    <div class="note">
     <strong>Note:</strong> This wasn't accessible by scripts prior to Gecko 2.0.</div>
   </td>
  </tr>
 </tbody>
</table>
<h2 id="Constants" name="Constants">Constants</h2>
<h3 id="Principal_capability_constants">Principal capability constants</h3>
<p>These values indicate the capabilities of a principal. The order is significant; if an operation is performed on a set of capabilities, the minimum is computed.</p>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Constant</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>ENABLE_DENIED</code></td>
   <td><code>1</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>ENABLE_UNKNOWN</code></td>
   <td><code>2</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>ENABLE_WITH_USER_PERMISSION</code></td>
   <td><code>3</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>ENABLE_GRANTED</code></td>
   <td><code>4</code></td>
   <td> </td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="canEnableCapability">canEnableCapability</h3></div><p></p>
<pre class="eval">short canEnableCapability(
  in string capability
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>capability</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Missing Description</p>
<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>
<dl>
 <dt>
  <code>Missing Exception</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<p></p><h3 id="checkMayLoad()">checkMayLoad()</h3><p></p>
<p>Checks whether this principal is allowed to load the network resource located at the given <code>URI</code> under the same-<code>origin</code> policy. This means that codebase principals are only allowed to load resources from the same <code>domain</code>, the system principal is allowed to load anything, and <code>null</code> principals are not allowed to load anything.</p>
<div class="note">
 <strong>Note:</strong> Prior to Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1), this was not available to scripts.</div>
<p>If the load is allowed this function does nothing. If the load is not allowed the function throws <code>NS_ERROR_DOM_BAD_URI</code>.</p>
<p></p><div class="blockIndicator note"><strong>Note:</strong> Other policies might override this, such as the Access-Control specification.</div><p></p>
<p></p><div class="blockIndicator note"><strong>Note:</strong> The '<code>domain</code>' attribute has no effect on the behaviour of this function.</div><p></p>
<pre class="eval">void checkMayLoad(
  in nsIURI uri,
  in boolean report
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>uri</code></dt>
 <dd>
  Missing Description</dd>
 <dt>
  <code>report</code></dt>
 <dd>
  If <code>true</code>, will report a warning to the console service if the load is not allowed.</dd>
</dl>
<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>
<dl>
 <dt>
  <code>NS_ERROR_DOM_BAD_URI</code></dt>
 <dd>
  The load is not permitted.</dd>
</dl>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="disableCapability">disableCapability</h3></div><p></p>
<pre class="eval">void disableCapability(
  in string capability,
  inout voidPtr annotation
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>capability</code></dt>
 <dd>
  Missing Description</dd>
 <dt>
  <code>annotation</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="enableCapability">enableCapability</h3></div><p></p>
<pre class="eval">void enableCapability(
  in string capability,
  inout voidPtr annotation
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>capability</code></dt>
 <dd>
  Missing Description</dd>
 <dt>
  <code>annotation</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h3 id="equals()" name="equals()">equals()</h3>
<p>Returns whether the other principal is equivalent to this principal. Principals are considered equal if they are the same principal, they have the same <code>origin</code>, or have the same <code>certificate</code> <code>fingerprint</code> ID.</p>
<pre class="eval">boolean equals(
  in nsIPrincipal other
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>other</code></dt>
 <dd>
  The other principal to compare against.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p><code>true</code> if the two principals are equivalent; otherwise <code>false</code>.</p>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="getJSPrincipals">getJSPrincipals</h3></div><p></p>
<p>Returns the JS equivalent of the principal.</p>
<pre class="eval">JSPrincipals getJSPrincipals(
  in JSContext cx
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
</dl>
<dl>
 <dt>
  <code>cx</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Missing Description</p>
<h3 id="getPreferences()" name="getPreferences()">getPreferences()</h3>
<p>Returns the security preferences associated with this principal.</p>
<pre class="eval">void getPreferences(
  out string prefBranch,
  out string id,
  out string subjectName,
  out string grantedList,
  out string deniedList,
  out boolean isTrusted
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>prefBranch</code></dt>
 <dd>
  On return, contains the preference branch to which the preferences pertain.</dd>
 <dt>
  <code>id</code></dt>
 <dd>
  A semi-unique ID relating to either the fingerprint or the origin.</dd>
 <dt>
  <code>subjectName</code></dt>
 <dd>
  A name identifying the entity the principal represents; this may be an empty string.</dd>
 <dt>
  <code>grantedList</code></dt>
 <dd>
  Space-delineated list of capabilities which are explicitly granted by a preference.</dd>
 <dt>
  <code>deniedList</code></dt>
 <dd>
  Space-delineated list of capabilities which are explicitly denied by a preference.</dd>
 <dt>
  <code>isTrusted</code></dt>
 <dd>
  <code>true</code> if the certificate is a codebase trusted one.</dd>
</dl>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="isCapabilityEnabled">isCapabilityEnabled</h3></div><p></p>
<pre class="eval">boolean isCapabilityEnabled(
  in string capability,
  in voidPtr annotation
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>capability</code></dt>
 <dd>
  Missing Description</dd>
 <dt>
  <code>annotation</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Missing Description</p>
<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>
<dl>
 <dt>
  <code>Missing Exception</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="revertCapability">revertCapability</h3></div><p></p>
<pre class="eval">void revertCapability(
  in string capability,
  inout voidPtr annotation
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>capability</code></dt>
 <dd>
  Missing Description</dd>
 <dt>
  <code>annotation</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>
<dl>
 <dt>
  <code>Missing Exception</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="setCanEnableCapability">setCanEnableCapability</h3></div><p></p>
<pre class="eval">void setCanEnableCapability(
  in string capability,
  in short canEnable
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>capability</code></dt>
 <dd>
  Missing Description</dd>
 <dt>
  <code>canEnable</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>
<dl>
 <dt>
  <code>Missing Exception</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<p></p><h3 id="subsumes()">subsumes()</h3><p></p>
<p>Returns whether the other principal is equal to or weaker than this principal. Principals are equal if they are the same object, they have the same <code>origin</code>, or they have the same <code>certificate</code> ID. A principal always subsumes itself.</p>
<div class="note">
 <strong>Note:</strong> Prior to Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1), this was not available to scripts.</div>
<p>The system principal subsumes itself and all other principals.</p>
<p>A <code>null</code> principal (corresponding to an unknown, hence assumed minimally privileged, security context) is not equal to any other principal (including other <code>null</code> principals), and therefore does not subsume anything but itself.</p>
<p>Both codebase and <code>certificate</code> principals are subsumed by the system principal, but no codebase or <code>certificate</code> principal yet <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPrincipal#subsumes()">subsumes()</a></code> any other codebase or <code>certificate</code> principal. This may change in a future release; note that <code>nsIPrincipal</code> is unfrozen, not slated to be frozen.</p>
<p>XXXbz except see bug 147145!</p>
<p></p><div class="blockIndicator note"><strong>Note:</strong> For the future: Perhaps we should consider a <code>certificate</code> principal for a given <code>URI</code> subsuming a codebase principal for the same <code>URI</code>? Not sure what the immediate benefit would be, but I think the setup could make some code (e.g. MaybeDowngradeToCodebase) clearer.</div><p></p>
<pre class="eval">boolean subsumes(
  in nsIPrincipal other
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>other</code></dt>
 <dd>
  Missing Description</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p><code>true</code> if this principal subsumes the specified principal; otherwise <code>false</code>.</p>
<h2 id="See_also">See also</h2>
<ul>
 <li><a href="/en/Security_check_basics" title="en/Security check basics">Security check basics</a></li>
</ul>