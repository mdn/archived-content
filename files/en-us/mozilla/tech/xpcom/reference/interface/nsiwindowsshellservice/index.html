---
title: nsIWindowsShellService
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIWindowsShellService
tags:
  - Interfaces
  - 'Interfaces:Scriptable'
  - NeedsContent
  - XPCOM Interface Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/browser/components/shell/public/nsIWindowsShellService.idl" rel="custom">browser/components/shell/public/nsIWindowsShellService.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

<i>Please add a summary to this article.</i>
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIShellService" title>nsIShellService</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span></div>
</div><p></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>string <a href="#getRegistryEntry()">getRegistryEntry</a>(in long aHKeyConstant, in string aSubKeyName, in string aValueName);</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td> </tr> <tr> <td><code>void <a href="#restoreFileSettings()">restoreFileSettings</a>(in boolean aForAllUsers);</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 3)">Obsolete since Gecko 1.9</span></td> </tr> <tr> <td><code>void <a href="#shortcutMaintenance()">shortcutMaintenance</a>();</code> </td> </tr> </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table"> <tbody> <tr> <td class="header">Attribute</td> <td class="header">Type</td> <td class="header">Description</td> </tr> <tr> <td><code>desktopBackgroundColor</code></td> <td><code><a href="/en/unsigned_long">unsigned long</a></code></td> <td>The desktop background color, visible when no background image is used, or if the background image is centered and does not fill the entire screen. A rgb value, where (r &lt;&lt; 24 | g &lt;&lt; 16 | b) <span class="obsolete obsoleteInline notecard inline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td> </tr> <tr> <td><code>unreadMailCount</code></td> <td><code><a href="/en/unsigned_long">unsigned long</a></code></td> <td>The number of unread mail messages for the current user. <strong>Read only.</strong></td> </tr> </tbody>
</table>
<h2 id="Constants" name="Constants">Constants</h2>
<p>Valid starting keys for the Windows Registry.</p>
<table class="standard-table"> <tbody> <tr> <td class="header">Constant</td> <td class="header">Value</td> <td class="header">Description</td> </tr> <tr> <td><code>HKCR</code></td> <td><code>0</code></td> <td>HKEY_CLASSES_ROOT. <span class="obsolete obsoleteInline notecard inline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td> </tr> <tr> <td><code>HKCC</code></td> <td><code>1</code></td> <td>HKEY_CURRENT_CONFIG. <span class="obsolete obsoleteInline notecard inline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td> </tr> <tr> <td><code>HKCU</code></td> <td><code>2</code></td> <td>HKEY_CURRENT_USER. <span class="obsolete obsoleteInline notecard inline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td> </tr> <tr> <td><code>HKLM</code></td> <td><code>3</code></td> <td>HKEY_LOCAL_MACHINE. <span class="obsolete obsoleteInline notecard inline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td> </tr> <tr> <td><code>HKU</code></td> <td><code>4</code></td> <td>HKEY_USERS. <span class="obsolete obsoleteInline notecard inline" title="(Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)">Obsolete since Gecko 1.8</span></td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<p></p><div class="headingWithIndicator">
        <h3 id="getRegistryEntry()">getRegistryEntry()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 1.8 (Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)</span>
        </div><p></p>
<p>Retrieves a Windows Registry entry value.</p>
<pre class="eval">string getRegistryEntry(
  in long aHKeyConstant,
  in string aSubKeyName,
  in string aValueName
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aHKeyConstant</code></dt> <dd>The starting key, using the constants defined above.</dd> <dt><code>aSubKeyName</code></dt> <dd>The sub key to locate.</dd> <dt><code>aValueName</code></dt> <dd>The value to locate in the sub key. The empty string returns the default value of the sub key.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The value of the specified sub key/value, truncated to 4096 bytes.</p>
<p></p><div class="headingWithIndicator">
        <h3 id="restoreFileSettings()">restoreFileSettings()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 1.9 (Firefox 3)</span>
        </div><p></p>
<p>Restores system settings to what they were before Firefox modified them.</p>
<pre class="eval">void restoreFileSettings(
  in boolean aForAllUsers
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aForAllUsers</code> </dt> <dd>Whether or not Firefox should restore settings for all users on a multi-user system.</dd>
</dl>
<p></p><h3 id="shortcutMaintenance()">shortcutMaintenance()</h3><p></p>
<p>Provides the shell service an opportunity to do some Win7+ shortcut maintenance needed on initial startup of the browser.</p>
<pre class="eval">void shortcutMaintenance();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
