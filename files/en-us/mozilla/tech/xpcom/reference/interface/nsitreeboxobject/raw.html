<p>The <code>nsITreeBoxObject</code> interface contains information about the size and layout of a tree.</p>
<p>Further information about trees is given in the <a href="/en/XUL_Tutorial/Custom_Tree_Views" title="en/XUL_Tutorial/Custom_Tree_Views">XUL Tutorial</a>.</p>
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source//layout/xul/base/src/tree/public/nsITreeBoxObject.idl" rel="custom">/layout/xul/base/src/tree/public/nsITreeBoxObject.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

<i>Please add a summary to this article.</i>
</span>

<div style="background: #eee; padding: 2px;">
<span> </span>
<span style="text-align: right; float: right;">Last changed in Gecko 1.9 (Firefox 3)</span></div>
</div><p></p>
<p>Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code></p>
<p>To get the treeBoxObject for a tree:</p>
<pre class="eval">let boxobject = tree.boxObject;
boxobject.queryInterface("<code>Components.interfaces.nsITreeBoxObject</code>");
</pre>
<p>Or simply:</p>
<pre class="eval">let boxobject = tree.treeBoxObject;
</pre>
<h2 id="Method_Overview" name="Method_Overview">Method Overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>long <a href="#getFirstVisibleRow">getFirstVisibleRow</a>();</code></td>
  </tr>
  <tr>
   <td><code>long <a href="#getLastVisibleRow">getLastVisibleRow</a>();</code></td>
  </tr>
  <tr>
   <td><code>long <a href="#getPageLength">getPageLength</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#ensureRowIsVisible">ensureRowIsVisible</a>(in long index);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#ensureCellIsVisible">ensureCellIsVisible</a>(in long row, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#scrollToRow">scrollToRow</a>(in long index);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#scrollByLines">scrollByLines</a>(in long numLines);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#scrollByPages">scrollByPages</a>(in long numPages);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#scrollToCell">scrollToCell</a>(in long row, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#scrollToColumn">scrollToColumn</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#scrollToHorizontalPosition">scrollToHorizontalPosition</a>(in long horizontalPosition);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#invalidate">invalidate</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#invalidateColumn">invalidateColumn</a>(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#invalidateRow">invalidateRow</a>(in long index);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#invalidateCell">invalidateCell</a>(in long row, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#invalidateRange">invalidateRange</a>(in long startIndex, in long endIndex);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#invalidateColumnRange">invalidateColumnRange</a>(in long startIndex, in long endIndex, in nsITreeColumn col);</code></td>
  </tr>
  <tr>
   <td><code>long <a href="#getRowAt">getRowAt</a>(in long x, in long y);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getCellAt">getCellAt</a>(in long x, in long y, out long row, out <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col, out ACString childElt);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getCoordsForCellItem">getCoordsForCellItem</a>(in long row, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col, in ACString element, out long x, out long y, out long width, out long height);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#isCellCropped">isCellCropped</a>(in long row, in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#rowCountChanged">rowCountChanged</a>(in long index, in long count);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#beginUpdateBatch">beginUpdateBatch</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#endUpdateBatch">endUpdateBatch</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#clearStyleAndImageCaches">clearStyleAndImageCaches</a>();</code></td>
  </tr>
 </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>columns</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumns" title="">nsITreeColumns</a></code></td>
   <td><strong>Readonly:</strong> Obtain the columns.</td>
  </tr>
  <tr>
   <td><code>view</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeView" title="">nsITreeView</a></code></td>
   <td>The view that backs the tree and that supplies it with its data. It is dynamically settable, either using a view attribute on the tree tag or by setting this attribute to a new value.</td>
  </tr>
  <tr>
   <td><code>focused</code></td>
   <td>boolean</td>
   <td>Whether or not we are currently focused.</td>
  </tr>
  <tr>
   <td><code>treeBody</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMElement" title="">nsIDOMElement</a></code></td>
   <td><strong>Readonly:</strong> Obtain the treebody content node.  This is a node that corresponds to the treechildren tag.</td>
  </tr>
  <tr>
   <td><code>rowHeight</code></td>
   <td>long</td>
   <td><strong>Readonly:</strong> Obtain the height of a row.</td>
  </tr>
  <tr>
   <td><code>rowWidth</code></td>
   <td>long</td>
   <td><strong>Readonly:</strong> Obtain the width of a row.</td>
  </tr>
  <tr>
   <td><code>horizontalPosition</code></td>
   <td>long</td>
   <td><strong>Readonly:</strong> Get the pixel position of the horizontal scrollbar.</td>
  </tr>
  <tr>
   <td><code>selectionRegion</code></td>
   <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIScriptableRegion" title="">nsIScriptableRegion</a></code></td>
   <td><strong>Readonly:</strong> Return the region for the visible parts of the selection, in device pixels.</td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="getFirstVisibleRow" name="getFirstVisibleRow">getFirstVisibleRow()</h3>
<p>Get the index of the first visible row.</p>
<pre class="eval"> long getFirstVisibleRow();
</pre>
<h3 id="getLastVisibleRow" name="getLastVisibleRow">getLastVisibleRow()</h3>
<p>Get the index of the last visible row.</p>
<pre class="eval"> long getLastVisibleRow();
</pre>
<h3 id="getPageLength" name="getPageLength">getPageLength()</h3>
<p>Gets the number of possible visible rows.</p>
<pre class="eval"> long getPageLength();
</pre>
<h3 id="ensureRowIsVisible" name="ensureRowIsVisible">ensureRowIsVisible()</h3>
<p>Ensures that a row at a given index is visible.</p>
<pre class="eval"> void ensureRowIsVisible(in long index);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>index</code></dt>
 <dd>
  The index of the row</dd>
</dl>
<h3 id="ensureCellIsVisible" name="ensureCellIsVisible">ensureCellIsVisible()</h3>
<p>Ensures that a given cell in the tree is visible.</p>
<pre class="eval"> void ensureCellIsVisible(in long row, in nsITreeColumn col);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>index</code></dt>
 <dd>
  The index of the row to check</dd>
 <dt>
  <code>col</code></dt>
 <dd>
  The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> to check</dd>
</dl>
<h3 id="scrollToRow" name="scrollToRow">scrollToRow()</h3>
<p>Scrolls such that the row at index is at the top of the visible view.</p>
<pre class="eval"> void scrollToRow(in long index);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>index</code></dt>
 <dd>
  The index of the row</dd>
</dl>
<h3 id="scrollByLines" name="scrollByLines">scrollByLines()</h3>
<p>Scroll the tree up or down by numLines lines.</p>
<pre class="eval"> void scrollByLines(in long numLines);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>numlines</code></dt>
 <dd>
  The number of lines to scroll. Positive values move down in the tree. Prevents scrolling off the end of the tree.</dd>
</dl>
<h3 id="scrollByPages" name="scrollByPages">scrollByPages()</h3>
<p>Scroll the tree up or down by numPages pages. A page is considered to be the amount displayed by the tree. This method prevents scrolling off the end of the tree.</p>
<pre class="eval"> void scrollByPages(in long numPages);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>numPages</code></dt>
 <dd>
  The number of pages to scroll. Positive values move down in the tree.</dd>
</dl>
<h3 id="scrollToCell" name="scrollToCell">scrollToCell()</h3>
<p>Scrolls such that a given cell is visible (if possible) at the top left corner of the visible view.</p>
<pre class="eval"> void scrollToCell(in long row, in nsITreeColumn col);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>row</code></dt>
 <dd>
  The cell's row index</dd>
 <dt>
  <code>col</code></dt>
 <dd>
  The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> of the cell</dd>
</dl>
<h3 id="scrollToColumn" name="scrollToColumn">scrollToColumn()</h3>
<p>Scrolls horizontally so that the specified column is at the left of the view (if possible).</p>
<pre class="eval"> void scrollToColumn(in nsITreeColumn col);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>col</code></dt>
 <dd>
  The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> to scroll to</dd>
</dl>
<h3 id="scrollToHorizontalPosition" name="scrollToHorizontalPosition">scrollToHorizontalPosition()</h3>
<p>Scroll to a specific horizontal pixel position.</p>
<pre class="eval"> void scrollToHorizontalPosition(in long horizontalPosition);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>horizontalPosition</code></dt>
 <dd>
  The number of pixels to scroll</dd>
</dl>
<h3 id="invalidate" name="invalidate">invalidate()</h3>
<h3 id="invalidateColumn" name="invalidateColumn">invalidateColumn()</h3>
<h3 id="invalidateRow" name="invalidateRow">invalidateRow()</h3>
<h3 id="invalidateCell" name="invalidateCell">invalidateCell()</h3>
<h3 id="invalidateRange" name="invalidateRange">invalidateRange()</h3>
<h3 id="invalidateColumnRange" name="invalidateColumnRange">invalidateColumnRange()</h3>
<p>Invalidation methods for fine-grained painting control.</p>
<pre class="eval">  void invalidate();
  void invalidateColumn(in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> col);
  void invalidateRow(in long index);
  void invalidateCell(in long row, in nsITreeColumn col);
  void invalidateRange(in long startIndex, in long endIndex);
  void invalidateColumnRange(in long startIndex, in long endIndex,
                             in nsITreeColumn col);
</pre>
<h3 id="getRowAt" name="getRowAt">getRowAt()</h3>
<p>A hit test that can tell you what row the mouse is over. Returns -1 for invalid mouse coordinates. The coordinate system is the client coordinate system for the document this boxObject lives in, and the units are CSS pixels.</p>
<pre class="eval"> long getRowAt(in long x, in long y);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>x</code></dt>
 <dd>
  The x coordinate</dd>
 <dt>
  <code>y</code></dt>
 <dd>
  The y coordinate</dd>
</dl>
<h3 id="getCellAt" name="getCellAt">getCellAt()</h3>
<p>A hit test that can tell you what cell the mouse is over. Returns -1 for invalid mouse coordinates. The coordinate system is the client coordinate system for the document this boxObject lives in, and the units are CSS pixels.</p>
<pre class="eval"> void getCellAt(in long x, in long y, out long row, out nsITreeColumn col, out ACString childElt);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>x</code></dt>
 <dd>
  The x coordinate</dd>
 <dt>
  <code>y</code></dt>
 <dd>
  The y coordinate</dd>
</dl>
<h6 id="Returns" name="Returns">Returns</h6>
<dl>
 <dt>
  <code>row</code></dt>
 <dd>
  The row index at the coordinates</dd>
 <dt>
  <code>col</code></dt>
 <dd>
  The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code> hit.</dd>
 <dt>
  <code>ChildElt</code></dt>
 <dd>
  The pseudoelement hit: this can have values of "cell", "twisty", "image", and "text".</dd>
</dl>
<h3 id="getCoordsForCellItem" name="getCoordsForCellItem">getCoordsForCellItem()</h3>
<p>Find the coordinates of an element within a specific cell.</p>
<pre class="eval"> void getCoordsForCellItem(in long row, in nsITreeColumn col, in ACString element,
                            out long x, out long y, out long width, out long height);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>row</code></dt>
 <dd>
  The index of the row</dd>
 <dt>
  <code>col</code></dt>
 <dd>
  The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code></dd>
 <dt>
  <code>element</code></dt>
 <dd>
  The pseudoelement. This can have values of "cell", "twisty", "image", and "text".</dd>
</dl>
<h6 id="Returns" name="Returns">Returns</h6>
<dl>
 <dt>
  <code>x</code></dt>
 <dd>
  The x coordinate</dd>
 <dt>
  <code>col</code></dt>
 <dd>
  The y coordinate.</dd>
 <dt>
  <code>width</code></dt>
 <dd>
  The width of the element</dd>
 <dt>
  <code>height</code></dt>
 <dd>
  The height of the element</dd>
</dl>
<h3 id="isCellCropped" name="isCellCropped">isCellCropped()</h3>
<p>Determine if the text of a cell is being cropped or not.</p>
<pre class="eval"> boolean isCellCropped(in long row, in nsITreeColumn col);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>row</code></dt>
 <dd>
  The index of the row</dd>
 <dt>
  <code>col</code></dt>
 <dd>
  The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITreeColumn" title="">nsITreeColumn</a></code></dd>
</dl>
<h3 id="rowCountChanged" name="rowCountChanged">rowCountChanged()</h3>
<p>Notify the tree that the number of rows changed. The view is responsible for calling this notification method when rows are added or removed. For non-contiguous additions/removals, this method should be called multiple times.</p>
<pre class="eval"> void rowCountChanged(in long index, in long count);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>index</code></dt>
 <dd>
  the position at which the new rows were added or at which rows were removed.</dd>
 <dt>
  <code>count</code></dt>
 <dd>
  the number of rows added or removed. Use negative values for removed rows.</dd>
</dl>
<h6 id="Example">Example</h6>
<p>You deleted the row with index <code>rowIndex</code>. Inform the tree about this change by calling</p>
<pre><code>rowCountChanged(rowIndex+1, -1);</code>
</pre>
<h3 id="beginUpdateBatch" name="beginUpdateBatch">beginUpdateBatch()</h3>
<p>Notify the tree that the view is about to perform a batch update, that is, add, remove or invalidate several rows at once. This must be followed by calling endUpdateBatch(), otherwise the tree will get out of sync.</p>
<pre class="eval"> void beginUpdateBatch();
</pre>
<h3 id="endUpdateBatch" name="endUpdateBatch">endUpdateBatch()</h3>
<p>Notify the tree that the view has completed a batch update.</p>
<pre class="eval"> void endUpdateBatch();
</pre>
<h3 id="clearStyleAndImageCaches" name="clearStyleAndImageCaches">clearStyleAndImageCaches()</h3>
<p>Called on a theme switch to flush out the tree's style and image caches.</p>
<pre class="eval"> void clearStyleAndImageCaches();
</pre>
<h2 id="Other_references" name="Other_references">Other references</h2>
<ul>
 <li><a href="/en/Tree_Widget_Changes" title="en/Tree_Widget_Changes">Tree Widget Changes</a> (applies to Gecko 1.8.0 and later)</li>
 <li><a href="/en/XUL_Tutorial/Tree_Box_Objects" title="en/XUL_Tutorial/Tree_Box_Objects">XUL Tutorial:Tree Box </a></li>
 <li><a href="/en/Sorting_and_filtering_a_custom_tree_view" title="en/Sorting_and_filtering_a_custom_tree_view">Sorting and filtering a custom tree view</a></li>
 <li><a href="/en/XUL_Tutorial/Tree_View_Details" title="en/XUL_Tutorial/Tree_View_Details">XUL Tutorial:Tree View Details</a></li>
 <li><a class="internal" href="/en/XPCOM_Interface_Reference/nsITreeView" title="nsITreeView">nsITreeView</a></li>
</ul>