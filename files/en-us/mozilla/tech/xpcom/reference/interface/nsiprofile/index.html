---
title: nsIProfile
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIProfile
tags:
  - Gecko
  - NeedsUpdate
  - Reference
  - XPCOM
  - XPCOM Interface Reference
  - profile
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/profile/public/nsIProfile.idl" rel="custom">profile/public/nsIProfile.idl</a></code><span style="text-align: right; float: right;">Unknown</span></div>
<span style="padding: 4px 2px;">The Profile Manager is responsible for creating, maintaining, and organizing user profiles. This interface was superseded by the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIToolkitProfileService" title>nsIToolkitProfileService</a></code> interface in Gecko 1.8.1.</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>

<div style="height: 8px; top: 16px; left: 0%; background: #00dd00; position: absolute; width: 6%;" title="Introduced in Gecko 0.9 "></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 0%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 0%;">Gecko 0.9</div>

    <div style="height: 8px; top: 16px; left: 6%; background: #ff8000; position: absolute; width: 28.285714285714285%;" title="Deprecated in Gecko 1.8.1 (Firefox 2 / Thunderbird 2 / SeaMonkey 1.1)"></div>

  <div style="top: 0px; font-size: 11px; position: absolute; left: 6%;">Deprecated</div>
  <div style="top: 22px; font-size: 11px; position: absolute; left: 6%;">Gecko 1.8.1</div>

    <div style="height: 8px; top: 16px; left: 34.285714285714285%; background: #000000; position: absolute; width: 65.71428571428572%;" title="Obsolete in Gecko 20.0 (Firefox 20.0 / Thunderbird 20.0 / SeaMonkey 2.17)"></div>

  <div style="top: 0px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 34.285714285714285%;">Obsolete</div>

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 34.285714285714285%;">Gecko 20.0</div>

    <div style="height: 8px; top: 16px; left: 1.9490285714285713%; background: #eeee00; position: absolute; width: 1%; border-radius: 4px; -webkit-border-radius: 4px;" title="Last changed in Gecko 1.6 "></div>

</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title>nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.6 </span></div>
</div><p></p>
<p>Implemented by: <code>@mozilla.org/profile/manager;1</code>. To get access to the Profile Manager service:</p>
<pre class="eval">var profile = Components.classes[&quot;@mozilla.org/profile/manager;1&quot;]
              .getService(Components.interfaces.nsIProfile);
</pre>
<div class="note">
 <strong>Note:</strong> This interface was used by SeaMonkey up through SeaMonkey 1.1 versions, which were based off Gecko 1.8.1. However, it hasn&apos;t been used in Firefox since before Firefox 1.0.</div>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#cloneProfile()">cloneProfile</a>(in wstring profileName);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#createNewProfile()">createNewProfile</a>(in wstring profileName, in wstring nativeProfileDir, in wstring langcode, in boolean useExistingDir);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#deleteProfile()">deleteProfile</a>(in wstring name, in boolean canDeleteFiles);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getProfileList()">getProfileList</a>(out unsigned long length, [retval, array, size_is(length)] out wstring profileNames);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#profileExists()">profileExists</a>(in wstring profileName);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#renameProfile()">renameProfile</a>(in wstring oldName, in wstring newName);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#shutDownCurrentProfile()">shutDownCurrentProfile</a>(in unsigned long shutDownType);</code></td>
  </tr>
 </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>currentProfile</code></td>
   <td><code><a href="/en/wstring">wstring</a></code></td>
   <td>The name of the profile currently in use.</td>
  </tr>
  <tr>
   <td><code>profileCount</code></td>
   <td><code><a href="/en/long">long</a></code></td>
   <td>The number of profiles. <strong>Read only.</strong></td>
  </tr>
 </tbody>
</table>
<h2 id="Constants" name="Constants">Constants</h2>
<h3 id="Profile_shutdown_types">Profile shutdown types</h3>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Constant</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>SHUTDOWN_PERSIST</code></td>
   <td><code>0x00000001</code></td>
   <td>When shutting down the profile, save all changes.</td>
  </tr>
  <tr>
   <td><code>SHUTDOWN_CLEANSE</code></td>
   <td><code>0x00000002</code></td>
   <td>When shutting down the profile, discard changes. <span class="unimplemented unimplementedInline notecard inline">Unimplemented</span></td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="cloneProfile()" name="cloneProfile()">cloneProfile()</h3>
<p>Clones the current profile, creating a copy of it with a new name.</p>
<pre class="eval">void cloneProfile(
  in wstring profileName
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>profileName</code></dt>
 <dd>
  The name to assign to the new clone of the current profile.</dd>
</dl>
<h3 id="createNewProfile()" name="createNewProfile()">createNewProfile()</h3>
<p>Creates a new profile. Appropriate default values will be copied into the preferences in the new profile.</p>
<pre class="eval">void createNewProfile(
  in wstring profileName,
  in wstring nativeProfileDir,
  in wstring langcode,
  in boolean useExistingDir
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>profileName</code></dt>
 <dd>
  The name to assign to the new profile.</dd>
 <dt>
  <code>nativeProfileDir</code></dt>
 <dd>
  The pathname of the directory to use as the profile directory; if you specify <code>null</code>, a new folder will be created in the default profiles directory.</dd>
 <dt>
  <code>langcode</code></dt>
 <dd>
  The locale to use for the new profile.</dd>
 <dt>
  <code>useExistingDir</code></dt>
 <dd>
  If <code>true</code>, an existing directory may be used; otherwise, the profile directory will be unique.</dd>
</dl>
<h3 id="deleteProfile()" name="deleteProfile()">deleteProfile()</h3>
<p>Deletes the specified profile.</p>
<pre class="eval">void deleteProfile(
  in wstring name,
  in boolean canDeleteFiles
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>name</code></dt>
 <dd>
  The name of the profile to delete.</dd>
 <dt>
  <code>canDeleteFiles</code></dt>
 <dd>
  If <code>true</code>, the Profile Manager will try to delete all of the profile&apos;s files and its directory.</dd>
</dl>
<h3 id="getProfileList()" name="getProfileList()">getProfileList()</h3>
<p>Returns an array of strings indicating the names of all the available profiles.</p>
<pre class="eval">void getProfileList(
  out unsigned long length,
  [retval, array, size_is(length)] out wstring profileNames
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>length</code></dt>
 <dd>
  On return, contains the number of profiles in the <code>profileNames</code> array.</dd>
 <dt>
  <code>profileNames</code></dt>
 <dd>
  On return, contains an array of all of the available profiles&apos; names.</dd>
</dl>
<h3 id="profileExists()" name="profileExists()">profileExists()</h3>
<p>Determine whether or not a profile with the specified name exists.</p>
<pre class="eval">boolean profileExists(
  in wstring profileName
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>profileName</code></dt>
 <dd>
  The name of the profile to look for.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p><code>true</code> if there is a profile with the specified name.</p>
<h3 id="renameProfile()" name="renameProfile()">renameProfile()</h3>
<p>Renames an existing profile.</p>
<pre class="eval">void renameProfile(
  in wstring oldName,
  in wstring newName
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>oldName</code></dt>
 <dd>
  The name of the profile to rename.</dd>
 <dt>
  <code>newName</code></dt>
 <dd>
  The new name to assign to the profile.</dd>
</dl>
<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>
<dl>
 <dt>
  <code>NS_ERROR_FAILURE</code></dt>
 <dd>
  A profile already exists with the name <code>newName</code>.</dd>
</dl>
<h3 id="shutDownCurrentProfile()" name="shutDownCurrentProfile()">shutDownCurrentProfile()</h3>
<p>Shuts down the current profile; this essentially &quot;logs out&quot; the current profile.</p>
<pre class="eval">void shutDownCurrentProfile(
  in unsigned long shutDownType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>shutDownType</code></dt>
 <dd>
  The type of shutdown to perform; see <a href="#Shutdown_type_constants">Shutdown type constants</a>.</dd>
</dl>
<h2 id="See_also" name="See_also">See also</h2>
<ul>
 <li>Â <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIToolkitProfileService">nsIToolkitProfileService</a></code></li>
</ul>
