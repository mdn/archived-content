<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/intl/strres/public/nsIStringBundle.idl" rel="custom">intl/strres/public/nsIStringBundle.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

Provides the string bundle service, which provides a way to fetch localized strings from a property file.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.7 </span></div>
</div><p></p>

<p>Implemented by: <code>@mozilla.org/intl/stringbundle;1</code>. To access this service, use:</p>

<pre class="eval">var stringBundleService = Components.classes["@mozilla.org/intl/stringbundle;1"]
                                    .getService(Components.interfaces.nsIStringBundleService);
</pre>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStringBundle" title="">nsIStringBundle</a></code> <a href="#createBundle()">createBundle</a>(in string aURLSpec);</code></td>
  </tr>
  <tr>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIStringBundle" title="">nsIStringBundle</a></code> <a href="#createExtensibleBundle()">createExtensibleBundle</a>(in string aRegistryKey);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#flushBundles()">flushBundles</a>();</code></td>
  </tr>
  <tr>
   <td><code>wstring <a href="#formatStatusMessage()">formatStatusMessage</a>(in nsresult aStatus, in wstring aStatusArg);</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="createBundle()" name="createBundle()">createBundle()</h3>

<pre class="eval">nsIStringBundle createBundle(
  in string aURLSpec
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aURLSpec</code></dt>
 <dd>The URL of the properties file to load. This is typically a locale URL, e.g. <code><a class="external" rel="freelink">chrome://global/locale/global.properties</a></code></dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>A string bundle corresponding to the properties file. This string bundle has functions available on it.</p>

<div class="note">
<p>On the return value object on you can call functions like <code>GetStringFromName</code> and <code>formatStringFromName</code> see <code><a href="/en-US/docs/XPCOM_Interface_Reference/nsIStringBundle">nsIStringBundle</a></code>.</p>
</div>

<h6 id="Return_value" name="Return_value">Â </h6>

<h3 id="createExtensibleBundle()" name="createExtensibleBundle()">createExtensibleBundle()</h3>

<pre class="eval">nsIStringBundle createExtensibleBundle(
  in string aRegistryKey
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aRegistryKey</code></dt>
 <dd>The name of the category under which the properties file(s) have been registered.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>An extensible bundle corresponding to the properties file(s).</p>

<h3 id="flushBundles()" name="flushBundles()">flushBundles()</h3>

<p>Flushes the string bundle cache - useful when the locale changes or when we need to get some extra memory back. (Automatically called for the <code>memory-pressure</code> and <code>chrome-flush-caches</code> global observer topics.)</p>

<pre class="eval">void flushBundles();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="formatStatusMessage()" name="formatStatusMessage()">formatStatusMessage()</h3>

<p>Formats a message string from a status code and status arguments. Typically used to format a message received by a <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIProgressEventSink" title="">nsIProgressEventSink</a></code>'s <code>onStatus</code> method.</p>

<pre class="eval">wstring formatStatusMessage(
  in nsresult aStatus,
  in wstring aStatusArg
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aStatus</code></dt>
 <dd>The status code. This is mapped into a string ID and and used in the string lookup process (see <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIErrorService" title="">nsIErrorService</a></code>).</dd>
 <dt><code>aStatusArg</code></dt>
 <dd>The status message argument(s). Multiple arguments can be separated by newline ('\n') characters.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>The formatted message.</p>

<h2 id="See_also" name="See_also">See also</h2>

<ul>
 <li><a class="internal" href="/en/Code_snippets/Miscellaneous#Using_string_bundles_from_JavaScript" title="https://developer.mozilla.org/en/Code_snippets/Miscellaneous#Using_string_bundles_from_JavaScript">Code snippets : Miscellaneous : Using string bundles from JavaScript</a></li>
 <li>How to localize html pages, xul files, and js/jsm files from bootstrapped add-ons. The localizing js/jsm files uses the <code>nsIStringBundleService</code>: <a href="/en-US/Add-ons/Bootstrapped_extensions#Localization_%28L10n%29">Bootstrapped Extensions :: Localization (L10n)</a></li>
 <li><a href="/en-US/docs/XPCOM_Interface_Reference/nsIStringBundle">nsIStringBundle</a></li>
</ul>