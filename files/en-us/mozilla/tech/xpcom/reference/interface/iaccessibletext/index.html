---
title: IAccessibleText
slug: Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText
tags:
  - Interfaces
  - NeedsContent
  - XPCOM
  - XPCOM Interface Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/other-licenses/ia2/AccessibleText.idl" rel="custom">other-licenses/ia2/AccessibleText.idl</a></code><span style="text-align: right; float: right;"><span style="color: #cc0000; font-weight: 700;">Not scriptable</span></span></div>
<span style="padding: 4px 2px;">

A structure containing a substring and the start and end offsets in the enclosing string.
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>

  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 8.571428571428571%;"></div>

<div style="height: 8px; top: 16px; left: 8.571428571428571%; background: #00dd00; position: absolute; width: 91.42857142857143%;" title="Introduced in Gecko 1.9 (Firefox 3)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 8.571428571428571%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 8.571428571428571%;">Gecko 1.9</div>

</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IUnknown" title="">IUnknown</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.9 (Firefox 3)</span></div>
</div><p></p>
<p>This enum defines values which specify a <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> boundary type. IA2_TEXT_BOUNDARY_SENTENCE is optional. When a method doesn't implement this method it must return S_FALSE. Typically this feature would not be implemented by an application. However, if the application developer was not satisfied with how screen readers have handled the reading of sentences this boundary type could be implemented and screen readers could use the application's version of a sentence rather than the screen reader's. The rest of the boundary types must be supported. This enum is used in <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#textBeforeOffset()">textBeforeOffset()</a></code>, <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#textAtOffset()">textAtOffset()</a></code>, and <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#textAfterOffset()">textAfterOffset()</a></code>.</p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>HRESULT <a href="#addSelection()">addSelection</a>([in] long startOffset, [in] long endOffset );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#attributes()">attributes</a>([in] long offset, [out] long startOffset, [out] long endOffset, [out] BSTR textAttributes );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#caretOffset()">caretOffset</a>([out] long offset );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#characterExtents()">characterExtents</a>([in] long offset, [in] enum IA2CoordinateType coordType, [out] long x, [out] long y, [out] long width, [out] long height );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#nCharacters()">nCharacters</a>([out] long nCharacters );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#newText()">newText</a>([out] IA2TextSegment newText );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#nSelections()">nSelections</a>([out] long nSelections );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#offsetAtPoint()">offsetAtPoint</a>([in] long x, [in] long y, [in] enum IA2CoordinateType coordType, [out] long offset );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#oldText()">oldText</a>([out] IA2TextSegment oldText );</code></td> </tr> <tr> <td><code>HRESULT <a href="#removeSelection()">removeSelection</a>([in] long selectionIndex );</code></td> </tr> <tr> <td><code>HRESULT <a href="#scrollSubstringTo()">scrollSubstringTo</a>([in] long startIndex, [in] long endIndex, [in] enum IA2ScrollType scrollType );</code></td> </tr> <tr> <td><code>HRESULT <a href="#scrollSubstringToPoint()">scrollSubstringToPoint</a>([in] long startIndex, [in] long endIndex, [in] enum IA2CoordinateType coordinateType, [in] long x, [in] long y );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#selection()">selection</a>([in] long selectionIndex, [out] long startOffset, [out] long endOffset );</code></td> </tr> <tr> <td><code>HRESULT <a href="#setCaretOffset()">setCaretOffset</a>([in] long offset );</code></td> </tr> <tr> <td><code>HRESULT <a href="#setSelection()">setSelection</a>([in] long selectionIndex, [in] long startOffset, [in] long endOffset );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#text()">text</a>([in] long startOffset, [in] long endOffset, [out] BSTR text );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#textAfterOffset()">textAfterOffset</a>([in] long offset, [in] enum IA2TextBoundaryType boundaryType, [out] long startOffset, [out] long endOffset, [out] BSTR text );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#textAtOffset()">textAtOffset</a>([in] long offset, [in] enum IA2TextBoundaryType boundaryType, [out] long startOffset, [out] long endOffset, [out] BSTR text );</code></td> </tr> <tr> <td><code>[propget] HRESULT <a href="#textBeforeOffset()">textBeforeOffset</a>([in] long offset, [in] enum IA2TextBoundaryType boundaryType, [out] long startOffset, [out] long endOffset, [out] BSTR text );</code></td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="addSelection()" name="addSelection()">addSelection()</h3>
<p>Adds a <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code>.</p>
<pre class="eval">HRESULT addSelection(
  [in] long startOffset,
  [in] long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startOffset</code></dt> <dd>Starting offset ( 0 based).</dd> <dt><code>endOffset</code></dt> <dd>Offset of first character after new <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code> (0 based).</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed. S_OK.</p>
<h3 id="attributes()" name="attributes()">attributes()</h3>
<p>Returns <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> <code>attributes</code>.</p>
<pre class="eval">[propget] HRESULT attributes(
  [in] long offset,
  [out] long startOffset,
  [out] long endOffset,
  [out] BSTR textAttributes
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd><code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#Text()">Text()</a></code> offset (0 based)</dd> <dt><code>startOffset</code></dt> <dd>The starting offset of the character range over which all <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> <code>attributes</code> match those of offset. (0 based)</dd> <dt><code>endOffset</code></dt> <dd>The offset of the first character past the character range over which all <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> <code>attributes</code> match those of offset. (0 based)</dd> <dt><code>textAttributes</code></dt> <dd>A string of <code>attributes</code> describing the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code>. The <code>attributes</code> are described in the; <a class=" external" href="http://www.linuxfoundation.org/en/Accessibility/IAccessible2/TextAttributes">text attributes specification</a> on the IAccessible2 web site.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] values are 0s and <code>null</code> respectively. S_FALSE if there is nothing to return, [out] values are 0s and <code>null</code> respectively. S_OK.</p>
<h3 id="caretOffset()" name="caretOffset()">caretOffset()</h3>
<p>Returns the position of the caret. Returns the 0-based offset of the caret within the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code>. If the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> is implemented as a tree of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> objects with embed characters in higher levels representing substrings of child <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> objects and the caret is in one of the child <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> objects, then the offset in the higher level <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> object would be at the embed character representing child <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> object that contains the caret. For example, if the string "one two three" is implemented as a two <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> objects, with a top level <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> object containing an embed character "one ? three" and a child <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> object containing "two" and if the caret is in the descendant object just before the 'o' in "two", then:</p>
<ul> <li>the <code>caretOffset</code> for the "one ? three" object would be 4, matching the embed character&lt;/li&gt;</li> <li>the <code>caretOffset</code> for "two" would be 2, matching the "o"</li>
</ul>
<p>The caret position/offset is that of the character logically following it, for example to the right of it in a left to right language.</p>
<pre class="eval">[propget] HRESULT caretOffset(
  [out] long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>The returned offset is relative to the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> represented by this object.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>S_FALSE if the caret is not currently active on this object, that is the caret is located on some other object. The returned offset value will be -1. S_OK.</p>
<h3 id="characterExtents()" name="characterExtents()">characterExtents()</h3>
<p>Returns the bounding box of the specified position. The virtual character after the last character of the represented <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code>, that is the one at position length is a special case. It represents the current input position and will therefore typically be queried by AT more often than other positions. Because it does not represent an existing character its bounding box is defined in relation to preceding characters. It should be roughly equivalent to the bounding box of some character when inserted at the end of the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code>. Its height typically being the maximal height of all the characters in the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> or the height of the preceding character, its width being at least one pixel so that the bounding box is not degenerate.</p>
<pre class="eval">[propget] HRESULT characterExtents(
  [in] long offset,
  [in] enum IA2CoordinateType coordType,
  [out] long x,
  [out] long y,
  [out] long width,
  [out] long height
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>Index of the character for which to return its bounding box. The valid range is 0..length.</dd> <dt><code>coordType</code></dt> <dd>Specifies if the coordinates are relative to the screen or to the parent window.</dd> <dt><code>x</code></dt> <dd>X coordinate of the top left corner of the bounding box of the referenced character.</dd> <dt><code>y</code></dt> <dd>Y coordinate of the top left corner of the bounding box of the referenced character.</dd> <dt><code>width</code></dt> <dd>Width of the bounding box of the referenced character.</dd> <dt><code>height</code></dt> <dd>Height of the bounding box of the referenced character.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] values are 0s. S_OK.</p>
<h3 id="nCharacters()" name="nCharacters()">nCharacters()</h3>
<p>Returns total number of characters.</p>
<pre class="eval">[propget] HRESULT nCharacters(
  [out] long nCharacters
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>nCharacters</code></dt> <dd>Missing Description</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>S_OK.</p>
<h3 id="newText()" name="newText()">newText()</h3>
<p>Returns any inserted <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code>. Provided for use by the ::IA2_EVENT_TEXT_INSERTED and ::IA2_EVENT_TEXT_UPDATED event handlers. This data is only guaranteed to be valid while the thread notifying the event continues. Once the handler has returned, the validity of the data depends on how the server manages the life cycle of its objects. Also, note that the server may have different life cycle management strategies for controls depending on whether or not a control manages its children. Lists, trees, and tables can have a large number of children and thus it's possible that the child objects for those controls would only be created as needed. Servers should document their life cycle strategy as this will be of interest to assistive technology or script engines accessing data out of process or from other threads. Servers only need to save the last inserted block of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> and a scope of the entire application is adequate.</p>
<pre class="eval">[propget] HRESULT newText(
  [out] IA2TextSegment newText
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>newText</code></dt> <dd>The <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> that was just inserted.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>S_FALSE if there is nothing to return, [out] value is <code>null</code>. S_OK.</p>
<h3 id="nSelections()" name="nSelections()">nSelections()</h3>
<p>Returns the number of active non-contiguous selections.</p>
<pre class="eval">[propget] HRESULT nSelections(
  [out] long nSelections
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>nSelections</code></dt> <dd>Missing Description</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>S_OK.</p>
<h3 id="offsetAtPoint()" name="offsetAtPoint()">offsetAtPoint()</h3>
<p>Returns the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> position for the specified screen position. Given a point return the zero-based index of the character under that point. The same functionality could be achieved by using the bounding boxes for each character as returned by <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#characterExtents()">characterExtents()</a></code>. The method <code>offsetAtPoint</code>, however, can be implemented more efficiently.</p>
<pre class="eval">[propget] HRESULT offsetAtPoint(
  [in] long x,
  [in] long y,
  [in] enum IA2CoordinateType coordType,
  [out] long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>x</code></dt> <dd>The position's x value for which to look up the index of the character that is rendered on to the display at that point.</dd> <dt><code>y</code></dt> <dd>The position's y value for which to look up the index of the character that is rendered on to the display at that point.</dd> <dt><code>coordType</code></dt> <dd>Screen coordinates or window coordinates.</dd> <dt><code>offset</code></dt> <dd>Index of the character under the given point or -1 if the point is invalid or there is no character under the point.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] value is 0. S_OK.</p>
<h3 id="oldText()" name="oldText()">oldText()</h3>
<p>Returns any removed <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code>. Provided for use by the IA2_EVENT_TEXT_REMOVED/UPDATED event handlers. This data is only guaranteed to be valid while the thread notifying the event continues. Once the handler has returned, the validity of the data depends on how the server manages the life cycle of its objects. Also, note that the server may have different life cycle management strategies for controls depending on whether or not a control manages its children. Lists, trees, and tables can have a large number of children and thus it's possible that the child objects for those controls would only be created as needed. Servers should document their life cycle strategy as this will be of interest to assistive technology or script engines accessing data out of process or from other threads. Servers only need to save the last removed block of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> and a scope of the entire application is adequate.</p>
<pre class="eval">[propget] HRESULT oldText(
  [out] IA2TextSegment oldText
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>oldText</code></dt> <dd>The <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> that was just removed.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>S_FALSE if there is nothing to return, [out] value is <code>null</code>. S_OK.</p>
<h3 id="removeSelection()" name="removeSelection()">removeSelection()</h3>
<p>Unselects a range of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code>.</p>
<pre class="eval">HRESULT removeSelection(
  [in] long selectionIndex
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>selectionIndex</code></dt> <dd>Index of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code> to remove (0 based).</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed. S_OK.</p>
<h3 id="scrollSubstringTo()" name="scrollSubstringTo()">scrollSubstringTo()</h3>
<p>Makes a specific part of string visible on screen.</p>
<pre class="eval">HRESULT scrollSubstringTo(
  [in] long startIndex,
  [in] long endIndex,
  [in] enum IA2ScrollType scrollType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startIndex</code></dt> <dd>0 based character offset.</dd> <dt><code>endIndex</code></dt> <dd>0 based character offset - the offset of the character just past the last character of the string.</dd> <dt><code>scrollType</code></dt> <dd>Defines where the object should be placed on the screen.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed. S_OK.</p>
<h3 id="scrollSubstringToPoint()" name="scrollSubstringToPoint()">scrollSubstringToPoint()</h3>
<p>Moves the top left of a substring to a specified location.</p>
<pre class="eval">HRESULT scrollSubstringToPoint(
  [in] long startIndex,
  [in] long endIndex,
  [in] enum IA2CoordinateType coordinateType,
  [in] long x,
  [in] long y
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startIndex</code></dt> <dd>0 based character offset.</dd> <dt><code>endIndex</code></dt> <dd>0 based character offset - the offset of the character just past the last character of the string.</dd> <dt><code>coordinateType</code></dt> <dd>Specifies whether the coordinates are relative to the screen or the parent object.</dd> <dt><code>x</code></dt> <dd>Defines the x coordinate.</dd> <dt><code>y</code></dt> <dd>Defines the y coordinate.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed. S_FALSE if the object is already at the specified location. S_OK.</p>
<h3 id="selection()" name="selection()">selection()</h3>
<p>Returns the character offsets of Nth active <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> <code>selection</code>.</p>
<pre class="eval">[propget] HRESULT selection(
  [in] long selectionIndex,
  [out] long startOffset,
  [out] long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>selectionIndex</code></dt> <dd>Index of <code>selection</code> (0 based).</dd> <dt><code>startOffset</code></dt> <dd>0 based offset of first selected character.</dd> <dt><code>endOffset</code></dt> <dd>0 based offset of one past the last selected character.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] values are 0s. S_FALSE if there is nothing to return, [out] values are 0s. S_OK.</p>
<h3 id="setCaretOffset()" name="setCaretOffset()">setCaretOffset()</h3>
<p>Sets the position of the caret. The caret position/offset is that of the character logically following it, for example to the right of it in a left to right language. Setting the caret position may or may not alter the current <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code>. A change of the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code> is notified to the accessibility event listeners with an ::IA2_EVENT_TEXT_SELECTION_CHANGED event. When the new caret position differs from the old one (which, of course, is the standard case) this is notified to the accessibility event listeners with an ::IA2_EVENT_TEXT_CARET_MOVED event.</p>
<pre class="eval">HRESULT setCaretOffset(
  [in] long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>The new index of the caret. This caret is actually placed to the left side of the character with that index. An index of 0 places the caret so that the next insertion goes before the first character. An index of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#nCharacters()">nCharacters()</a></code> leads to insertion after the last character.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed. E_FAIL if the caret cannot be set. S_OK.</p>
<h3 id="setSelection()" name="setSelection()">setSelection()</h3>
<p>Changes the bounds of an existing <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code>.</p>
<pre class="eval">HRESULT setSelection(
  [in] long selectionIndex,
  [in] long startOffset,
  [in] long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>selectionIndex</code></dt> <dd>Index of <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code> to change (0 based)</dd> <dt><code>startOffset</code></dt> <dd>New starting offset (0 based)</dd> <dt><code>endOffset</code></dt> <dd>New ending offset (0 based) - the offset of the character just past the last character of the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#selection()">selection()</a></code>.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed. S_OK.</p>
<h3 id="text()" name="text()">text()</h3>
<p>Returns the substring between the two given indices. The substring starts with the character at startOffset (inclusive) and up to the character at endOffset (exclusive), if startOffset is less or equal endOffste. If endOffset is lower than startOffset, the result is the same as a call with the two arguments being exchanged. The whole <code>text</code> can be requested by passing the indices zero and <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#nCharacters()">nCharacters()</a></code>. If both indices have the same value, an empty string is returned.</p>
<pre class="eval">[propget] HRESULT text(
  [in] long startOffset,
  [in] long endOffset,
  [out] BSTR text
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startOffset</code></dt> <dd>Index of the first character to include in the returned string. The valid range is 0..length.</dd> <dt><code>endOffset</code></dt> <dd>Index of the last character to exclude in the returned string. The valid range is 0..length.</dd> <dt><code>text</code></dt> <dd>Returns the substring starting with the character at startOffset (inclusive) and up to the character at endOffset (exclusive), if startOffset is less than or equal to endOffset.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] value is <code>null</code>. S_OK.</p>
<h3 id="textAfterOffset()" name="textAfterOffset()">textAfterOffset()</h3>
<p>Returns a <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion after the given position. Returns the substring of the specified <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type that is located after the given character and does not include it. The result of this method should be same as a result for <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#textAtOffset()">textAtOffset()</a></code> with a suitably increased index value. For example, if <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type is ::IA2_TEXT_BOUNDARY_WORD, then the complete word that is closest to and located after offset is returned. If the index is valid, but no suitable word (or other <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type) is found, a <code>null</code> pointer is returned.</p>
<pre class="eval">[propget] HRESULT textAfterOffset(
  [in] long offset,
  [in] enum IA2TextBoundaryType boundaryType,
  [out] long startOffset,
  [out] long endOffset,
  [out] BSTR text
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>Index of the character for which to return the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> part before it. The index character will not be part of the returned string. The valid range is 0..length.</dd> <dt><code>boundaryType</code></dt> <dd>The type of the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion to return. See ::IA2TextBoundaryType for the complete list.</dd> <dt><code>startOffset</code></dt> <dd>0 based offset of first character.</dd> <dt><code>endOffset</code></dt> <dd>0 based offset of one past the last character.</dd> <dt><code>text</code></dt> <dd>Returns the requested <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion. This portion may be empty or invalid when no appropriate <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion is found or <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type is invalid.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] values are 0s and <code>null</code> respectively. S_FALSE if the requested boundary type is not implemented, such as ::IA2_TEXT_BOUNDARY_SENTENCE, or if there is nothing to return; [out] values are 0s and <code>null</code> respectively. S_OK.</p>
<h3 id="textAtOffset()" name="textAtOffset()">textAtOffset()</h3>
<p>Returns a <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion that spans the given position. Returns the substring of the specified <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type at the specified offset. If the index is valid, but no suitable word (or other <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type) is found, a <code>null</code> pointer is returned.</p>
<pre class="eval">[propget] HRESULT textAtOffset(
  [in] long offset,
  [in] enum IA2TextBoundaryType boundaryType,
  [out] long startOffset,
  [out] long endOffset,
  [out] BSTR text
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>Index of the character for which to return the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> part before it. The index character will not be part of the returned string. The valid range is 0..length.</dd> <dt><code>boundaryType</code></dt> <dd>The type of the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion to return. See ::IA2TextBoundaryType for the complete list.</dd> <dt><code>startOffset</code></dt> <dd>0 based offset of first character.</dd> <dt><code>endOffset</code></dt> <dd>0 based offset of one past the last character.</dd> <dt><code>text</code></dt> <dd>Returns the requested <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion. This portion may be empty or invalid when no appropriate <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion is found or <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type is invalid.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] values are 0s and <code>null</code> respectively. S_FALSE if the requested boundary type is not implemented, such as ::IA2_TEXT_BOUNDARY_SENTENCE, or if there is nothing to return; [out] values are 0s and <code>null</code> respectively. S_OK.</p>
<h3 id="textBeforeOffset()" name="textBeforeOffset()">textBeforeOffset()</h3>
<p>Returns a <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion before the given position. Returns the substring of the specified <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type that is located before the given character and does not include it. The result of this method should be same as a result for <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#textAtOffset()">textAtOffset()</a></code> with a suitably decreased index value. For example, if <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type is ::IA2_TEXT_BOUNDARY_WORD, then the complete word that is closest to and located before offset is returned. If the index is valid, but no suitable word (or other boundary type) is found, a <code>null</code> pointer is returned.</p>
<pre class="eval">[propget] HRESULT textBeforeOffset(
  [in] long offset,
  [in] enum IA2TextBoundaryType boundaryType,
  [out] long startOffset,
  [out] long endOffset,
  [out] BSTR text
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>Index of the character for which to return the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> part before it. The index character will not be part of the returned string. The valid range is 0..length.</dd> <dt><code>boundaryType</code></dt> <dd>The type of the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion to return. See ::IA2TextBoundaryType for the complete list.</dd> <dt><code>startOffset</code></dt> <dd>0 based offset of first character.</dd> <dt><code>endOffset</code></dt> <dd>0 based offset of one past the last character.</dd> <dt><code>text</code></dt> <dd>Returns the requested <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion. This portion may be empty or invalid when no appropriate <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> portion is found or <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/IAccessibleText#text()">text()</a></code> type is invalid.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>E_INVALIDARG if bad [in] passed, [out] values are 0s and <code>null</code> respectively. S_FALSE if the requested boundary type is not implemented, such as ::IA2_TEXT_BOUNDARY_SENTENCE, or if there is nothing to return; [out] values are 0s and <code>null</code> respectively. S_OK.</p>
