<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/mailnews/base/public/nsIMsgWindow.idl" rel="custom">mailnews/base/public/nsIMsgWindow.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

<i>Please add a summary to this article.</i>
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 8 (Firefox 8 / Thunderbird 8 / SeaMonkey 2.5)</span></div>
</div><p></p>
<p>Implemented by: <code>@mozilla.org/messenger/msgwindow;1</code>. To create an instance, use:</p>
<pre class="eval"> msgWindow = Components.classes["@mozilla.org/messenger/msgwindow;1"]
                       .createInstance(Components.interfaces.nsIMsgWindow);
</pre>
<p>In <a href="/en/Thunderbird" title="en/Thunderbird">Thunderbird</a> the default message window is stored in the global variable <code>msgWindow</code>.</p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
  <tbody>
    <tr>
      <td><code>void <a href="#displayHTMLInMessagePane.28.29">displayHTMLInMessagePane</a>(in AString title, in AString body, in boolean clearMsgHdr);</code></td>
    </tr>
    <tr>
      <td><code>void <a href="#StopUrls.28.29">StopUrls</a>();</code></td>
    </tr>
    <tr>
      <td><code>void <a href="#closeWindow.28.29">closeWindow</a>();</code></td>
    </tr>
  </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table">
  <tbody>
    <tr>
      <td class="header">Attribute</td>
      <td class="header">Type</td>
      <td class="header">Description</td>
    </tr>
    <tr>
      <td><code>windowCommands</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindowCommands" title="">nsIMsgWindowCommands</a></code></code></td>
      <td>This allows the backend code to send commands to the UI, such as clearMsgPane.</td>
    </tr>
    <tr>
      <td><code>statusFeedback</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgStatusFeedback" title="">nsIMsgStatusFeedback</a></code></code></td>
      <td>This allows the backend code to send status feedback to the UI.</td>
    </tr>
    <tr>
      <td><code>msgHeaderSink</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgHeaderSink" title="">nsIMsgHeaderSink</a></code></code></td>
      <td>This allows the backend code to send message header information to the UI.</td>
    </tr>
    <tr>
      <td><code>transactionManager</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsITransactionManager" title="">nsITransactionManager</a></code></code></td>
      <td>This is used to track undo/redo transactions.</td>
    </tr>
    <tr>
      <td><code>openFolder</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder" title="">nsIMsgFolder</a></code></code></td>
      <td>This is used to track the folder currently open in the UI.</td>
    </tr>
    <tr>
      <td><code>rootDocShell</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDocShell" title="">nsIDocShell</a></code></code></td>
      <td>This is used to track the chrome window's nsIDocShell object. You don't normally need to set this, instead set the domWindow property instead.</td>
    </tr>
    <tr>
      <td><code>messageWindowDocShell</code></td>
      <td><code>nsIDocShell</code></td>
      <td><strong>Readonly:</strong> This retrieves the nsIDocShell object for the message pane. You should not store this in a global variable.</td>
    </tr>
    <tr>
      <td><code>notificationCallbacks</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIInterfaceRequestor" title="">nsIInterfaceRequestor</a></code></code></td>
      <td>These are currently used to set notification callbacks on protocol channels to handle things like bad cert exceptions.</td>
    </tr>
    <tr>
      <td><code>promptDialog</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPrompt" title="">nsIPrompt</a></code></code></td>
      <td><strong>Readonly:</strong> This is the equivalent of calling GetInterface on the rootDocShell object.</td>
    </tr>
    <tr>
      <td><code>mailCharacterSet</code></td>
      <td><code>ACString</code></td>
      <td>This is used to track the character set of the currently displayed message. If set to an alias, the actual character set is returned.</td>
    </tr>
    <tr>
      <td><code>charsetOverride</code></td>
      <td><code>boolean</code></td>
      <td>Remember the message's charset was overridden, so it can be inherited (e.g for quoting).</td>
    </tr>
    <tr>
      <td><code>stopped</code></td>
      <td><code>boolean</code></td>
      <td>Check if a running url been stopped. If you are checking this flag, you need to clear it before you start your operation since there's no convenient place to clear it.</td>
    </tr>
    <tr>
      <td><code>domWindow</code></td>
      <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMWindow" title="">nsIDOMWindow</a></code></code></td>
      <td>The message window's global chrome window object. Set this to initialize the rootDocShell.</td>
    </tr>
  </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="displayHTMLInMessagePane.28.29" name="displayHTMLInMessagePane.28.29">displayHTMLInMessagePane()</h3>
<p>Loads the specified HTML in the message pane. This is equivalent to calling LoadURI on the nsIWebNavigation object with a data: URL specifying the HTML.</p>
<pre class="eval">void displayHTMLInMessagePane(in AString title,
                              in AString body,
                              in boolean clearMsgHdr);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
  <dt>
    <code>title</code></dt>
  <dd>
    Not used.</dd>
  <dt>
    <code>body</code></dt>
  <dd>
    The HTML to display in the message pane. Note that the HTML is wrapped in <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags for you.</dd>
  <dt>
    <code>clearMsgHdr</code></dt>
  <dd>
    Whether or not the existing message pane and header should be cleared before the HTML is displayed.</dd>
</dl>
<h3 id="StopUrls.28.29" name="StopUrls.28.29">StopUrls()</h3>
<p>This is equivalent to calling Stop(nsIWebNavigation::STOP_NETWORK) on the nsIWebNavigation object.</p>
<pre class="eval"> void StopUrls();
</pre>
<h3 id="closeWindow.28.29" name="closeWindow.28.29">closeWindow()</h3>
<p>When the msg window is being unloaded from the content window, this notification can be used to force a flush on anything the message window hangs on. For some reason <a href="/en/XPConnect" title="en/XPConnect">XPConnect</a> is still hanging onto the message window even though all of our objects have let go of it. This forces a release. It clears out the content listener, the windowCommands, the statusFeedback and the docShell objects.</p>
<pre class="eval"> void closeWindow();
</pre>
<h2 id="Remarks" name="Remarks">Remarks</h2>
<h2 id="See_also" name="See_also">See also</h2>