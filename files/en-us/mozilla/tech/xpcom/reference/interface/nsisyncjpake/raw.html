<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/services/crypto/component/nsISyncJPAKE.idl" rel="custom">services/crypto/component/nsISyncJPAKE.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

<i>Please add a summary to this article.</i>
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>

  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 11.428571428571429%;"></div>

<div style="height: 8px; top: 16px; left: 11.428571428571429%; background: #00dd00; position: absolute; width: 88.57142857142857%;" title="Introduced in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 11.428571428571429%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 11.428571428571429%;">Gecko 2.0</div>

</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span></div>
</div><p></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>void <a href="#final()">final</a>(in ACString aB, in ACString aGVB, in ACString aRB, in ACString aHkdfInfo, out ACString aAES256Key, out ACString aHMAC256Key);</code></td> </tr> <tr> <td><code>void <a href="#round1()">round1</a>(in ACString aSignerID, out ACString aGX1, out ACString aGV1, out ACString aR1, out ACString aGX2, out ACString aGV2, out ACString aR2);</code></td> </tr> <tr> <td><code>void <a href="#round2()">round2</a>(in ACString aPeerID, in ACString aPIN, in ACString aGX3, in ACString aGV3, in ACString aR3, in ACString aGX4, in ACString aGV4, in ACString aR4, out ACString aA, out ACString aGVA, out ACString aRA);</code></td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="final()" name="final()">final()</h3>
<p>Perform the <code>final</code> step of the JPAKE exchange. This will compute the key and expand the key to two keys, an AES256 encryption key and a 256 bit HMAC key. It returns a key confirmation value (SHA256d of the key) and the encryption and HMAC keys.</p>
<pre class="eval">void final(
  in ACString aB,
  in ACString aGVB,
  in ACString aRB,
  in ACString aHkdfInfo,
  out ACString aAES256Key,
  out ACString aHMAC256Key
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aB</code></dt> <dd>Schnorr signature value B, in hex representation.</dd> <dt><code>aGVB</code></dt> <dd>Schnorr signature value g^vb (vb is a random value), in hex representation.</dd> <dt><code>aRB</code></dt> <dd>Schnorr signature value rb = vb - xb * h, in hex representation.</dd> <dt><code>aHkdfInfo</code></dt> <dd>Missing Description</dd> <dt><code>aAES256Key</code></dt> <dd>The AES 256 encryption key, in base64 representation.</dd> <dt><code>aHMAC256Key</code></dt> <dd>The 256 bit HMAC key, in base64 representation.</dd>
</dl>
<h3 id="round1()" name="round1()">round1()</h3>
<p>Perform first round of the JPAKE exchange.</p>
<pre class="eval">void round1(
  in ACString aSignerID,
  out ACString aGX1,
  out ACString aGV1,
  out ACString aR1,
  out ACString aGX2,
  out ACString aGV2,
  out ACString aR2
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aSignerID</code></dt> <dd>String identifying the signer.</dd> <dt><code>aGX1</code></dt> <dd>Schnorr signature value g^x1, in hex representation.</dd> <dt><code>aGV1</code></dt> <dd>Schnorr signature value g^v1 (v1 is a random value), in hex representation.</dd> <dt><code>aR1</code></dt> <dd>Schnorr signature value r1 = v1 - x1 * h, in hex representation.</dd> <dt><code>aGX2</code></dt> <dd>Schnorr signature value g^x2, in hex representation.</dd> <dt><code>aGV2</code></dt> <dd>Schnorr signature value g^v2 (v2 is a random value), in hex representation.</dd> <dt><code>aR2</code></dt> <dd>Schnorr signature value r2 = v2 - x2 * h, in hex representation.</dd>
</dl>
<h3 id="round2()" name="round2()">round2()</h3>
<p>Perform second round of the JPAKE exchange.</p>
<pre class="eval">void round2(
  in ACString aPeerID,
  in ACString aPIN,
  in ACString aGX3,
  in ACString aGV3,
  in ACString aR3,
  in ACString aGX4,
  in ACString aGV4,
  in ACString aR4,
  out ACString aA,
  out ACString aGVA,
  out ACString aRA
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>aPeerID</code></dt> <dd>String identifying the peer.</dd> <dt><code>aPIN</code></dt> <dd>String containing the weak secret (PIN).</dd> <dt><code>aGX3</code></dt> <dd>Schnorr signature value g^x3, in hex representation.</dd> <dt><code>aGV3</code></dt> <dd>Schnorr signature value g^v3 (v3 is a random value), in hex representation.</dd> <dt><code>aR3</code></dt> <dd>Schnorr signature value r3 = v3 - x3 * h, in hex representation.</dd> <dt><code>aGX4</code></dt> <dd>Schnorr signature value g^x4, in hex representation.</dd> <dt><code>aGV4</code></dt> <dd>Schnorr signature value g^v4 (v4 is a random value), in hex representation.</dd> <dt><code>aR4</code></dt> <dd>Schnorr signature value r4 = v4 - x4 * h, in hex representation.</dd> <dt><code>aA</code></dt> <dd>Schnorr signature value A, in hex representation.</dd> <dt><code>aGVA</code></dt> <dd>Schnorr signature value g^va (va is a random value), in hex representation.</dd> <dt><code>aRA</code></dt> <dd>Schnorr signature value ra = va - xa * h, in hex representation.</dd>
</dl>