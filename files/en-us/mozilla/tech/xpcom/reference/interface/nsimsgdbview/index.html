---
title: nsIMsgDBView
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBView
tags:
  - Interfaces
  - 'Interfaces:Scriptable'
  - Message Database
  - Message Windows
  - Messages
  - NeedsContent
  - NeedsMarkupWork
  - XPCOM API Reference
  - XPCOM Interface Reference
  - thunderbird
---
<p>The <code>nsIMsgDBView</code> interface handles the display of mail in the <a href="/en/Threadpane" title="en/Threadpane">threadpane</a> and preview pane of <a href="/en/Thunderbird" title="en/Thunderbird">Thunderbird</a> and other XPCOM based mail cients.</p>

<p>Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code></p>

<p>Implemented by: <code>@mozilla.org/messenger/msgdbview;1</code>. To create an instance, use:</p>

<pre class="eval">var dbView = Components.classes[@mozilla.org/messenger/msgdbview;1?type=]
                    .createInstance(Components.interfaces.nsIMsgDBView);
</pre>

<p>where <code>type</code> designates different types of view's available. Available in the mozilla codebase are types "quicksearch", "threadswithunread", "watchedthreadswithunread", "xfvf" (virtual folders), "search", "group", and "threaded" each with their own implementation of nsIMsgDBView that provides a different sorting/view of the data.</p>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#open.28.29">open</a>(in <a href="/en/XPCOM_Interface_Reference/nsIMsgFolder" title="en/XPCOM_Interface_Reference/nsIMsgFolder">nsIMsgFolder</a> folder, in nsMsgViewSortTypeValue sortType, in nsMsgViewSortOrderValue sortOrder, in nsMsgViewFlagsTypeValue viewFlags, out long count);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#openWithHdrs.28.29">openWithHdrs</a>(in <a href="/en/XPCOM_Interface_Reference/nsISimpleEnumerator" title="en/XPCOM_Interface_Reference/nsISimpleEnumerator">nsISimpleEnumerator</a> aHeaders, in nsMsgViewSortTypeValue aSortType, in nsMsgViewSortOrderValue aSortOrder, in nsMsgViewFlagsTypeValue aViewFlags, out long aCount);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#close.28.29">close</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#init.28.29">init</a>(in <a href="/en/XPCOM_Interface_Reference/nsIMessenger" title="en/XPCOM_Interface_Reference/nsIMessenger">nsIMessenger</a> aMessengerInstance, in <a href="/en/XPCOM_Interface_Reference/nsIMsgWindow" title="en/XPCOM_Interface_Reference/nsIMsgWindow">nsIMsgWindow</a> aMsgWindow, in <a href="/en/XPCOM_Interface_Reference/nsIMsgDBViewCommandUpdater" title="en/XPCOM_Interface_Reference/nsIMsgDBViewCommandUpdater">nsIMsgDBViewCommandUpdater</a> aCommandUpdater);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#sort.28.29">sort</a>(in nsMsgViewSortTypeValue sortType, in nsMsgViewSortOrderValue sortOrder);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#doCommand.28.29">doCommand</a>(in nsMsgViewCommandTypeValue command);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#doCommandWithFolder.28.29">doCommandWithFolder</a>(in nsMsgViewCommandTypeValue command, in <a href="/en/XPCOM_Interface_Reference/nsIMsgFolder" title="en/XPCOM_Interface_Reference/nsIMsgFolder">nsIMsgFolder</a> destFolder);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getCommandStatus.28.29">getCommandStatus</a>(in nsMsgViewCommandTypeValue command, out boolean selectable_p, out nsMsgViewCommandCheckStateValue selected_p);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#viewNavigate.28.29">viewNavigate</a>(in nsMsgNavigationTypeValue motion, out nsMsgKey resultId, out nsMsgViewIndex resultIndex, out nsMsgViewIndex threadIndex, in boolean wrap);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#navigateStatus.28.29">navigateStatus</a>(in nsMsgNavigationTypeValue motion);</code></td>
  </tr>
  <tr>
   <td><code>nsMsgKey <a href="#getKeyAt.28.29">getKeyAt</a>(in nsMsgViewIndex index);</code></td>
  </tr>
  <tr>
   <td>nsIMsgDBHdr getMsgHdrAt(in nsMsgViewIndex index);</td>
  </tr>
  <tr>
   <td><code><a href="/en/XPCOM_Interface_Reference/nsIMsgFolder" title="en/XPCOM_Interface_Reference/nsIMsgFolder">nsIMsgFolder</a> <a href="#getFolderForViewIndex.28.29">getFolderForViewIndex</a>(in nsMsgViewIndex index);</code></td>
  </tr>
  <tr>
   <td><code>ACString <a href="#getURIForViewIndex.28.29">getURIForViewIndex</a>(in nsMsgViewIndex index);</code></td>
  </tr>
  <tr>
   <td><code>nsIMsgDBView <a href="#cloneDBView.28.29">cloneDBView</a>(in <a href="/en/XPCOM_Interface_Reference/nsIMessenger" title="en/XPCOM_Interface_Reference/nsIMessenger">nsIMessenger</a> aMessengerInstance, in <a href="/en/XPCOM_Interface_Reference/nsIMsgWindow" title="en/XPCOM_Interface_Reference/nsIMsgWindow">nsIMsgWindow</a> aMsgWindow, in <a href="/en/XPCOM_Interface_Reference/nsIMsgDBViewCommandUpdater" title="en/XPCOM_Interface_Reference/nsIMsgDBViewCommandUpdater">nsIMsgDBViewCommandUpdater</a> aCommandUpdater);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getURIsForSelection.28.29">getURIsForSelection</a>([array, size_is(count)] out string uris, out unsigned long count);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getIndicesForSelection.28.29">getIndicesForSelection</a>([array, size_is(count)] out nsMsgViewIndex indices, out unsigned long count);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#loadMessageByMsgKey.28.29">loadMessageByMsgKey</a>(in nsMsgKey aMsgKey);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#loadMessageByViewIndex.28.29">loadMessageByViewIndex</a>(in nsMsgViewIndex aIndex);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#loadMessageByUrl.28.29">loadMessageByUrl</a>(in string aUrl);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#reloadMessage.28.29">reloadMessage</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#reloadMessageWithAllParts.28.29">reloadMessageWithAllParts</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#selectMsgByKey.28.29">selectMsgByKey</a>(in nsMsgKey key);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#selectFolderMsgByKey.28.29">selectFolderMsgByKey</a>(in <a href="/en/XPCOM_Interface_Reference/nsIMsgFolder" title="en/XPCOM_Interface_Reference/nsIMsgFolder">nsIMsgFolder</a> aFolder, in nsMsgKey aKey);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#onDeleteCompleted.28.29">onDeleteCompleted</a>(in boolean succeeded);</code></td>
  </tr>
  <tr>
   <td><code>nsMsgViewIndex <a href="#findIndexFromKey.28.29">findIndexFromKey</a>(in nsMsgKey aMsgKey, in boolean aExpand);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#ExpandAndSelectThreadByIndex.28.29">ExpandAndSelectThreadByIndex</a>(in nsMsgViewIndex aIndex, in boolean aAugment);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#addColumnHandler.28.29">addColumnHandler</a>(in AString aColumn, in <a href="/en/XPCOM_Interface_Reference/nsIMsgCustomColumnHandler" title="en/XPCOM_Interface_Reference/nsIMsgCustomColumnHandler">nsIMsgCustomColumnHandler</a> aHandler);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeColumnHandler.28.29">removeColumnHandler</a>(in AString aColumn);</code></td>
  </tr>
  <tr>
   <td><code><a href="/en/XPCOM_Interface_Reference/nsIMsgCustomColumnHandler" title="en/XPCOM_Interface_Reference/nsIMsgCustomColumnHandler">nsIMsgCustomColumnHandler</a> <a href="#getColumnHandler.28.29">getColumnHandler</a>(in AString aColumn);</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>viewType</code></td>
   <td><code>nsMsgViewTypeValue</code></td>
   <td><strong>Readonly:</strong> Type of view. Constants are defined in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewType" title="">nsMsgViewType</a></code>.</td>
  </tr>
  <tr>
   <td><code>viewFlags</code></td>
   <td><code>nsMsgViewFlagsTypeValue</code></td>
   <td>Constants are defined in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewFlagsType" title="">nsMsgViewFlagsType</a></code>.</td>
  </tr>
  <tr>
   <td><code>sortType</code></td>
   <td><code>nsMsgViewSortTypeValue</code></td>
   <td>The type of sort being used (i.e. author, date, status, etc). Sort types are defined in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortType" title="">nsMsgViewSortType</a></code>.</td>
  </tr>
  <tr>
   <td><code>sortOrder</code></td>
   <td><code>nsMsgViewSortOrderValue</code></td>
   <td><strong>Readonly:</strong> Constants are defined in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortOrder" title="">nsMsgViewSortOrder</a></code>.</td>
  </tr>
  <tr>
   <td><code>keyForFirstSelectedMessage</code></td>
   <td><code>nsMsgKey</code></td>
   <td><strong>Readonly:</strong> The key of the first message in the current selection. <code>nsMsgKey</code> is defined as an <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</td>
  </tr>
  <tr>
   <td><code>viewIndexForFirstSelectedMsg</code></td>
   <td><code>nsMsgViewIndex</code></td>
   <td><strong>Readonly:</strong> The index of the first selected message. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</td>
  </tr>
  <tr>
   <td><code>msgFolder</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder" title="">nsIMsgFolder</a></code></code></td>
   <td><strong>Readonly:</strong> The current folder.</td>
  </tr>
  <tr>
   <td><code>viewFolder</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder" title="">nsIMsgFolder</a></code></code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>URIForFirstSelectedMessage</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/ACString" title="">ACString</a></code></code></td>
   <td><strong>Readonly:</strong> URL of the first selected message.</td>
  </tr>
  <tr>
   <td><code>hdrForFirstSelectedMessage</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBHdr" title="">nsIMsgDBHdr</a></code></code></td>
   <td><strong>Readonly:</strong> Header of the first selected message.</td>
  </tr>
  <tr>
   <td><code>numSelected</code></td>
   <td><code>long</code></td>
   <td><strong>Readonly:</strong> The number of messages currently selected.</td>
  </tr>
  <tr>
   <td><code>msgToSelectAfterDelete</code></td>
   <td><code>nsMsgViewIndex</code></td>
   <td><strong>Readonly:</strong> The index of the message to select after the current one is deleted. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</td>
  </tr>
  <tr>
   <td><code>currentlyDisplayedMessage</code></td>
   <td><code>nsMsgViewIndex</code></td>
   <td><strong>Readonly:</strong> The index of the currently displayed message. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</td>
  </tr>
  <tr>
   <td><code>suppressMsgDisplay</code></td>
   <td><code>boolean</code></td>
   <td>Suppress displaying messages. Used when the message pane is collapsed.</td>
  </tr>
  <tr>
   <td><code>suppressCommandUpdating</code></td>
   <td><code>boolean</code></td>
   <td>Suppress command updating. Used during folder loading.</td>
  </tr>
  <tr>
   <td><code>db</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDatabase" title="">nsIMsgDatabase</a></code></code></td>
   <td><strong>Readonly:</strong> The current database of messages.</td>
  </tr>
  <tr>
   <td><code>supportsThreading</code></td>
   <td><code>boolean</code></td>
   <td><strong>Readonly:</strong> Does the current database support threading?</td>
  </tr>
  <tr>
   <td><code>searchSession</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgSearchSession" title="">nsIMsgSearchSession</a></code></code></td>
   <td>The current search session.</td>
  </tr>
  <tr>
   <td><code>removeRowOnMoveOrDelete</code></td>
   <td><code>boolean</code></td>
   <td><strong>Readonly:</strong></td>
  </tr>
  <tr>
   <td><code>usingLines</code></td>
   <td><code>boolean</code></td>
   <td><strong>Readonly:</strong> Use lines for size. If <code>false</code> kB are used.</td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="open.28.29" name="open.28.29">open()</h3>

<p>Opens a folder in the database.</p>

<pre class="eval"> void open(in nsIMsgFolder folder,
           in nsMsgViewSortTypeValue sortType,
           in nsMsgViewSortOrderValue sortOrder,
           in nsMsgViewFlagsTypeValue viewFlags,
           out long count);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>folder</code></dt>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder" title="">nsIMsgFolder</a></code> to open.</dd>
 <dt><code>sortType</code></dt>
 <dd>A <code>nsMsgViewSortTypeValue</code> designating the sort type used for the folder. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortType" title="">nsMsgViewSortType</a></code>.</dd>
 <dt><code>sortOrder</code></dt>
 <dd>An nsMsgViewSortOrderValue designating the sort order used for the folder. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortOrder" title="">nsMsgViewSortOrder</a></code>.</dd>
 <dt><code>viewFlags</code></dt>
 <dd>Other flags to be used. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewFlagsType" title="">nsMsgViewFlagsType</a></code>.</dd>
</dl>

<h6 id="Return_values" name="Return_values">Return values</h6>

<dl>
 <dt><code>count</code></dt>
 <dd>Upon return, the count variable may contain the number of messages in the folder.</dd>
</dl>

<p></p><div class="blockIndicator note"><strong>Note:</strong> This return value does not appear to be implemented in the <a class='"external"' href='"http://mxr.mozilla.org/mozilla/source/mailnews/base/src/nsMsgDBView.cpp#1970"'>base implementation</a>.</div><p></p>

<h3 id="openWithHdrs.28.29" name="openWithHdrs.28.29">openWithHdrs()</h3>

<p>Opens the view with a set of specified headers. </p><div class="blockIndicator note"><strong>Note:</strong> This is not implemented in the <a class='"external"' href='"http://mxr.mozilla.org/mozilla/source/mailnews/base/src/nsMsgDBView.cpp#1970"'>base implementation</a>.</div><p></p>

<pre class="eval"> void openWithHdrs(in nsISimpleEnumerator aHeaders,
                   in nsMsgViewSortTypeValue aSortType,
                   in nsMsgViewSortOrderValue aSortOrder,
                   in nsMsgViewFlagsTypeValue aViewFlags,
                   out long aCount);
</pre>

<h6 id="Parameters_2" name="Parameters_2">Parameters</h6>

<dl>
 <dt><code>aHeaders</code></dt>
 <dd>A list of headers to open, arranged in an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISimpleEnumerator" title="">nsISimpleEnumerator</a></code>.</dd>
 <dt><code>aSortType</code></dt>
 <dd>A <code>nsMsgViewSortTypeValue</code> designating the sort type used for the folder. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortType" title="">nsMsgViewSortType</a></code>.</dd>
 <dt><code>sortOrder</code></dt>
 <dd>An nsMsgViewSortOrderValue designating the sort order used for the folder. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortOrder" title="">nsMsgViewSortOrder</a></code>.</dd>
 <dt><code>viewFlags</code></dt>
 <dd>Other flags to be used. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewFlagsType" title="">nsMsgViewFlagsType</a></code>.</dd>
</dl>

<h6 id="Return_values_2" name="Return_values_2">Return values</h6>

<dl>
 <dt><code>aCount</code></dt>
 <dd>Upon return, the count variable may contain the number of messages loaded.</dd>
</dl>

<h3 id="close.28.29" name="close.28.29">close()</h3>

<p>Close the current list of messages.</p>

<pre class="eval"> void close();
</pre>

<h3 id="init.28.29" name="init.28.29">init()</h3>

<p>Initializes the database view for use.</p>

<pre class="eval"> void init(in nsIMessenger aMessengerInstance,
           in nsIMsgWindow aMsgWindow,
           in nsIMsgDBViewCommandUpdater aCommandUpdater);
</pre>

<h6 id="Parameters_3" name="Parameters_3">Parameters</h6>

<dl>
 <dt><code>aMessengerInstance</code></dt>
 <dt><code>aMsgWindow</code></dt>
 <dt><code>aCommandUpdater</code></dt>
</dl>

<h3 id="sort.28.29" name="sort.28.29">sort()</h3>

<p>Sorts the currently loaded messages.</p>

<pre class="eval"> void sort(in nsMsgViewSortTypeValue sortType,
           in nsMsgViewSortOrderValue sortOrder);
</pre>

<h6 id="Parameters_4" name="Parameters_4">Parameters</h6>

<dl>
 <dt><code>sortType</code></dt>
 <dd>A <code>nsMsgViewSortTypeValue</code> designating the sort type used. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortType" title="">nsMsgViewSortType</a></code>.</dd>
 <dt><code>sortOrder</code></dt>
 <dd>An nsMsgViewSortOrderValue designating the sort order used for the folder. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewSortOrder" title="">nsMsgViewSortOrder</a></code>.</dd>
</dl>

<h3 id="doCommand.28.29" name="doCommand.28.29">doCommand()</h3>

<p>Perform a command on the currently loaded messages.</p>

<pre class="eval"> void doCommand(in nsMsgViewCommandTypeValue command);
</pre>

<h6 id="Parameters_5" name="Parameters_5">Parameters</h6>

<dl>
 <dt><code>command</code></dt>
 <dd>The <code>nsMsgViewCommandTypeValue</code> to perform. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewCommandType" title="">nsMsgViewCommandType</a></code>.</dd>
</dl>

<h3 id="doCommandWithFolder.28.29" name="doCommandWithFolder.28.29">doCommandWithFolder()</h3>

<p>Perform a command that requires a folder. Typical examples are <code>move</code> or <code>copy</code> commands.</p>

<pre class="eval"> void doCommandWithFolder(in nsMsgViewCommandTypeValue command,
                          in nsIMsgFolder destFolder);
</pre>

<h6 id="Parameters_6" name="Parameters_6">Parameters</h6>

<dl>
 <dt><code>command</code></dt>
 <dd>The <code>nsMsgViewCommandTypeValue</code> to perform. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewCommandType" title="">nsMsgViewCommandType</a></code>.</dd>
 <dt><code>destFolder</code></dt>
 <dd>The folder to perform the command with.</dd>
</dl>

<h3 id="getCommandStatus.28.29" name="getCommandStatus.28.29">getCommandStatus()</h3>

<p>Gets the status of a particular command. Used by the <a href="/en/Thunderbird" title="en/Thunderbird">Thunderbird</a> UI to determine if the command is available.</p>

<pre class="eval"> void getCommandStatus(in nsMsgViewCommandTypeValue command,
                       out boolean selectable_p,
                       out nsMsgViewCommandCheckStateValue selected_p);
</pre>

<h6 id="Parameters_7" name="Parameters_7">Parameters</h6>

<dl>
 <dt><code>command</code></dt>
 <dd>The <code>nsMsgViewCommandTypeValue</code> to perform. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewCommandType" title="">nsMsgViewCommandType</a></code>.</dd>
</dl>

<h6 id="Return_values_3" name="Return_values_3">Return values</h6>

<dl>
 <dt><code>selectable_p</code></dt>
 <dd>The state of the command. <code>true</code> if it is enabled. <code>false</code> if it is disabled.</dd>
 <dt><code>selected_p</code></dt>
 <dd>The returned check state of the command. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgViewCommandCheckState" title="">nsMsgViewCommandCheckState</a></code>. This is not used for all commands and will return the <code>notUsed</code> value most of the time.</dd>
</dl>

<h3 id="viewNavigate.28.29" name="viewNavigate.28.29">viewNavigate()</h3>

<p>Change the view to show a particular message. This method will automatically expand the destination thread.</p>

<pre class="eval"> void viewNavigate(in nsMsgNavigationTypeValue motion,
                   out nsMsgKey resultId,
                   out nsMsgViewIndex resultIndex,
                   out nsMsgViewIndex threadIndex,
                   in boolean wrap);
</pre>

<h6 id="Parameters_8" name="Parameters_8">Parameters</h6>

<dl>
 <dt><code>motion</code></dt>
 <dd>The <code>nsMsgNavigationTypeValue</code>. Defined in the interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgNavigationType" title="">nsMsgNavigationType</a></code>.</dd>
 <dt><code>wrap</code></dt>
 <dd>Whether to wrap around messages from the last to first (or vice versa).</dd>
</dl>

<h6 id="Return_values_4" name="Return_values_4">Return values</h6>

<dl>
 <dt><code>resultId</code></dt>
 <dd>The key of the result message. <code>nsMsgKey</code> is defined as an <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
 <dt><code>resultIndex</code></dt>
 <dd>The index of the result message. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
 <dt><code>threadIndex</code></dt>
 <dd>The index of the new thread. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
</dl>

<h3 id="navigateStatus.28.29" name="navigateStatus.28.29">navigateStatus()</h3>

<p>Indicates if the passed motion type is currently valid.</p>

<pre class="eval"> boolean navigateStatus(in nsMsgNavigationTypeValue motion);
</pre>

<h6 id="Parameters_9" name="Parameters_9">Parameters</h6>

<dl>
 <dt><code>motion</code></dt>
 <dd>The <code>nsMsgNavigationTypeValue</code>. Defined in ther interface: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsMsgNavigationType" title="">nsMsgNavigationType</a></code>.</dd>
</dl>

<h6 id="Return_values_5" name="Return_values_5">Return values</h6>

<dl>
 <dd>True if the motion is available. False otherwise.</dd>
</dl>

<h3 id="getKeyAt.28.29" name="getKeyAt.28.29">getKeyAt()</h3>

<p>Gets the key for the message at a particular index.</p>

<pre class="eval"> nsMsgKey getKeyAt(in nsMsgViewIndex index);
</pre>

<h6 id="Parameters_10" name="Parameters_10">Parameters</h6>

<dl>
 <dt><code>index</code></dt>
 <dd>The index of the message. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>The key of the message. <code>nsMsgKey</code> is defined as an <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</p>

<h3 id="getFolderForViewIndex.28.29" name="getFolderForViewIndex.28.29">getFolderForViewIndex()</h3>

<p>Mainly for search. Gets the folder of the message at a particular index.</p>

<pre class="eval"> nsIMsgFolder getFolderForViewIndex(in nsMsgViewIndex index);
</pre>

<h6 id="Parameters_11" name="Parameters_11">Parameters</h6>

<dl>
 <dt><code>index</code></dt>
 <dd>The index of the message. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
</dl>

<h6 id="Return_value_2" name="Return_value_2">Return value</h6>

<dl>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder" title="">nsIMsgFolder</a></code> containing the message.</dd>
</dl>

<h3 id="getURIForViewIndex.28.29" name="getURIForViewIndex.28.29">getURIForViewIndex()</h3>

<p>Gets the URL for the message at the given index.</p>

<pre class="eval"> ACString getURIForViewIndex(in nsMsgViewIndex index);
</pre>

<h6 id="Parameters_12" name="Parameters_12">Parameters</h6>

<dl>
 <dt><code>index</code></dt>
 <dd>The index to get the <code>URL</code> for&gt;. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
</dl>

<h6 id="Return_value_3" name="Return_value_3">Return value</h6>

<dl>
 <dd>A string containing the messages URL.</dd>
</dl>

<h3 id="cloneDBView.28.29" name="cloneDBView.28.29">cloneDBView()</h3>

<p>Clones this nsIMsgDBView.</p>

<pre class="eval"> nsIMsgDBView cloneDBView(in nsIMessenger aMessengerInstance,
                          in nsIMsgWindow aMsgWindow,
                          in nsIMsgDBViewCommandUpdater aCommandUpdater);
</pre>

<h6 id="Parameters_13" name="Parameters_13">Parameters</h6>

<dl>
 <dt><code>aMessengerInstance</code></dt>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMessenger" title="">nsIMessenger</a></code> to use in the clone.</dd>
 <dt><code>aMsgWindow</code></dt>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgWindow" title="">nsIMsgWindow</a></code> to use in the clone.</dd>
 <dt><code>aCommandUpdater</code></dt>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgDBViewCommandUpdater" title="">nsIMsgDBViewCommandUpdater</a></code> to use in the clone.</dd>
</dl>

<h3 id="getURIsForSelection.28.29" name="getURIsForSelection.28.29">getURIsForSelection()</h3>

<p>Gets an arry of URLs for all currently selected messages.</p>

<pre class="eval"> void getURIsForSelection([array, size_is(count)] out string uris,
                                                  out unsigned long count);
</pre>

<h6 id="Return_values_6" name="Return_values_6">Return values</h6>

<dl>
 <dt><code>uris</code></dt>
 <dd>An array of urls for the selected messages.</dd>
 <dt><code>count</code></dt>
 <dd>The number of urls returned.</dd>
</dl>

<h3 id="getIndicesForSelection.28.29" name="getIndicesForSelection.28.29">getIndicesForSelection()</h3>

<p>Gets the indicies of the selected messages.</p>

<pre class="eval"> void getIndicesForSelection([array, size_is(count)] out nsMsgViewIndex indices,
                                                     out unsigned long count);
</pre>

<h6 id="Return_values_7" name="Return_values_7">Return values</h6>

<dl>
 <dt><code>indices</code></dt>
 <dd>The output array of indicies. Each element of the array is an <code>nsMsgViewIndex</code> which is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
 <dt><code>count</code></dt>
 <dd>The number of indicies returned.</dd>
</dl>

<h3 id="loadMessageByMsgKey.28.29" name="loadMessageByMsgKey.28.29">loadMessageByMsgKey()</h3>

<p>Loads a message into the message pane.</p>

<pre class="eval"> void loadMessageByMsgKey(in nsMsgKey aMsgKey);
</pre>

<h6 id="Parameters_14" name="Parameters_14">Parameters</h6>

<dl>
 <dt><code>aMsgKey</code></dt>
 <dd>The Key of the message to load. <code>nsMsgKey</code> is defined as an <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
</dl>

<h3 id="loadMessageByViewIndex.28.29" name="loadMessageByViewIndex.28.29">loadMessageByViewIndex()</h3>

<p>Loads a message into the message pane.</p>

<pre class="eval"> void loadMessageByViewIndex(in nsMsgViewIndex aIndex);
</pre>

<h6 id="Parameters_15" name="Parameters_15">Parameters</h6>

<dl>
 <dt><code>aIndex</code></dt>
 <dd>The index of the message to load. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
</dl>

<h3 id="loadMessageByUrl.28.29" name="loadMessageByUrl.28.29">loadMessageByUrl()</h3>

<p>Loads a message into the message pane.</p>

<pre class="eval"> void loadMessageByUrl(in string aUrl);
</pre>

<h6 id="Parameters_16" name="Parameters_16">Parameters</h6>

<dl>
 <dt><code>aUrl</code></dt>
 <dd>The URL of the message</dd>
</dl>

<h3 id="reloadMessage.28.29" name="reloadMessage.28.29">reloadMessage()</h3>

<p>Reload the currently shown message.</p>

<pre class="eval"> void reloadMessage();
</pre>

<h3 id="reloadMessageWithAllParts.28.29" name="reloadMessageWithAllParts.28.29">reloadMessageWithAllParts()</h3>

<p>Reload the currently shown message with <code>fetchCompleteMessage</code> set to true. This forces everything to be re-downloaded.</p>

<pre class="eval"> void reloadMessageWithAllParts();
</pre>

<h3 id="selectMsgByKey.28.29" name="selectMsgByKey.28.29">selectMsgByKey()</h3>

<p>Selects a message based on its key. Used by "go to folder" feature and "remember last selected message" feature. If key is not found, nothing is selected.</p>

<pre class="eval"> void selectMsgByKey(in nsMsgKey key);
</pre>

<h6 id="Parameters_17" name="Parameters_17">Parameters</h6>

<dl>
 <dt><code>key</code></dt>
</dl>

<p>The Key of the message to load. <code>nsMsgKey</code> is defined as an <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</p>

<h3 id="selectFolderMsgByKey.28.29" name="selectFolderMsgByKey.28.29">selectFolderMsgByKey()</h3>

<p>Selects a message within a folder by its key. This assumes that the key is somewhere in the displayed messages... I think.</p>

<pre class="eval"> void selectFolderMsgByKey(in nsIMsgFolder aFolder,
                           in nsMsgKey aKey);
</pre>

<h6 id="Parameters_18" name="Parameters_18">Parameters</h6>

<dl>
 <dt><code>aFolder</code></dt>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFolder" title="">nsIMsgFolder</a></code> to search within.</dd>
 <dt><code>aKey</code></dt>
 <dd>The key of the message. <code>nsMsgKey</code> is defined as an <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
</dl>

<h3 id="onDeleteCompleted.28.29" name="onDeleteCompleted.28.29">onDeleteCompleted()</h3>

<p>Called when delete is completed on a message. Used to notify the tree that rows are going away.</p>

<pre class="eval"> void onDeleteCompleted(in boolean succeeded);
</pre>

<h6 id="Parameters_19" name="Parameters_19">Parameters</h6>

<dl>
 <dt><code>succeeded</code></dt>
 <dd><code>true</code> if the delete was successful.</dd>
</dl>

<h3 id="findIndexFromKey.28.29" name="findIndexFromKey.28.29">findIndexFromKey()</h3>

<p>Gets the index of a message with a particular key.</p>

<pre class="eval"> nsMsgViewIndex findIndexFromKey(in nsMsgKey aMsgKey,
                                 in boolean aExpand);
</pre>

<h6 id="Parameters_20" name="Parameters_20">Parameters</h6>

<dl>
 <dt><code>aMsgKey</code></dt>
 <dd>The Key of the message. <code>nsMsgKey</code> is defined as an <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
 <dt><code>aExpand</code></dt>
 <dd>Whether or not to expand the thread or group the message is in. Otherwise, the index may be the index of the thread and not the message.</dd>
</dl>

<h6 id="Return_value_4" name="Return_value_4">Return value</h6>

<p>The index of the message. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</p>

<h3 id="ExpandAndSelectThreadByIndex.28.29" name="ExpandAndSelectThreadByIndex.28.29">ExpandAndSelectThreadByIndex()</h3>

<pre class="eval"> void ExpandAndSelectThreadByIndex(in nsMsgViewIndex aIndex,
                                   in boolean aAugment);
</pre>

<h6 id="Parameters_21" name="Parameters_21">Parameters</h6>

<dl>
 <dt><code>aIndex</code></dt>
 <dd>The index of the thread to expand and select. <code>nsMsgViewIndex</code> is defined as a <code>unsigned long</code> in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/public/MailNewsTypes2.idl">MailNewsTypes2.idl</a>.</dd>
 <dt><code>aAugment</code></dt>
 <dd>If <code>true</code> then add to current selection. If <code>false</code> then replace current selection.</dd>
</dl>

<h3 id="addColumnHandler.28.29" name="addColumnHandler.28.29">addColumnHandler()</h3>

<p>Attaches a <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgCustomColumnHandler" title="">nsIMsgCustomColumnHandler</a></code> to a specific column (can be a new column or a built in).+</p>

<pre class="eval"> void addColumnHandler(in AString aColumn,
                       in nsIMsgCustomColumnHandler aHandler);
</pre>

<h6 id="Parameters_22" name="Parameters_22">Parameters</h6>

<dl>
 <dt><code>aColumn</code></dt>
 <dd>The name of the column to add the handler for.</dd>
 <dt><code>aHandler</code></dt>
 <dd>The <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgCustomColumnHandler" title="">nsIMsgCustomColumnHandler</a></code> to add.</dd>
</dl>

<h3 id="removeColumnHandler.28.29" name="removeColumnHandler.28.29">removeColumnHandler()</h3>

<p>Removes a <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgCustomColumnHandler" title="">nsIMsgCustomColumnHandler</a></code> leaving the column to be handled by the system</p>

<pre class="eval"> void removeColumnHandler(in AString aColumn);
</pre>

<h6 id="Parameters_23" name="Parameters_23">Parameters</h6>

<dl>
 <dt><code>aColumn</code></dt>
 <dd>The name of the column to remove the handler from.</dd>
</dl>

<h3 id="getColumnHandler.28.29" name="getColumnHandler.28.29">getColumnHandler()</h3>

<p>Returns the <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgCustomColumnHandler" title="">nsIMsgCustomColumnHandler</a></code> attached to a specific column, if any.</p>

<pre class="eval"> nsIMsgCustomColumnHandler getColumnHandler(in AString aColumn);
</pre>

<h6 id="Parameters_24" name="Parameters_24">Parameters</h6>

<dl>
 <dt><code>aColumn</code></dt>
 <dd>The name of the column to get the handler for.</dd>
</dl>
