---
title: nsIAppStartup
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIAppStartup
tags:
  - Interfaces
  - 'Interfaces:Scriptable'
  - XPCOM
  - XPCOM API Reference
  - XPCOM Interface Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/toolkit/components/startup/public/nsIAppStartup.idl" rel="custom">toolkit/components/startup/public/nsIAppStartup.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface is intended to be used as application startup service. It also helps in quitting applications as well.
</span>

  <div style="height: 42px; position: relative; padding: 2px; width: auto;">

  <div style="top: 22px; font-size: 11px; position: absolute;">1.0</div>

  <div style="top: 22px; font-size: 11px; position: absolute; left: 0px; text-align: right; float: right; width: 100%;">66</div>

  <div style="height: 8px; top: 16px; background: #dd0000; left: 0px; position: absolute; width: 5.714285714285714%;"></div>

<div style="height: 8px; top: 16px; left: 5.714285714285714%; background: #00dd00; position: absolute; width: 94.28571428571429%;" title="Introduced in Gecko 1.8 (Firefox 1.5 / Thunderbird 1.5 / SeaMonkey 1.0)"></div>

<div style="top: 0px; font-size: 11px; position: absolute; left: 5.714285714285714%;">Introduced</div>
<div style="top: 22px; font-size: 11px; position: absolute; left: 5.714285714285714%;">Gecko 1.8</div>

    <div style="height: 8px; top: 16px; left: 18.071428571428573%; background: #eeee00; position: absolute; width: 1%; border-radius: 4px; -webkit-border-radius: 4px;" title="Last changed in Gecko 9.0 (Firefox 9.0 / Thunderbird 9.0 / SeaMonkey 2.6)"></div>

</div>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 9.0 (Firefox 9.0 / Thunderbird 9.0 / SeaMonkey 2.6)</span></div>
</div><p></p>

<p>Implemented by: <code>@mozilla.org/toolkit/app-startup;1</code>. To use the service:</p>

<pre class="eval">var appStartup = Components.classes["<code>@mozilla.org/toolkit/app-startup;1</code>"]
                 .getService(Components.interfaces.nsIAppStartup);
</pre>

<h2 id="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#createHiddenWindow()">createHiddenWindow</a>();</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#createStartupState()">createStartupState</a>(in long aWindowWidth, in long aWindowHeight);</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#destroyHiddenWindow()">destroyHiddenWindow</a>();</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#doProfileStartup()">doProfileStartup</a>(in nsICmdLineService aCmdLineService, in boolean canInteract);</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#ensure1Window()">ensure1Window</a>(in nsICmdLineService aCmdLineService);</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#enterLastWindowClosingSurvivalArea()">enterLastWindowClosingSurvivalArea</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#exitLastWindowClosingSurvivalArea()">exitLastWindowClosingSurvivalArea</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getStartupInfo()">getStartupInfo</a>(); </code></td>
  </tr>
  <tr>
   <td><code>void <a href="#hideSplashScreen()">hideSplashScreen</a>();</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#initialize()">initialize</a>(in nsISupports nativeAppSupportOrSplashScreen);</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#quit()">quit</a>(in PRUint32 aMode);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#restartInSafeMode()">restartInSafeMode</a>(in PRUint32 aQuitMode);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#run()">run</a>();</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>interrupted</code></td>
   <td><code>boolean</code></td>
   <td><code>true</code> if the startup process was interrupted by an interactive prompt. This can be used, for example, when doing performance testing of the startup process to discount numbers for tests that were interrupted by a user prompt. </td>
  </tr>
  <tr>
   <td><code>nativeAppSupport</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsINativeAppSupport" title="">nsINativeAppSupport</a></code></code></td>
   <td>Getter for "native application support." <strong>Read only.</strong> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td>
  </tr>
 </tbody>
</table>

<h2 id="Constants" name="Constants">Constants</h2>

<p>The following flags may be passed as the <code>aMode</code> parameter to the <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIAppStartup#quit()">quit()</a></code> method. One and only one of the "Quit" flags must be specified. The <code>eRestart</code> flag may be bit-wise combined with one of the "Quit" flags to cause the application to restart after it quits.</p>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Constant</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>eConsiderQuit</code></td>
   <td>0x01</td>
   <td>Attempt to quit if all windows are closed.</td>
  </tr>
  <tr>
   <td><code>eAttemptQuit</code></td>
   <td>0x02</td>
   <td>Try to close all windows, then quit if successful.</td>
  </tr>
  <tr>
   <td><code>eForceQuit</code></td>
   <td>0x03</td>
   <td>Force all windows to close, then quit.</td>
  </tr>
  <tr>
   <td><code>eRestart</code></td>
   <td>0x10</td>
   <td>Restart the application after quitting. The application will be restarted with the same profile and an empty command line.</td>
  </tr>
  <tr>
   <td><code>eRestartNotSameProfile</code></td>
   <td>0x100</td>
   <td>Restart the application after quitting. The application will be restarted with an empty command line and the normal profile selection process will take place on startup.</td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="createHiddenWindow()" name="createHiddenWindow()">createHiddenWindow()</h3>

<p>Create the hidden window.</p>

<pre class="eval">void createHiddenWindow();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><div class="headingWithIndicator">
        <h3 id="createStartupState()">createStartupState()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span>
        </div><p></p>

<p>Creates the initial state of the application by launching tasks specfied by "general.startup.*" prefs.</p>

<p></p><div class="blockIndicator note"><strong>Note:</strong> SIZE_TO_CONTENT may be used for width or height.</div><p></p>

<pre class="eval">boolean createStartupState(
  in long aWindowWidth,
  in long aWindowHeight
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aWindowWidth</code></dt>
 <dd>The width to make the initial window(s) opened.</dd>
 <dt><code>aWindowHeight</code></dt>
 <dd>The height to make the initial window(s) opened.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p><code>TRUE</code> if a window was opened.</p>

<p></p><h3 id="destroyHiddenWindow()">destroyHiddenWindow()</h3><p></p>

<p>Destroys the hidden window. This will have no effect if the hidden window has not yet been created.</p>

<pre class="eval">void destroyHiddenWindow();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><div class="headingWithIndicator">
        <h3 id="doProfileStartup()">doProfileStartup()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span>
        </div><p></p>

<p>Starts up the profile manager with the given arguments.</p>

<pre class="eval">void doProfileStartup(
  in nsICmdLineService aCmdLineService,
  in boolean canInteract
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aCmdLineService</code></dt>
 <dd>The arguments given to the program.</dd>
 <dt><code>canInteract</code></dt>
 <dd>If <code>FALSE</code> and UI is needed, will fail.</dd>
</dl>

<p></p><div class="headingWithIndicator">
        <h3 id="ensure1Window()">ensure1Window()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span>
        </div><p></p>

<p>Ensures that at least one window exists after creating the startup state. If one has not been made, this will create a browser window.</p>

<pre class="eval">void ensure1Window(
  in nsICmdLineService aCmdLineService
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aCmdLineService</code></dt>
 <dd>The command line from which startup args can be read.</dd>
</dl>

<h3 id="enterLastWindowClosingSurvivalArea()" name="enterLastWindowClosingSurvivalArea()">enterLastWindowClosingSurvivalArea()</h3>

<p>Serves for situations when all application windows will be closed but we don't want to take this as a signal to quit the application. Bracket the code where the last window could close with these.</p>

<pre class="eval">void enterLastWindowClosingSurvivalArea();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="exitLastWindowClosingSurvivalArea()" name="exitLastWindowClosingSurvivalArea()">exitLastWindowClosingSurvivalArea()</h3>

<p>This method serves for situations when all application windows will be closed but we don't want to take this as a signal to quit the application. Bracket the code where the last window could close with these.</p>

<pre class="eval">void exitLastWindowClosingSurvivalArea();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><h3 id="getStartupInfo()">getStartupInfo()</h3><p></p>

<p>Returns a JavaScript object with events from startup and the timestamps indicating when they occurred.</p>

<h6 id="Example" name="Example">Parameters</h6>

<p>None.</p>

<h6 id="Return_value_2">Return value</h6>

<p>A JavaScript object with the following fields. Keys are the event names and their values are the times. Events that didn't occur are not in the object.</p>

<table class="standard-table">
 <thead>
  <tr>
   <th scope="col">Event identifier (key)</th>
   <th scope="col">Description</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><code>main</code></td>
   <td>
    <p>Time at which main application core was loaded.</p>

    <div class="note"><strong>Note:</strong> Only available with <a href="/en/Configuring_Build_Options#Graphics_Toolkit" title="en/configuring build options#Graphics Toolkit">libxul</a> builds.</div>
   </td>
  </tr>
  <tr>
   <td><code>firstPaint</code></td>
   <td>
    <p>Time  the first paint occurred.</p>

    <div class="note"><strong>Note:</strong> Only available with <a href="/en/Configuring_Build_Options#Graphics_Toolkit" title="en/configuring build options#Graphics Toolkit">libxul</a> builds.</div>
   </td>
  </tr>
  <tr>
   <td><code>sessionRestored</code></td>
   <td>Time  session restore finished.</td>
  </tr>
 </tbody>
</table>

<h6 id="Example" name="Example">Example</h6>

<p>This example logs startup time information to the console.</p>

<pre class="deki-transform">var aConsoleService = Components.classes["@mozilla.org/consoleservice;1"]
                      .getService(Components.interfaces.nsIConsoleService);
var startupInfo = Components.classes["@mozilla.org/toolkit/app-startup;1"]
                      .getService(Ci.nsIAppStartup_MOZILLA_2_0).getStartupInfo();

var keys = Object.keys(startupInfo);

keys.sort(function(a, b) { return startupInfo[a] - startupInfo[b]; });

for each (var name in keys) {
  aConsoleService.logStringMessage(name + ": " + startupInfo[name]);
}
</pre>

<p>To calculate how long startup took, compute the difference between the event's timestamp and the timestamp of the <code>process</code> event.</p>

<p></p><div class="headingWithIndicator">
        <h3 id="hideSplashScreen()">hideSplashScreen()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span>
        </div><p></p>

<p>Remove the splash screen (if visible). This need be called only once per application session.</p>

<pre class="eval">void hideSplashScreen();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><div class="headingWithIndicator">
        <h3 id="initialize()">initialize()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span>
        </div><p></p>

<p>Required initialization routine.</p>

<pre class="eval">void initialize(
  in nsISupports nativeAppSupportOrSplashScreen
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>nativeAppSupportOrSplashScreen</code></dt>
 <dd>Is an object that can be QI'd to either an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsINativeAppSupport" title="">nsINativeAppSupport</a></code> or <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISplashScreen" title="">nsISplashScreen</a></code>; this object will be used to implement HideSplashScreen.</dd>
</dl>

<h3 id="quit()" name="quit()">quit()</h3>

<p>Exit the event loop, and shut down the application.</p>

<pre class="eval">void quit(
  in PRUint32 aMode
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aMode</code></dt>
 <dd>This parameter modifies how the application is shutdown, and it is constructed from the constants defined above.</dd>
</dl>

<h3 id="restartInSafeMode()" name="restartInSafeMode()">restartInSafeMode()</h3>

<p>Restart the application in safe mode.</p>

<pre class="eval">void quit(
  in PRUint32 aQuitMode
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aQuitMode</code></dt>
 <dd>This parameter modifies how the app is shutdown.</dd>
</dl>

<h3 id="run()" name="run()">run()</h3>

<p>Runs an application event loop: normally the main event pump which defines the lifetime of the application. If there are no windows open and no outstanding calls to <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIAppStartup#enterLastWindowClosingSurvivalArea()">enterLastWindowClosingSurvivalArea()</a></code> this method will exit immediately.</p>

<pre class="eval">void run();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>Returns <code>NS_SUCCESS_RESTART_APP</code> code. This return code indicates that the application should be restarted because quit was called with the <code>eRestart</code> flag.</p>

<h3 id="See_also" name="See_also">See also</h3>

<ul>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsICmdLineService" title="">nsICmdLineService</a></code></li>
 <li><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIAppStartup_MOZILLA_2_0" title="">nsIAppStartup_MOZILLA_2_0</a></code></li>
</ul>
