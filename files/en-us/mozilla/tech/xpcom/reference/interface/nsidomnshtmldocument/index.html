---
title: nsIDOMNSHTMLDocument
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMNSHTMLDocument
tags:
  - DOM
  - Document
  - Gecko
  - Interfaces
  - 'Interfaces:Scriptable'
  - NeedsContent
  - XPCOM API Reference
  - XPCOM Interface Reference
---
<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/dom/interfaces/html/nsIDOMNSHTMLDocument.idl" rel="custom">dom/interfaces/html/nsIDOMNSHTMLDocument.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

This interface defines methods and properties supported by Gecko on the <a href="/en-US/docs/Web/API/document">document</a> object that are not part of DOM Level 2.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title>nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 6.0 (Firefox 6.0 / Thunderbird 6.0 / SeaMonkey 2.3)</span></div>
</div><p></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#captureEvents()">captureEvents</a>(in long eventFlags);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#clear()">clear</a>();</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#execCommand()">execCommand</a>(in DOMString commandID, in boolean doShowUI, in DOMString value);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#execCommandShowHelp()">execCommandShowHelp</a>(in DOMString commandID);</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)">Obsolete since Gecko 14.0</span></td>
  </tr>
  <tr>
   <td><code>DOMString <a href="#getSelection()">getSelection</a>();</code></td>
  </tr>
  <tr>
   <td><code>nsIDOMDocument <a href="#open()">open</a>(in ACString aContentType, in boolean aReplace);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#queryCommandEnabled()">queryCommandEnabled</a>(in DOMString commandID);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#queryCommandIndeterm()">queryCommandIndeterm</a>(in DOMString commandID);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#queryCommandState()">queryCommandState</a>(in DOMString commandID);</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#queryCommandSupported()">queryCommandSupported</a>(in DOMString commandID);</code></td>
  </tr>
  <tr>
   <td><code>DOMString <a href="#queryCommandText()">queryCommandText</a>(in DOMString commandID);</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)">Obsolete since Gecko 14.0</span></td>
  </tr>
  <tr>
   <td><code>DOMString <a href="#queryCommandValue()">queryCommandValue</a>(in DOMString commandID);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#releaseEvents()">releaseEvents</a>(in long eventFlags);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#routeEvent()">routeEvent</a>(in nsIDOMEvent evt);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#write()">write</a>();</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)">Obsolete since Gecko 2.0</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#writeln()">writeln</a>();</code> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)">Obsolete since Gecko 2.0</span></td>
  </tr>
 </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>alinkColor</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Same as <a href="/en/DOM/HTMLBodyElement#Properties">body.aLink</a></td>
  </tr>
  <tr>
   <td><code>bgColor</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Same as <a href="/en/DOM/HTMLBodyElement#Properties">body.bgColor</a></td>
  </tr>
  <tr>
   <td><code>compatMode</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Returns &quot;BackCompat&quot; if the document is in Quirks mode or &quot;CSS1Compat&quot; if the document is in Full Standards or Almost Standards mode. <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>designMode</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Set to &quot;on&quot; or &quot;off&quot; to enable or disable editing for the entire document at once. Roughly equivalent to <a href="/en/DOM/HTMLBodyElement#Properties">body.contentEditable</a></td>
  </tr>
  <tr>
   <td><code>domain</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Initially the host name of the document&apos;s URL, but may be changed to the parent (but not top-level) domain in order to facilitate data exchange between documents from different sites in the same domain.</td>
  </tr>
  <tr>
   <td><code>embeds</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMHTMLCollection">nsIDOMHTMLCollection</a></code></code></td>
   <td>Equivalent to getElementsByTagName(&quot;embed&quot;) <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>fgColor</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Same as <a href="/en/DOM/HTMLBodyElement#Properties">body.text</a></td>
  </tr>
  <tr>
   <td><code>head</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMHTMLHeadElement">nsIDOMHTMLHeadElement</a></code></code></td>
   <td>Returns the first child element of the HTML element that is a HEAD element, or null if there is no HTML or HEAD element. <strong>Read only.</strong> </td>
  </tr>
  <tr>
   <td><code>height</code></td>
   <td><code><a href="/en/long">long</a></code></td>
   <td>The height of the body element. <strong>Read only.</strong> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 6.0 / Thunderbird 6.0 / SeaMonkey 2.3)">Obsolete since Gecko 6.0</span></td>
  </tr>
  <tr>
   <td><code>linkColor</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Same as <a href="/en/DOM/HTMLBodyElement#Properties">body.link</a></td>
  </tr>
  <tr>
   <td><code>plugins</code></td>
   <td><code><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIDOMHTMLCollection">nsIDOMHTMLCollection</a></code></code></td>
   <td>Same as embeds for compatibility with Netscape 4.x <strong>Read only.</strong></td>
  </tr>
  <tr>
   <td><code>vlinkColor</code></td>
   <td><code><a href="/en/DOMString">DOMString</a></code></td>
   <td>Same as <a href="/en/DOM/HTMLBodyElement#Properties">body.vLink</a></td>
  </tr>
  <tr>
   <td><code>width</code></td>
   <td><code><a href="/en/long">long</a></code></td>
   <td>The width of the body element. <strong>Read only.</strong> <span class="obsolete obsoleteInline notecard inline" title="(Firefox 6.0 / Thunderbird 6.0 / SeaMonkey 2.3)">Obsolete since Gecko 6.0</span></td>
  </tr>
 </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="captureEvents()" name="captureEvents()">captureEvents()</h3>
<p>Provided for compatibility with Netscape 4.x, but does not actually do anything.</p>
<pre class="eval">void captureEvents(
  in long eventFlags
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>eventFlags</code></dt>
 <dd>
   </dd>
</dl>
<h3 id="clear()" name="clear()">clear()</h3>
<p>Used to reset a document to blank, but deprecated since Gecko 1.0 and provided for compatibility with Netscape 4.x; use open() and close() instead.</p>
<pre class="eval">void clear();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h3 id="execCommand()" name="execCommand()">execCommand()</h3>
<pre class="eval">boolean execCommand(
  in DOMString commandID,
  in boolean doShowUI,
  in DOMString value
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command to execute. See <a href="/en/Rich-Text_Editing_in_Mozilla" title="Rich-Text Editing in Mozilla">Rich-Text Editing in Mozilla</a> for a list of supported commands.</dd>
 <dt>
  <code>doShowUI</code></dt>
 <dd>
  This is not implemented in Gecko.</dd>
 <dt>
  <code>value</code></dt>
 <dd>
  Some commands require an argument. You can pass <code>null</code> for those commands that do not need an argument.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p><code>true</code> if the command was recognized, <code>false</code> otherwise.</p>
<p></p><div class="headingWithIndicator">
        <h3 id="execCommandShowHelp()">execCommandShowHelp()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)</span>
        </div><p></p>
<p>This method never did anything but throw an exception, and was removed entirely in Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11).</p>
<pre class="eval">boolean execCommandShowHelp(
  in DOMString commandID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>This method is not supported and always throws an exception.</p>
<h3 id="getSelection()" name="getSelection()">getSelection()</h3>
<pre class="eval">DOMString getSelection();
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<p>None.</p>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The text of the current selection, the same as <code>window.getSelection.toString()</code>.</p>
<h3 id="open()" name="open()">open()</h3>
<pre class="eval">nsIDOMDocument open(
  in ACString aContentType,
  in boolean aReplace
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>aContentType</code></dt>
 <dd>
  The content type of the new document. If the type is not supported by the HTML content sink, trying to write to the document will probably throw.</dd>
 <dt>
  <code>aReplace</code></dt>
 <dd>
  Whether the document should replace the existing document in session history.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The new document.</p>
<h3 id="queryCommandEnabled()" name="queryCommandEnabled()">queryCommandEnabled()</h3>
<pre class="eval">boolean queryCommandEnabled(
  in DOMString commandID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command to query.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns <code>true</code> if the command is supported and enabled, <code>false</code> otherwise.</p>
<h3 id="queryCommandIndeterm()" name="queryCommandIndeterm()">queryCommandIndeterm()</h3>
<pre class="eval">boolean queryCommandIndeterm(
  in DOMString commandID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command to query.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>For stateful commands, returns <code>true</code> if the command is in an indeterminate state, <code>false</code> otherwise. For instance, if there is a selection and part of the selected text is bold, then then bold command is in an indeterminate state.</p>
<h3 id="queryCommandState()" name="queryCommandState()">queryCommandState()</h3>
<pre class="eval">boolean queryCommandState(
  in DOMString commandID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command to query.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>For stateful commands, returns <code>true</code> if the command has is active, <code>false</code> otherwise.</p>
<h3 id="queryCommandSupported()" name="queryCommandSupported()">queryCommandSupported()</h3>
<pre class="eval">boolean queryCommandSupported(
  in DOMString commandID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command to query.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Returns <code>true</code> if the command is supported on the current range, <code>false</code> otherwise.</p>
<p></p><div class="headingWithIndicator">
        <h3 id="queryCommandText()">queryCommandText()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11)</span>
        </div><p></p>
<p>This method never did anything but throw an exception, and was removed entirely in Gecko 14.0 (Firefox 14.0 / Thunderbird 14.0 / SeaMonkey 2.11).</p>
<pre class="eval">DOMString queryCommandText(
  in DOMString commandID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command to query.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>This method is not supported and always throws an exception.</p>
<h3 id="queryCommandValue()" name="queryCommandValue()">queryCommandValue()</h3>
<pre class="eval">DOMString queryCommandValue(
  in DOMString commandID
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>commandID</code></dt>
 <dd>
  The name of the command to query.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>The value of the command. For the <code>gethtml</code> command, the current selection is returned as an HTML source fragment.</p>
<h3 id="releaseEvents()" name="releaseEvents()">releaseEvents()</h3>
<p>Provided for compatibility with Netscape 4.x, but does not actually do anything.</p>
<pre class="eval">void releaseEvents(
  in long eventFlags
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>eventFlags</code></dt>
 <dd>
   </dd>
</dl>
<h3 id="routeEvent()" name="routeEvent()">routeEvent()</h3>
<p>Provided for compatibility with Netscape 4.x, but does not actually do anything.</p>
<pre class="eval">void routeEvent(
  in nsIDOMEvent evt
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>evt</code></dt>
 <dd>
   </dd>
</dl>
<p></p><div class="headingWithIndicator">
        <h3 id="write()">write()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span>
        </div><p></p>
<pre class="eval">void write(
  [optional] in DOMString text
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>text</code></dt>
 <dd>
  The string to write to the document.</dd>
</dl>
<p></p><div class="headingWithIndicator">
        <h3 id="writeln()">writeln()</h3>
        <span class="obsolete obsoleteMethod notecard inline">Obsolete since Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)</span>
        </div><p></p>
<pre class="eval">void writeln(
  [optional] in DOMString text
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl>
 <dt>
  <code>text</code></dt>
 <dd>
  The string to write to the document. A newline is automatically appended.</dd>
</dl>
<h2 id="Implemented_by" name="Implemented_by">Implemented by</h2>
<p>Classes that implement this interface:</p>
<ul>
 <li><code>nsHTMLDocument</code> class: <code><a href="https://dxr.mozilla.org/mozilla-central/source/content/html/document/src/nsHTMLDocument.h" rel="custom">content/html/document/src/nsHTMLDocument.h</a></code></li>
</ul>
