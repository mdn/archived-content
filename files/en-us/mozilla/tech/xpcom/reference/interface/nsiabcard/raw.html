<p>The <code>nsIAbCard</code> interface is used to represent and manipulate cards in the addressbook. Following a huge refactoring of the address book code, most of the documentation below <strong>is out of date.</strong> Properties aren't stored anymore on the card, except for a handful of them. Complex properties are expected to be accessed through a call to getProperty. See <a class="external" href="http://mxr.mozilla.org/comm-central/source//mailnews/addrbook/public/nsIAbCard.idl" title="http://mxr.mozilla.org/comm-central/source//mailnews/addrbook/public/nsIAbCard.idl">http://mxr.mozilla.org/comm-central/source//mailnews/addrbook/public/nsIAbCard.idl</a> for more details.</p>

<p>Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code></p>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>AString <a href="#getCardValue.28.29">getCardValue</a>(in string name)</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#setCardValue.28.29">setCardValue</a>(in string attrname, in AString value)</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#copy.28.29">copy</a>(in <a href="/en/nsIAbCard" title="en/nsIAbCard">nsIAbCard</a> srcCard)</code></td>
  </tr>
  <tr>
   <td><code>boolean <a href="#equals.28.29">equals</a>(in <a href="/en/nsIAbCard" title="en/nsIAbCard">nsIAbCard</a> card)</code></td>
  </tr>
  <tr>
   <td><code>string <a href="#convertToBase64EncodedXML.28.29">convertToBase64EncodedXML</a>()</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#convertToXMLPrintData.28.29">convertToXMLPrintData</a>()</code></td>
  </tr>
  <tr>
   <td><code>string <a href="#convertToEscapedVCard.28.29">convertToEscapedVCard</a>()</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#generateName.28.29">generateName</a>(in long aGenerateFormat,[optional] in <a href="/en/XPCOM_Interface_Reference/nsIStringBundle" title="en/XPCOM_Interface_Reference/nsIStringBundle">nsIStringBundle</a> aBundle)</code></td>
  </tr>
  <tr>
   <td><code>AString <a href="#generatePhoneticName.28.29">generatePhoneticName</a>(in boolean aLastNameFirst)</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>firstName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>lastName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>phoneticFirstName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>phoneticLastName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>displayName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>nickName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>primaryEmail</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>secondEmail</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workPhone</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homePhone</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>faxNumber</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>pagerNumber</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>cellularNumber</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workPhoneType</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homePhoneType</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>faxNumberType</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>pagerNumberType</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>cellularNumberType</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homeAddress</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homeAddress2</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homeCity</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homeState</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homeZipCode</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>homeCountry</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workAddress</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workAddress2</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workCity</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workState</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workZipCode</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>workCountry</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>jobTitle</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>department</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>company</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>aimScreenName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>anniversaryYear</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>anniversaryMonth</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>anniversaryDay</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>spouseName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>familyName</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>defaultAddress</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>category</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>webPage1</code></td>
   <td><code>AString</code></td>
   <td>Used for the contact's work web page</td>
  </tr>
  <tr>
   <td><code>webPage2</code></td>
   <td><code>AString</code></td>
   <td>Used for the contact's home web page</td>
  </tr>
  <tr>
   <td><code>birthYear</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>birthMonth</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>birthDay</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>custom1</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>custom2</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>custom3</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>custom4</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>notes</code></td>
   <td><code>AString</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>lastModifiedDate</code></td>
   <td><code>unsigned long</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>popularityIndex</code></td>
   <td><code>unsigned long</code></td>
   <td><code>popularityIndex</code> is bumped every time e-mail is sent to this recipient .</td>
  </tr>
  <tr>
   <td><code>preferMailFormat</code></td>
   <td><code>unsigned long</code></td>
   <td>Allowed values are stored in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIAbPreferMailFormat" title="">nsIAbPreferMailFormat</a></code>.</td>
  </tr>
  <tr>
   <td><code>isMailList</code></td>
   <td><code>boolean</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>mailListURI</code></td>
   <td><code>string</code></td>
   <td>If <code>isMailList</code> is <code>true</code> then <code>mailListURI</code> will contain the URI of the associated mailing list.</td>
  </tr>
  <tr>
   <td><code>allowRemoteContent</code></td>
   <td><code>boolean</code></td>
   <td>Allow remote content to be displayed in <a href="/en/HTML_mail" title="en/HTML_mail">HTML mail</a> received from this contact</td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="getCardValue.28.29" name="getCardValue.28.29">getCardValue()</h3>

<pre class="eval">AString getCardValue(in string name)
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>name</code></dt>
 <dd>The attribute you want the value for.</dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<dl>
 <dd>The value of the attribute asked for.</dd>
</dl>

<h3 id="setCardValue.28.29" name="setCardValue.28.29">setCardValue()</h3>

<pre class="eval">void setCardValue(in string attrname, in AString value)
</pre>

<h6 id="Parameters_2" name="Parameters_2">Parameters</h6>

<dl>
 <dt><code>attrname</code></dt>
 <dd>The attribute you want to set.</dd>
 <dt><code>value</code></dt>
 <dd>The value to set the attribute to.</dd>
</dl>

<h3 id="copy.28.29" name="copy.28.29">copy()</h3>

<p>This function will copy all values from one card to another.</p>

<pre class="eval">void copy(in nsIAbCard srcCard)
</pre>

<h6 id="Parameters_3" name="Parameters_3">Parameters</h6>

<dl>
 <dt><code>srcCard</code></dt>
 <dd>The source card to copy values from.</dd>
</dl>

<h3 id="equals.28.29" name="equals.28.29">equals()</h3>

<pre class="eval">boolean equals(in nsIAbCard card)
</pre>

<h6 id="Parameters_4" name="Parameters_4">Parameters</h6>

<dl>
 <dt><code>card</code></dt>
 <dd>The card you are comparing with.</dd>
</dl>

<h6 id="Return_value_2" name="Return_value_2">Return value</h6>

<dl>
 <dd><code>true</code> if the cards are the same.</dd>
</dl>

<p> </p>

<h3 id="convertToBase64EncodedXML.28.29" name="convertToBase64EncodedXML.28.29">convertToBase64EncodedXML()</h3>

<pre class="eval">string convertToBase64EncodedXML()
</pre>

<h6 id="Return_value_3" name="Return_value_3">Return value</h6>

<p> </p>

<h3 id="convertToXMLPrintData.28.29" name="convertToXMLPrintData.28.29">convertToXMLPrintData()</h3>

<pre class="eval">AString convertToXMLPrintData()
</pre>

<h6 id="Return_value_4" name="Return_value_4">Return value</h6>

<p> </p>

<h3 id="convertToEscapedVCard.28.29" name="convertToEscapedVCard.28.29">convertToEscapedVCard()</h3>

<pre class="eval">string convertToEscapedVCard()
</pre>

<h6 id="Return_value_5" name="Return_value_5">Return value</h6>

<h3 id="generateName.28.29" name="generateName.28.29">generateName()</h3>

<p>Generate a name from the card for display purposes. Using the firstName, lastName and the displayName. We allow the caller to cache the pref value, so we don't have to go to prefs every time.</p>

<pre class="eval">AString generateName(in long aGenerateFormat,[optional] in nsIStringBundle aBundle)
</pre>

<h6 id="Parameters_5" name="Parameters_5">Parameters</h6>

<dl>
 <dt><code>aGenerateFormat</code></dt>
 <dd>The format to present the name in:</dd>
 <dt><code>0</code></dt>
 <dd>Generated name is displayName</dd>
 <dt><code>1</code></dt>
 <dd>lastFirst, formatted following <code>lastFirstFormat</code> property in <a class="external" href="http://mxr.mozilla.org/thunderbird/source/mail/locales/en-US/chrome/messenger/addressbook/addressBook.properties">addressBook.properties</a>.</dd>
 <dd><code>2</code></dd>
 <dd>firstLast, formatted following <code>firstLastFormat</code> property in <a class="external" href="http://mxr.mozilla.org/thunderbird/source/mail/locales/en-US/chrome/messenger/addressbook/addressBook.properties">addressBook.properties</a>.</dd>
 <dt><code>aBundle</code></dt>
 <dd>An optional parameter that is a pointer to a string bundle that holds: <a class="external" href="http://mxr.mozilla.org/thunderbird/source/mail/locales/en-US/chrome/messenger/addressbook/addressBook.properties">addressBook.properties</a>. If this bundle is not supplied, then the function will obtain the bundle itself. If cached by the caller and supplied to this function, then performance will be improved over many calls.</dd>
</dl>

<h6 id="Return_value_6" name="Return_value_6">Return value</h6>

<dl>
 <dd>A string containing the generated name.</dd>
</dl>

<h3 id="generatePhoneticName.28.29" name="generatePhoneticName.28.29">generatePhoneticName()</h3>

<p>Generate a phonetic name from the card, using the firstName and lastName values.</p>

<pre class="eval">AString generatePhoneticName(in boolean aLastNameFirst)
</pre>

<h6 id="Parameters_6" name="Parameters_6">Parameters</h6>

<dl>
 <dt><code>aLastNameFirst</code></dt>
 <dd>Set to <code>true</code> to put the last name before the first.</dd>
</dl>

<h6 id="Return_value_7" name="Return_value_7">Return value</h6>

<dl>
 <dd>A string containing the generated phonetic name.</dd>
</dl>