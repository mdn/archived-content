<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/dom/base/nsISelectionPrivate.idl" rel="custom">dom/base/nsISelectionPrivate.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

Internal support for content selection handling.
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 35 (Firefox 35 / Thunderbird 35 / SeaMonkey 2.32)</span></div>
</div><p></p>

<p></p><div class="blockIndicator warning">
    <p><strong>Warning:</strong> <strong>The content of this article may be out of date.</strong> This page wasn't updated since the initial import in 2011. See the idl file linked above for up-to-date information.</p>
</div><p></p>

<h2 id="Method_overview" name="Method_overview">Method overview</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td><code>void <a href="#addSelectionListener()">addSelectionListener</a>(in nsISelectionListener newListener);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#endBatchChanges()">endBatchChanges</a>();</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#getCachedFrameOffset()">getCachedFrameOffset</a>(in nsIFrame aFrame, in PRInt32 inOffset, in nsPointRef aPoint);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>nsIEnumerator <a href="#getEnumerator()">getEnumerator</a>();</code></td>
  </tr>
  <tr>
   <td><code>nsFrameSelection <a href="#getFrameSelection()">getFrameSelection</a>();</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span> </td>
  </tr>
  <tr>
   <td><code>void <a href="#GetRangesForInterval()">GetRangesForInterval</a>(in nsIDOMNode beginNode, in PRInt32 beginOffset, in nsIDOMNode endNode, in PRInt32 endOffset, in PRBool allowAdjacent, out PRUint32 resultCount, [retval, array, size_is(resultCount)] out nsIDOMRange results);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="/en/XPCOM_Interface_Reference/nsISelectionPrivate#GetRangesForIntervalArray()" title="en/XPCOM_Interface_Reference/nsISelectionPrivate#GetRangesForIntervalArray()">GetRangesForIntervalArray</a>(in nsINode beginNode, in PRInt32 beginoffset, in nsINode endNode, in PRInt32 endOffset, in boolean allowAdjacent, in RangeArray results);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span> </td>
  </tr>
  <tr>
   <td><code>void <a href="#GetRangesForIntervalCOMArray()">GetRangesForIntervalCOMArray</a>(in nsIDOMNode beginNode, in PRInt32 beginOffset, in nsIDOMNode endNode, in PRInt32 endOffset, in PRBool allowAdjacent, in RangeArray results);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 12.0 / Thunderbird 12.0 / SeaMonkey 2.9)">Obsolete since Gecko 12.0</span></td>
  </tr>
  <tr>
   <td><code>long <a href="#getTableSelectionType()">getTableSelectionType</a>(in nsIDOMRange range);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#removeSelectionListener()">removeSelectionListener</a>(in nsISelectionListener listenerToRemove);</code></td>
  </tr>
  <tr>
   <td><code>void <a href="#scrollIntoView()">scrollIntoView</a>(in short aRegion, in boolean aIsSynchronous, in short aVPercent, in short aHPercent);</code> </td>
  </tr>
  <tr>
   <td><code>void <a href="#setAncestorLimiter()">setAncestorLimiter</a>(in nsIContent aContent);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span> </td>
  </tr>
  <tr>
   <td><code>void <a href="#setPresShell()">setPresShell</a>(in nsIPresShell aPresShell);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></td>
  </tr>
  <tr>
   <td><code>void <a href="#setTextRangeStyle()">setTextRangeStyle</a>(in nsIDOMRange range, in constTextRangeStyleRef textRangeStyle);</code> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span> </td>
  </tr>
  <tr>
   <td><code>void <a href="#startBatchChanges()">startBatchChanges</a>();</code></td>
  </tr>
  <tr>
   <td><code>wstring <a href="#toStringWithFormat()">toStringWithFormat</a>(in string formatType, in unsigned long flags, in PRInt32 wrapColumn);</code></td>
  </tr>
 </tbody>
</table>

<h2 id="Attributes" name="Attributes">Attributes</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Attribute</td>
   <td class="header">Type</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>canCacheFrameOffset</code></td>
   <td><a href="/en/boolean" title="en/boolean">boolean</a></td>
   <td>
    <p>Frame Offset cache can be used just during calling nsEditor::EndPlaceHolderTransaction.</p>

    <p>EndPlaceHolderTransaction will give rise to reflow/refreshing view/scroll, and call times of nsTextFrame::GetPointFromOffset whose return value is to be cached. See <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=35296" title="FIXED: SetCaretEnabled() takes too long.">bug 35296</a> and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=199412" title="FIXED: optimize nsTypedSelection::ScrollIntoView()">bug 199412</a> <span class="inlineIndicator noscript noscriptInline" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span></p>
   </td>
  </tr>
  <tr>
   <td><code>interlinePosition</code></td>
   <td><a href="/en/boolean" title="en/boolean">boolean</a></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>type</code></td>
   <td><code><a href="/en/short" title="en/short">short</a></code></td>
   <td>Returns the <code>type</code> of the selection (see <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelectionController" title="">nsISelectionController</a></code> for available constants). <strong>Read only.</strong> </td>
  </tr>
 </tbody>
</table>

<h2 id="Constants" name="Constants">Constants</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <td class="header">Constant</td>
   <td class="header">Value</td>
   <td class="header">Description</td>
  </tr>
  <tr>
   <td><code>ENDOFPRECEDINGLINE</code></td>
   <td><code>0</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>STARTOFNEXTLINE</code></td>
   <td><code>1</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>TABLESELECTION_NONE</code></td>
   <td><code>0</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>TABLESELECTION_CELL</code></td>
   <td><code>1</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>TABLESELECTION_ROW</code></td>
   <td><code>2</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>TABLESELECTION_COLUMN</code></td>
   <td><code>3</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>TABLESELECTION_TABLE</code></td>
   <td><code>4</code></td>
   <td> </td>
  </tr>
  <tr>
   <td><code>TABLESELECTION_ALLCELLS</code></td>
   <td><code>5</code></td>
   <td> </td>
  </tr>
 </tbody>
</table>

<h2 id="Methods" name="Methods">Methods</h2>

<h3 id="addSelectionListener()" name="addSelectionListener()">addSelectionListener()</h3>

<pre class="eval">void addSelectionListener(
  in nsISelectionListener newListener
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>newListener</code></dt>
 <dd> </dd>
</dl>

<h3 id="endBatchChanges()" name="endBatchChanges()">endBatchChanges()</h3>

<p>Will resume User Interface updates after a previous call to <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelectionPrivate#startBatchChanges()">startBatchChanges()</a></code>.</p>

<pre class="eval">void endBatchChanges();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="getCachedFrameOffset">getCachedFrameOffset</h3></div><p></p>

<p>Returns cached value for nsTextFrame::GetPointFromOffset.</p>

<pre class="eval">void getCachedFrameOffset(
  in nsIFrame aFrame,
  in PRInt32 inOffset,
  in nsPointRef aPoint
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aFrame</code></dt>
 <dd> </dd>
 <dt><code>inOffset</code></dt>
 <dd> </dd>
 <dt><code>aPoint</code></dt>
 <dd> </dd>
</dl>

<h3 id="getEnumerator()" name="getEnumerator()">getEnumerator()</h3>

<pre class="eval">nsIEnumerator getEnumerator();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p> </p>

<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="getFrameSelection">getFrameSelection</h3></div><p></p>

<p></p>

<pre class="eval">nsFrameSelection getFrameSelection();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>A reference to the frame selection associated with this selection.</p>

<h3 id="GetRangesForInterval()" name="GetRangesForInterval()">GetRangesForInterval()</h3>

<p>Return array of ranges intersecting with the given DOM interval.</p>

<pre class="eval">void GetRangesForInterval(
  in nsIDOMNode beginNode,
  in PRInt32 beginOffset,
  in nsIDOMNode endNode,
  in PRInt32 endOffset,
  in PRBool allowAdjacent,
  out PRUint32 resultCount,
  [retval, array, size_is(resultCount)] out nsIDOMRange results
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>beginNode</code></dt>
 <dd> </dd>
 <dt><code>beginOffset</code></dt>
 <dd> </dd>
 <dt><code>endNode</code></dt>
 <dd> </dd>
 <dt><code>endOffset</code></dt>
 <dd>These four parameters represent the range to compare against the selection.</dd>
 <dt><code>allowAdjacent</code></dt>
 <dd>Specifies whether the returned ranges are allowed to touch the input range rather than merely overlapping it.</dd>
 <dt><code>resultCount</code></dt>
 <dd>Returns the number of ranges that overlap (or touch) the input range.</dd>
 <dt><code>results</code></dt>
 <dd>Returns the ranges that overlap (or touch) the input range.</dd>
</dl>

<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="GetRangesForIntervalCOMArray">GetRangesForIntervalCOMArray</h3></div><p></p>

<p></p><div class="blockIndicator obsolete obsoleteHeader"><p><strong><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span> Obsolete since Gecko 12.0 (Firefox 12.0 / Thunderbird 12.0 / SeaMonkey 2.9)</strong><br>This feature is obsolete. Although it may still work in some browsers, its use is discouraged since it could be removed at any time. Try to avoid using it.</p></div><p></p>

<p>This method became obsolete in Gecko 12.0 (Firefox 12.0 / Thunderbird 12.0 / SeaMonkey 2.9). Use <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelectionPrivate#GetRangesForIntervalArray()">GetRangesForIntervalArray()</a></code> instead.</p>

<pre class="eval">void GetRangesForIntervalCOMArray(
  in nsIDOMNode beginNode,
  in PRInt32 beginOffset,
  in nsIDOMNode endNode,
  in PRInt32 endOffset,
  in PRBool allowAdjacent,
  in RangeArray results
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>beginNode</code></dt>
 <dd> </dd>
 <dt><code>beginOffset</code></dt>
 <dd> </dd>
 <dt><code>endNode</code></dt>
 <dd> </dd>
 <dt><code>endOffset</code></dt>
 <dd>These four parameters represent the range to compare against the selection.</dd>
 <dt><code>allowAdjacent</code></dt>
 <dd>Specifies whether the returned ranges are allowed to touch the input range rather than merely overlapping it.</dd>
 <dt><code>results</code></dt>
 <dd>Returns the ranges that overlap (or touch) the input range.</dd>
</dl>

<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="GetRangesForIntervalArray">GetRangesForIntervalArray</h3></div><p></p>

<p></p>

<pre>void GetRangesForIntervalArray(
  in nsINode beginNode,
  in PRInt32 beginoffset,
  in nsINode endNode,
  in PRInt32 endOffset,
  in boolean allowAdjacent,
  in RangeArray results
);</pre>

<h6 id="Parameters_2">Parameters</h6>

<dl>
 <dt><code>beginNode</code></dt>
 <dd> </dd>
 <dt><code>beginOffset</code></dt>
 <dd> </dd>
 <dt><code>endNode</code></dt>
 <dd> </dd>
 <dt><code>endOffset</code></dt>
 <dd>These four parameters represent the range to compare against the selection.</dd>
 <dt><code>allowAdjacent</code></dt>
 <dd>Specifies whether the returned ranges are allowed to touch the input range rather than merely overlapping it.</dd>
 <dt><code>results</code></dt>
 <dd>Returns the ranges that overlap (or touch) the input range.</dd>
</dl>

<h3 id="getTableSelectionType()" name="getTableSelectionType()">getTableSelectionType()</h3>

<p>Test if supplied range points to a single table element.</p>

<pre class="eval">long getTableSelectionType(
  in nsIDOMRange range
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>range</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>

<p>One of <code>TABLESELECTION_*</code> <a href="#constants">constants</a>. "None" means a table element is not selected.</p>

<p> </p>

<h3 id="removeSelectionListener()" name="removeSelectionListener()">removeSelectionListener()</h3>

<pre class="eval">void removeSelectionListener(
  in nsISelectionListener listenerToRemove
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>listenerToRemove</code></dt>
 <dd> </dd>
</dl>

<p></p><h3 id="scrollIntoView()">scrollIntoView()</h3><p></p>

<p>Scrolls a region of the selection, so that it is visible in the scrolled view.</p>

<pre class="eval">void scrollIntoView(
  in short aRegion,
  in boolean aIsSynchronous,
  in short aVPercent,
  in short aHPercent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aRegion</code></dt>
 <dd>The region inside the selection to scroll into view (see selection region constants defined in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelectionController" title="">nsISelectionController</a></code>).</dd>
 <dt><code>aIsSynchronous</code></dt>
 <dd>When <code>true</code>, scrolls the selection into view before returning. If <code>false</code>, posts a request which is processed at some point after the method returns.</dd>
 <dt><code>aVPercent</code></dt>
 <dd>How to align the frame vertically. A value of 0 means the frame's upper edge is aligned with the top edge of the visible area. A value of 100 means the frame's bottom edge is aligned with the bottom edge of the visible area. For values in between, the point "aVPercent" down the frame is placed at the point "aVPercent" down the visible area. A value of 50 centers the frame vertically. A value of -1 means move the frame the minimum amount necessary in order for the entire frame to be visible vertically (if possible).</dd>
 <dt><code>aHPercent</code></dt>
 <dd>How to align the frame horizontally. A value of 0 means the frame's left edge is aligned with the left edge of the visible area. A value of 100 means the frame's right edge is aligned with the right edge of the visible area. For values in between, the point "aHPercent" across the frame is placed at the point "aHPercent" across the visible area. A value of 50 centers the frame horizontally . A value of -1 means move the frame the minimum amount necessary in order for the entire frame to be visible horizontally (if possible).</dd>
</dl>

<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="setAncestorLimiter">setAncestorLimiter</h3></div><p></p>

<p></p>

<pre class="eval">void setAncestorLimiter(
  in nsIContent aContent
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aContent</code></dt>
 <dd> </dd>
</dl>

<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="setPresShell">setPresShell</h3></div><p></p>

<p>Internal utility method to set the pres shell on a newly created selection.</p>

<pre class="eval">void setPresShell(
  in nsIPresShell aPresShell
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>aPresShell</code></dt>
 <dd> </dd>
</dl>

<p></p><div><span class="indicatorInHeadline noscript noscriptMethod" title="This method may only be called from C++; don't use it from JavaScript.">Native code only!</span><h3 id="setTextRangeStyle">setTextRangeStyle</h3></div><p></p>

<p></p>

<p>Set the painting style for the range. The range must be a range in the selection. The textRangeStyle will be used by text frame when it is painting the selection.</p>

<pre class="eval">void setTextRangeStyle(
  in nsIDOMRange range,
  in constTextRangeStyleRef textRangeStyle
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>range</code></dt>
 <dd> </dd>
 <dt><code>textRangeStyle</code></dt>
 <dd> </dd>
</dl>

<h3 id="startBatchChanges()" name="startBatchChanges()">startBatchChanges()</h3>

<p>Will stop User Interface updates while multiple selection methods are called. Call <code><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISelectionPrivate#endBatchChanges()">endBatchChanges()</a></code> to resume User Interface updates.</p>

<pre class="eval">void startBatchChanges();
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<p>None.</p>

<h3 id="toStringWithFormat()" name="toStringWithFormat()">toStringWithFormat()</h3>

<pre class="eval">wstring toStringWithFormat(
  in string formatType,
  in unsigned long flags,
  in PRInt32 wrapColumn
);
</pre>

<h6 id="Parameters" name="Parameters">Parameters</h6>

<dl>
 <dt><code>formatType</code></dt>
 <dd> </dd>
 <dt><code>flags</code></dt>
 <dd> </dd>
 <dt><code>wrapColumn</code></dt>
 <dd> </dd>
</dl>

<h6 id="Return_value" name="Return_value">Return value</h6>