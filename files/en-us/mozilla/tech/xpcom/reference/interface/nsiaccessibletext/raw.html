<p></p><div style="border: solid #ddd 2px; margin-bottom: 12px;">
<div style="background: #eee; padding: 2px;"><code><a href="https://dxr.mozilla.org/mozilla-central/source/accessible/public/nsIAccessibleText.idl" rel="custom">accessible/public/nsIAccessibleText.idl</a></code><span style="text-align: right; float: right;"><a href="/en-US/docs/Interfaces/About_Scriptable_Interfaces" style="color: #00cc00; font-weight: 700;">Scriptable</a></span></div>
<span style="padding: 4px 2px;">

<i>Please add a summary to this article.</i>
</span>

<div style="background: #eee; padding: 2px;">
Inherits from: <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsISupports" title="">nsISupports</a></code>
<span style="text-align: right; float: right;">Last changed in Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span></div>
</div><p></p>
<h2 id="Method_overview" name="Method_overview">Method overview</h2>
<table class="standard-table"> <tbody> <tr> <td><code>void <a href="#addSelection()">addSelection</a>(in long startOffset, in long endOffset);</code></td> </tr> <tr> <td><code>nsIAccessible <a href="#getAttributeRange()">getAttributeRange</a>(in long offset, out long rangeStartOffset, out long rangeEndOffset);</code> <span class="inlineIndicator obsolete obsoleteInline" title="(Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)">Obsolete since Gecko 1.9.1</span></td> </tr> <tr> <td><code>wchar <a href="#getCharacterAtOffset()">getCharacterAtOffset</a>(in long offset);</code></td> </tr> <tr> <td><code>void <a href="#getCharacterExtents()">getCharacterExtents</a>(in long offset, out long x, out long y, out long width, out long height, in unsigned long coordType);</code></td> </tr> <tr> <td><code>long <a href="#getOffsetAtPoint()">getOffsetAtPoint</a>(in long x, in long y, in unsigned long coordType);</code></td> </tr> <tr> <td><code>void <a href="#getRangeExtents()">getRangeExtents</a>(in long startOffset, in long endOffset, out long x, out long y, out long width, out long height, in unsigned long coordType);</code> </td> </tr> <tr> <td><code>void <a href="#getSelectionBounds()">getSelectionBounds</a>(in long selectionNum, out long startOffset, out long endOffset);</code></td> </tr> <tr> <td><code>AString <a href="#getText()">getText</a>(in long startOffset, in long endOffset);</code></td> </tr> <tr> <td><code>AString <a href="#getTextAfterOffset()">getTextAfterOffset</a>(in long offset, in nsAccessibleTextBoundary boundaryType, out long startOffset, out long endOffset);</code></td> </tr> <tr> <td><code>AString <a href="#getTextAtOffset()">getTextAtOffset</a>(in long offset, in nsAccessibleTextBoundary boundaryType, out long startOffset, out long endOffset);</code></td> </tr> <tr> <td><code>nsIPersistentProperties <a href="#getTextAttributes()">getTextAttributes</a>(in boolean includeDefAttrs, in long offset, out long rangeStartOffset, out long rangeEndOffset);</code> </td> </tr> <tr> <td><code>AString <a href="#getTextBeforeOffset()">getTextBeforeOffset</a>(in long offset, in nsAccessibleTextBoundary boundaryType, out long startOffset, out long endOffset);</code></td> </tr> <tr> <td><code>void <a href="#removeSelection()">removeSelection</a>(in long selectionNum);</code></td> </tr> <tr> <td><code>void <a href="#scrollSubstringTo()">scrollSubstringTo</a>(in long startIndex, in long endIndex, in unsigned long scrollType);</code> </td> </tr> <tr> <td><code>void <a href="#scrollSubstringToPoint()">scrollSubstringToPoint</a>(in long startIndex, in long endIndex, in unsigned long coordinateType, in long x, in long y);</code> </td> </tr> <tr> <td><code>void <a href="#setSelectionBounds()">setSelectionBounds</a>(in long selectionNum, in long startOffset, in long endOffset);</code></td> </tr> </tbody>
</table>
<h2 id="Attributes" name="Attributes">Attributes</h2>
<table class="standard-table"> <tbody> <tr> <td class="header">Attribute</td> <td class="header">Type</td> <td class="header">Description</td> </tr> <tr> <td><code>caretOffset</code></td> <td><code><a href="/en/long" title="en/long">long</a></code></td> <td>The current current caret offset. If set &lt; 0 then caret will be placed at the end of the text.</td> </tr> <tr> <td><code>characterCount</code></td> <td><code><a href="/en/long" title="en/long">long</a></code></td> <td><strong>Read only.</strong></td> </tr> <tr> <td><code>defaultTextAttributes</code></td> <td><code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIPersistentProperties" title="">nsIPersistentProperties</a></code></td> <td>Return the text attributes that apply to the entire accessible. <strong>Read only.</strong> </td> </tr> <tr> <td><code>selectionCount</code></td> <td><code><a href="/en/long" title="en/long">long</a></code></td> <td><strong>Read only.</strong></td> </tr> </tbody>
</table>
<h2 id="Constants" name="Constants">Constants</h2>
<h3 id="Text_Offset_Constants">Text Offset Constants</h3>
<p></p>
<table class="standard-table"> <tbody> <tr> <td class="header">Constant</td> <td class="header">Value</td> <td class="header">Description</td> </tr> <tr> <td><code>TEXT_OFFSET_END_OF_TEXT</code></td> <td><code>-1</code></td> <td>Will be treated as the equal to the end of the text.</td> </tr> <tr> <td><code>TEXT_OFFSET_CARET</code></td> <td><code>-2</code></td> <td>Will be treated as the caret position.</td> </tr> </tbody>
</table>
<h3 id="Text_Boundary_Constants">Text Boundary Constants</h3>
<table class="standard-table"> <tbody> <tr> <td class="header">Constant</td> <td class="header">Value</td> <td class="header">Description</td> </tr> <tr> <td><code>BOUNDARY_CHAR</code></td> <td><code>0</code></td> <td> </td> </tr> <tr> <td><code>BOUNDARY_WORD_START</code></td> <td><code>1</code></td> <td> </td> </tr> <tr> <td><code>BOUNDARY_WORD_END</code></td> <td><code>2</code></td> <td> </td> </tr> <tr> <td><code>BOUNDARY_SENTENCE_START</code></td> <td><code>3</code></td> <td>Do not use in new code. <span title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></td> </tr> <tr> <td><code>BOUNDARY_SENTENCE_END</code></td> <td><code>4</code></td> <td>Do not use in new code. <span title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></td> </tr> <tr> <td><code>BOUNDARY_LINE_START</code></td> <td><code>5</code></td> <td> </td> </tr> <tr> <td><code>BOUNDARY_LINE_END</code></td> <td><code>6</code></td> <td> </td> </tr> <tr> <td><code>BOUNDARY_ATTRIBUTE_RANGE</code></td> <td><code>7</code></td> <td> </td> </tr> </tbody>
</table>
<h3 id="Coordinate_Type_Constants">Coordinate Type Constants</h3>
<p></p><div class="blockIndicator obsolete obsoleteHeader"><p><strong><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span> Obsolete since Gecko 1.9 (Firefox 3)</strong><br>This feature is obsolete. Although it may still work in some browsers, its use is discouraged since it could be removed at any time. Try to avoid using it.</p></div><p></p>
<table class="standard-table"> <tbody> <tr> <td class="header">Constant</td> <td class="header">Value</td> <td class="header">Description</td> </tr> <tr> <td><code>COORD_TYPE_SCREEN</code></td> <td><code>0</code></td> <td> </td> </tr> <tr> <td><code>COORD_TYPE_WINDOW</code></td> <td><code>1</code></td> <td> </td> </tr> </tbody>
</table>
<h2 id="Methods" name="Methods">Methods</h2>
<h3 id="addSelection()" name="addSelection()">addSelection()</h3>
<pre class="eval">void addSelection(
  in long startOffset,
  in long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startOffset</code></dt> <dd> </dd><dt><code>endOffset</code></dt> <dd>
</dd></dl>
<p></p><div class="headingWithIndicator">
        <h3 id="getAttributeRange()">getAttributeRange()</h3>
        <span class="indicatorInHeadline obsolete obsoleteMethod">Obsolete since Gecko 1.9.1 (Firefox 3.5 / Thunderbird 3.0 / SeaMonkey 2.0)</span>
        </div><p></p>
<p>Get the accessible and start/end offsets around the given offset. This accessible get return the DOM node and layout frame with the uniform attributes for this range of text.</p>
<pre class="eval">nsIAccessible getAttributeRange(
  in long offset,
  out long rangeStartOffset,
  out long rangeEndOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd> </dd><dt><code>rangeStartOffset</code></dt> <dd> </dd><dt><code>rangeEndOffset</code></dt> <dd>
</dd></dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p> </p>
<h3 id="getCharacterAtOffset()" name="getCharacterAtOffset()">getCharacterAtOffset()</h3>
<p>It would be better to return an unsigned long here, to allow unicode chars &gt; 16 bits.</p>
<pre class="eval">wchar getCharacterAtOffset(
  in long offset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>
</dd></dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p> </p>
<h3 id="getCharacterExtents()" name="getCharacterExtents()">getCharacterExtents()</h3>
<p>Returns the bounding box of the specified position.</p>
<p>The virtual character after the last character of the represented text, that is the one at position length is a special case. It represents the current input position and will therefore typically be queried by AT more often than other positions. Because it does not represent an existing character its bounding box is defined in relation to preceding characters. It should be roughly equivalent to the bounding box of some character when inserted at the end of the text. Its height typically being the maximal height of all the characters in the text or the height of the preceding character, its width being at least one pixel so that the bounding box is not degenerate.</p>
<pre class="eval">void getCharacterExtents(
  in long offset,
  out long x,
  out long y,
  out long width,
  out long height,
  in unsigned long coordType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd>Index of the character for which to return its bounding box. The valid range is 0..length.</dd> <dt><code>x</code></dt> <dd>X coordinate of the bounding box of the referenced character.</dd> <dt><code>y</code></dt> <dd>Y coordinate of the bounding box of the referenced character.</dd> <dt><code>width</code></dt> <dd>Width of the bounding box of the referenced character.</dd> <dt><code>height</code></dt> <dd>Height of the bounding box of the referenced character.</dd> <dt><code>coordType</code></dt> <dd>Specifies if the coordinates are relative to the screen or to the parent window (see constants declared in <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessibleCoordinateType#Constants">nsIAccessibleCoordinateType.Constants</a></code>).</dd>
</dl>
<h3 id="getOffsetAtPoint()" name="getOffsetAtPoint()">getOffsetAtPoint()</h3>
<p>Get the text offset at the given point, or return -1 if no character exists at that point.</p>
<pre class="eval">long getOffsetAtPoint(
  in long x,
  in long y,
  in unsigned long coordType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>x</code></dt> <dd>The position's x value for which to look up the index of the character that is rendered on to the display at that point.</dd> <dt><code>y</code></dt> <dd>The position's y value for which to look up the index of the character that is rendered on to the display at that point.</dd> <dt><code>coordType</code></dt> <dd>Screen coordinates or window coordinates (see constants declared in <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIAccessibleCoordinateType" title="">nsIAccessibleCoordinateType</a></code>).</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p>Offset - Index of the character under the given point or -1 if the point is invalid or there is no character under the point.</p>
<p></p><h3 id="getRangeExtents()">getRangeExtents()</h3><p></p>
<p>The virtual character after the last character of the represented text, that is the one at position length is a special case. It represents the current input position and will therefore typically be queried by AT more often than other positions. Because it does not represent an existing character its bounding box is defined in relation to preceding characters. It should be roughly equivalent to the bounding box of some character when inserted at the end of the text. Its height typically being the maximal height of all the characters in the text or the height of the preceding character, its width being at least one pixel so that the bounding box is not degenerate.</p>
<pre class="eval">void getRangeExtents(
  in long startOffset,
  in long endOffset,
  out long x,
  out long y,
  out long width,
  out long height,
  in unsigned long coordType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startOffset</code></dt> <dd>Index of the character for which to return its bounding box. The valid range is 0..length.</dd> <dt><code>endOffset</code></dt> <dd>Index of the character for which to return its bounding box. The valid range is 0..length.</dd> <dt><code>x</code></dt> <dd>X coordinate of the bounding box of the referenced character.</dd> <dt><code>y</code></dt> <dd>Y coordinate of the bounding box of the referenced character.</dd> <dt><code>width</code></dt> <dd>Width of the bounding box of the referenced character.</dd> <dt><code>height</code></dt> <dd>Height of the bounding box of the referenced character.</dd> <dt><code>coordType</code></dt> <dd>Specifies if the coordinates are relative to the screen or to the parent window (see constants declared in <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessibleCoordinateType#Constants">nsIAccessibleCoordinateType.Constants</a></code>.</dd>
</dl>
<h3 id="getSelectionBounds()" name="getSelectionBounds()">getSelectionBounds()</h3>
<pre class="eval">void getSelectionBounds(
  in long selectionNum,
  out long startOffset,
  out long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>selectionNum</code></dt> <dd> </dd><dt><code>startOffset</code></dt> <dd> </dd><dt><code>endOffset</code></dt> <dd>
</dd></dl>
<h3 id="getText()" name="getText()">getText()</h3>
<p>String methods may need to return multibyte-encoded strings, since some locales can not be encoded using 16-bit chars. So this method might return UTF-16 strings, or it could return "string" values which are UTF-8.</p>
<pre class="eval">AString getText(
  in long startOffset,
  in long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startOffset</code></dt> <dd> </dd><dt><code>endOffset</code></dt> <dd>
</dd></dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p> </p>
<h3 id="getTextAfterOffset()" name="getTextAfterOffset()">getTextAfterOffset()</h3>
<p>String methods may need to return multibyte-encoded strings, since some locales can't be encoded using 16-bit chars. So this method might return UTF-16 strings, or it could return "string" values which are UTF-8.</p>
<pre class="eval">AString getTextAfterOffset(
  in long offset,
  in nsAccessibleTextBoundary boundaryType,
  out long startOffset,
  out long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd> </dd><dt><code>boundaryType</code></dt> <dd> </dd><dt><code>startOffset</code></dt> <dd> </dd><dt><code>endOffset</code></dt> <dd>
</dd></dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p> </p>
<h3 id="getTextAtOffset()" name="getTextAtOffset()">getTextAtOffset()</h3>
<p>String methods may need to return multibyte-encoded strings, since some locales can't be encoded using 16-bit chars. So this method might return UTF-16 strings, or it could return "string" values which are UTF-8.</p>
<pre class="eval">AString getTextAtOffset(
  in long offset,
  in nsAccessibleTextBoundary boundaryType,
  out long startOffset,
  out long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd> </dd><dt><code>boundaryType</code></dt> <dd> </dd><dt><code>startOffset</code></dt> <dd> </dd><dt><code>endOffset</code></dt> <dd>
</dd></dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p> </p>
<p></p><h3 id="getTextAttributes()">getTextAttributes()</h3><p></p>
<p>Get the accessible start/end offsets around the given offset, return the text attributes for this range of text.</p>
<pre class="eval">nsIPersistentProperties getTextAttributes(
  in boolean includeDefAttrs,
  in long offset,
  out long rangeStartOffset,
  out long rangeEndOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>includeDefAttrs</code></dt> <dd>Points whether text attributes applied to the entire accessible should be included or not.</dd> <dt><code>offset</code></dt> <dd>Text offset.</dd> <dt><code>rangeStartOffset</code></dt> <dd>Start offset of the range of text.</dd> <dt><code>rangeEndOffset</code></dt> <dd>End offset of the range of text.</dd>
</dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p> </p>
<h6 id="Exceptions_thrown" name="Exceptions_thrown">Exceptions thrown</h6>
<dl> <dt><code>Missing Exception</code></dt> <dd>
</dd></dl>
<h3 id="getTextBeforeOffset()" name="getTextBeforeOffset()">getTextBeforeOffset()</h3>
<p>String methods may need to return multibyte-encoded strings, since some locales can't be encoded using 16-bit chars. So this method might return UTF-16 strings, or it could return "string" values which are UTF-8.</p>
<pre class="eval">AString getTextBeforeOffset(
  in long offset,
  in nsAccessibleTextBoundary boundaryType,
  out long startOffset,
  out long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>offset</code></dt> <dd> </dd><dt><code>boundaryType</code></dt> <dd> </dd><dt><code>startOffset</code></dt> <dd> </dd><dt><code>endOffset</code></dt> <dd>
</dd></dl>
<h6 id="Return_value" name="Return_value">Return value</h6>
<p> </p>
<h3 id="removeSelection()" name="removeSelection()">removeSelection()</h3>
<pre class="eval">void removeSelection(
  in long selectionNum
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>selectionNum</code></dt> <dd>
</dd></dl>
<p></p><h3 id="scrollSubstringTo()">scrollSubstringTo()</h3><p></p>
<p>Makes a specific part of string visible on screen.</p>
<pre class="eval">void scrollSubstringTo(
  in long startIndex,
  in long endIndex,
  in unsigned long scrollType
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startIndex</code></dt> <dd>0-based character offset.</dd> <dt><code>endIndex</code></dt> <dd>0-based character offset - the offset of the character just past the last character of the string.</dd> <dt><code>scrollType</code></dt> <dd>Defines how to scroll (see <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessibleScrollType#Constants">nsIAccessibleScrollType.Constants</a></code> for available constants)</dd>
</dl>
<p></p><h3 id="scrollSubstringToPoint()">scrollSubstringToPoint()</h3><p></p>
<p>Moves the top left of a substring to a specified location.</p>
<pre class="eval">void scrollSubstringToPoint(
  in long startIndex,
  in long endIndex,
  in unsigned long coordinateType,
  in long x,
  in long y
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>startIndex</code></dt> <dd>0-based character offset.</dd> <dt><code>endIndex</code></dt> <dd>0-based character offset - the offset of the character just past the last character of the string.</dd> <dt><code>coordinateType</code></dt> <dd>Specifies the coordinates origin (for available constants refer to <code><a href="https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIAccessibleCoordinateType#Constants">nsIAccessibleCoordinateType.Constants</a></code>)</dd> <dt><code>x</code></dt> <dd>Defines the x coordinate.</dd> <dt><code>y</code></dt> <dd>Defines the y coordinate.</dd>
</dl>
<h3 id="setSelectionBounds()" name="setSelectionBounds()">setSelectionBounds()</h3>
<p>Set the bounds for the given selection range.</p>
<pre class="eval">void setSelectionBounds(
  in long selectionNum,
  in long startOffset,
  in long endOffset
);
</pre>
<h6 id="Parameters" name="Parameters">Parameters</h6>
<dl> <dt><code>selectionNum</code></dt> <dd> </dd><dt><code>startOffset</code></dt> <dd> </dd><dt><code>endOffset</code></dt> <dd>
</dd></dl>