---
title: nsIMsgFilter
slug: Mozilla/Tech/XPCOM/Reference/Interface/nsIMsgFilter
tags:
  - Interfaces
  - 'Interfaces:Scriptable'
  - XPCOM
  - XPCOM Interface Reference
  - thunderbird
---
<div class="pageText" id="pageText"> <p>Defined in <strong><a class="external" href="http://mxr.mozilla.org/comm-central/source/" rel="external" title="http://mxr.mozilla.org/comm-central/source/">comm-central</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/" rel="external" title="http://mxr.mozilla.org/comm-central/source/mailnews/">mailnews</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/" rel="external" title="http://mxr.mozilla.org/comm-central/source/mailnews/base/">base</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/" rel="external" title="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/">search</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/" rel="external" title="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/">public</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/nsIMsgFilter.idl" rel="external" title="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/nsIMsgFilter.idl">nsIMsgFilter.idl</a> </strong></p> <div id="section_1"> <h2 class="editable" id="Attributes">Attributes</h2> <div id="section_2"> <h4 class="editable" id="type">type</h4> <pre>attribute <a title="nsMsgRuleActionType">nsMsgRuleActionType</a> type;
</pre> </div> <div id="section_3"> <h4 class="editable" id="priority">priority</h4> <pre>// target priority.. throws an exception if the action is not priority
attribute <a title="nsMsgPriorityValue">nsMsgPriorityValue</a> priority;
</pre> </div> <div id="section_4"> <h4 class="editable" id="targetFolderUri">targetFolderUri</h4> <pre>// target folder.. throws an exception if the action is not move to folder
attribute ACString targetFolderUri;
</pre> </div> <div id="section_5"> <h4 class="editable" id="label">label</h4> <pre>// target label. throws an exception if the action is not label
attribute <a title="nsMsgLabelValue">nsMsgLabelValue</a> label;
</pre> </div> <div id="section_6"> <h4 class="editable" id="junkScore">junkScore</h4> <pre>attribute long junkScore;
</pre> </div> <div id="section_7"> <h4 class="editable" id="strValue">strValue</h4> <pre>attribute AUTF8String strValue;
</pre> </div> <div id="section_8"> <h4 class="editable" id="customId">customId</h4> <pre>// action id if type is Custom
attribute ACString customId;
</pre> </div> <div id="section_9"> <h4 class="editable" id="customAction">customAction</h4>
<pre class="dp-highlighter"><span class="comment">// custom action associated with customId</span>
<span class="comment">// (which must be set prior to reading this attribute)</span>
<span>readonly attribute <a title="nsIMsgFilterCustomAction">nsIMsgFilterCustomAction</a> customAction;  </span>
</pre></div> </div> <div id="section_10"> <h2 class="editable" id="Methods">Methods</h2> <div id="section_11"> <h4 class="editable" id="AddTerm()">AddTerm()</h4>
<pre class="eval">void <strong>nsIMsgFilter</strong>::AddTerm
(
    in <a class="new " href="/en/XPCOM_Interface_Reference/nsMsgSearchAttribValue" rel="internal" title="nsMsgSearchAttribValue">nsMsgSearchAttribValue</a>   attrib,
    in <a href="/en/XPCOM_Interface_Reference/nsMsgSearchOpValue" title="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsMsgSearchOpValue">nsMsgSearchOpValue</a>       op,
    in <a href="/en/XPCOM_Interface_Reference/nsIMsgSearchValue" title="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgSearchValue">nsIMsgSearchValue </a>       value,
    in boolean                  BooleanAND,
    in ACString                 arbitraryHeader
)
</pre>
</div> <div id="section_12"> <h4 class="editable" id="GetTerm()">GetTerm()</h4>
<pre class="eval">void <strong>nsIMsgFilter</strong>::GetTerm    (
    in long                     termIndex,
    in <a class="new " href="/en/XPCOM_Interface_Reference/nsMsgSearchAttribValue" rel="internal" title="nsMsgSearchAttribValue">nsMsgSearchAttribValue</a>   attrib,
    in <a href="/en/XPCOM_Interface_Reference/nsMsgSearchOpValue" title="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsMsgSearchOpValue">nsMsgSearchOpValue</a>       op,
    in <a href="nsIMsgSearchValue" rel="internal" title="https://developer.mozilla.org/en/XPCOM_Interface_Reference/nsIMsgSearchValue">nsIMsgSearchValue </a>       value,
    out boolean                 BooleanAND,
    out ACString                arbitraryHeader
)
</pre>
</div> <div id="section_13"> <h4 class="editable" id="appendTerm()">appendTerm()</h4>
<pre class="dp-highlighter">void nsIMsgFilter::appendTerm (in <a title="nsIMsgSearchTerm">nsIMsgSearchTerm</a> term)
</pre>
</div> <div id="section_14"> <h4 class="editable" id="createTerm()">createTerm()</h4> <pre><a title="nsIMsgSearchTerm">nsIMsgSearchTerm</a> nsIMsgFilter::createTerm ( )
</pre> </div> <div id="section_15"> <h4 class="editable" id="MatchHdr()">MatchHdr()</h4> <pre class="eval">void <strong>nsIMsgFilter</strong>::MatchHdr
(
    in <a href="nsIMsgDBHdr" rel="internal" title="nsIMsgDBHdr">nsIMsgDBHdr</a>    msgHdr,
    in <a href="nsIMsgFolder" rel="internal" title="nsIMsgFolder">nsIMsgFolder</a>   folder,
    in <a href="nsIMsgDatabase" rel="internal" title="nsIMsgDatabase">nsIMsgDatabase</a> db,
    in string         headers,
    in unsigned long  headerSize,
    out boolean       result
)
</pre> </div> <div id="section_16"> <h4 class="editable" id="logRuleHit()">logRuleHit()</h4> <pre class="eval">void <strong>nsIMsgFilter</strong>::logRuleHit
(
    in <a href="../../nsIMsgRuleAction" rel="internal" title="nsIMsgRuleAction">nsIMsgRuleAction</a>  aFilterAction,
    in <a href="nsIMsgDBHdr" rel="internal" title="nsIMsgDBHdr">nsIMsgDBHdr</a>       aHeader
)
</pre> </div> <div id="section_17"> <h4 class="editable" id="createAction()">createAction()</h4> <pre class="eval"><a href="../../nsIMsgRuleAction" rel="internal" title="nsIMsgRuleAction">nsIMsgRuleAction</a> nsIMsgFilter::createAction ( )
</pre> </div> <div id="section_18"> <h4 class="editable" id="getActionAt()">getActionAt()</h4> <pre class="eval"><a href="../../nsIMsgRuleAction" rel="internal" title="nsIMsgRuleAction">nsIMsgRuleAction</a> nsIMsgFilter::getActionAt (in long aIndex)
</pre> </div> <div id="section_19"> <h4 class="editable" id="appendAction()">appendAction()</h4> <pre class="eval">void <strong>nsIMsgFilter</strong>::appendAction (in <a href="../../nsIMsgRuleAction" rel="internal" title="nsIMsgRuleAction">nsIMsgRuleAction</a>  action )
</pre> </div> <div id="section_20"> <h4 class="editable" id="clearActionList()">clearActionList()</h4> <pre class="eval">void <strong>nsIMsgFilter</strong>::clearActionList()
</pre> </div> <div id="section_21"> <h4 class="editable" id="getSortedActionList()">getSortedActionList()</h4> <pre class="eval">void <strong>nsIMsgFilter</strong>::getSortedActionList (in <a href="nsISupportsArray" rel="internal" title="nsISupportsArray">nsISupportsArray</a> actionList)
</pre> </div> </div>
</div>
