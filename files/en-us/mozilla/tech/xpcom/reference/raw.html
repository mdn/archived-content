<p>This reference describes the interfaces and functions provided by the <a href="/en-US/docs/Mozilla/Tech/XPCOM">XPCOM</a> library. In addition, it details the various helper classes and functions, as well as the components, provided by the <a href="/en-US/docs/Mozilla/Tech/XPCOM/Glue">XPCOM glue</a> library. The contents herein are oriented primarily toward extension developers and people embedding XPCOM in other projects.</p>

<div class="warning">
<p><strong>WebExtensions are becoming the new standard for creating add-ons. </strong>Eventually support for XPCOM add-ons will be deprecated, so you should begin to investigate porting your add-ons to use the <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions">WebExtensions</a> API, and <a href="https://mzl.la/webext-feature-needed">report any missing functionality</a> so we can be sure to address your concerns. Work is ongoing on WebExtension capabilities, so your input will help prioritize and plan the work. To learn more about the kinds of changes that will be needed, see <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_XUL_XPCOM_extensions">Comparison with XUL/XPCOM extensions</a>. In addition, any binaries you use will then need to be converted for use with the WebExtensions <a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">native messaging</a> API, or compiled using <a href="https://webassembly.github.io/">WebAssembly</a> or <a href="/en-US/docs/Mozilla/Projects/Emscripten">Emscripten</a>.</p>
</div>

<div class="note">
<p>If you're working on a module in the Mozilla codebase that's compiled with the <code>MOZILLA_INTERNAL_API</code> flag set, some of these APIs -- the string functions and classes in particular -- are not the ones you should be using. See the <a href="/en-US/docs/Mozilla/Tech/XPCOM/Guide/Internal_strings">XPCOM internal string guide</a> for documentation of the internal string API used within the Mozilla codebase.</p>
</div>

<p></p><div class="row topicpage-table">
    <div class="section"><dl><dl><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Core_functions">Core XPCOM functions</a></dt><dd class="landingPageList">XPCOM provides a number of global functions which are used to initialize and shut down the XPCOM library, as well as to allocate memory, get access to services, and to instantiate interfaces.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Folders">Folders</a></dt><dd class="landingPageList">The folder classes all implement the <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/public/nsIMsgFolder.idl" title="http://mxr.mozilla.org/comm-central/source/mailnews/base/public/nsIMsgFolder.idl">nsIMsgFolder</a> interface. There are currently three folder classes - <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/local/src/nsLocalMailFolder.cpp" title="http://mxr.mozilla.org/comm-central/source/mailnews/local/src/nsLocalMailFolder.cpp">nsLocalMailFolder</a>, <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/imap/src/nsImapMailFolder.cpp" title="http://mxr.mozilla.org/comm-central/source/mailnews/imap/src/nsImapMailFolder.cpp">nsImapMailFolder</a>, and <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/news/src/nsNewsFolder.cpp" title="http://mxr.mozilla.org/comm-central/source/mailnews/news/src/nsNewsFolder.cpp">nsNewsFolder</a>. They all inherit from <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/util/nsMsgDBFolder.cpp" title="http://mxr.mozilla.org/comm-central/source/mailnews/base/util/nsMsgDBFolder.cpp">nsMsgDBFolder</a>, which implements a lot of the core functionality. RSS feeds are implemented by <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/local/src/nsLocalMailFolder.cpp" title="http://mxr.mozilla.org/comm-central/source/mailnews/local/src/nsLocalMailFolder.cpp">nsLocalMailFolder</a>.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_ENSURE_SUCCESS">NS ENSURE SUCCESS</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_ENSURE_TRUE">NS ENSURE TRUE</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_ABORT_IF_FALSE">NS_ABORT_IF_FALSE</a></dt><dd class="landingPageList">This was removed in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1127201">bug 1127201</a></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_ADDREF">NS_ADDREF</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_ASSERTION">NS_ASSERTION</a></dt><dd class="landingPageList"><strong>Macro</strong></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_ENSURE_ARG_POINTER">NS_ENSURE_ARG_POINTER</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_ERROR">NS_ERROR</a></dt><dd class="landingPageList">Throws a assertion (<code><a href="/en/NS_ASSERTION" title="en/NS_ASSERTION">NS_ASSERTION</a></code>) with the text "Error: (error text)", so writes this text to console (stderr) and to debug logs (NSPR logging). This macro is meant for critical errors; like assertions, <code>NS_ERROR</code>s should not be reachable.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_IF_ADDREF">NS_IF_ADDREF</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_IF_RELEASE">NS_IF_RELEASE</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_RELEASE">NS_RELEASE</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/NS_WARNING">NS_WARNING</a></dt><dd class="landingPageList"><b>Macro</b></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsGetModuleProc">nsGetModuleProc</a></dt><dd class="landingPageList">This function prototype provides the XPCOM entry-point into a module.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsIAbCard_(Tb3)">nsIAbCard/Thunderbird3</a></dt><dd class="landingPageList">The <code>nsIAbCard</code> interface is used to represent and manipulate cards in the address book. In a big change from the original <code>nsIAbCard</code>, properties are now stored in a hash table instead of as attributes on the interface, allowing it to be more flexible.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsICookie2_(Moz_1.8)">nsICookie2 MOZILLA 1 8 BRANCH</a></dt><dd class="landingPageList"></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/msIMsgSearchValue">nsIMsgSearchValue</a></dt><dd class="landingPageList">Defined in <strong><a class="external" href="http://mxr.mozilla.org/comm-central/source/">comm-central</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/">mailnews</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/">base</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/">search</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/">public</a>/ <a class="external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/nsIMsgSearchValue.idl">nsIMsgSearchValue.idl</a> </strong></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgMessagesFlags">nsMsgMessageFlags</a></dt><dd class="landingPageList">The <code>nsMsgMessageFlags</code> interface describes possible flags for messages. Equivalent flags are also defined in <a class="external" href="http://mxr.mozilla.org/mozilla/source/mailnews/base/public/nsMsgMessageFlags.h">nsMsgMessageFlags.h</a>.</dd></dl></dl></div>
    <div class="section"><dl><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgNavigationType">nsMsgNavigationType</a></dt><dd class="landingPageList">The <code>nsMsgNavigationType</code> interface contains constants used for message navigation in <a href="en/Thunderbird">Thunderbird</a>. For example to move forward a message, you would call:</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgSearchOpValue">nsMsgSearchOpValue</a></dt><dd class="landingPageList">Defined in <strong><a class=" external" href="http://mxr.mozilla.org/comm-central/source/">comm-central</a>/ <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/">mailnews</a>/ <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/">base</a>/ <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/">search</a>/ <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/">public</a>/ <a class=" external" href="http://mxr.mozilla.org/comm-central/source/mailnews/base/search/public/nsMsgSearchCore.idl">nsMsgSearchCore.idl</a> </strong></dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgViewCommandCheckState">nsMsgViewCommandCheckState</a></dt><dd class="landingPageList">The <code>nsMsgViewCommandCheckState</code> interface contains constants used for command status in <a href="en/Thunderbird">Thunderbird</a>. It is (as far as I can tell) not currently used anywhere in <a href="en/Thunderbird">Thunderbird</a>.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgViewCommandType">nsMsgViewCommandType</a></dt><dd class="landingPageList">The <code>nsMsgViewCommandType</code> interface contains constants used for commands in <a href="en/Thunderbird">Thunderbird</a>. For example to mark a message read, you would call:</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgViewFlagsType">nsMsgViewFlagsType</a></dt><dd class="landingPageList">The <code>nsMsgViewFlagsType</code> interface contains constants used for view flags in <a href="en/Thunderbird">Thunderbird</a>. This interface isn't ever implemented. It is only used to store constants. For example, the 'unread only' view would use the flag:</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgViewSortOrder">nsMsgViewSortOrder</a></dt><dd class="landingPageList">The <code>nsMsgViewSortOrder</code> interface contains constants used for sort direction in <a href="en/Thunderbird">Thunderbird</a>. This interface isn't ever implemented. It is only used to store constants. For example to sort by date you would pass a function the value:</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgViewSortType">nsMsgViewSortType</a></dt><dd class="landingPageList">The <code>nsMsgViewSortType</code> interface contains constants used for sorting the <a href="en/Thunderbird">Thunderbird</a> threadpane. This interface isn't ever implemented. It is only used to store constants. For example to sort by date you would pass a function the value:</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsMsgViewType">nsMsgViewType</a></dt><dd class="landingPageList">The <code>nsMsgViewType</code> interface contains constants used for views in <a href="en/Thunderbird">Thunderbird</a>. This interface isn't ever implemented. It is only used to store constants. For example, to request the 'show all threads' view use the constant:</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/nsStaticModuleInfo">nsStaticModuleInfo</a></dt><dd class="landingPageList">This data structure is used by <a href="en/NS_InitXPCOM3">NS_InitXPCOM3</a> to specify static XPCOM modules.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Components">Standard XPCOM components</a></dt><dd class="landingPageList">There are a number of components provided in the standard implementation of XPCOM; these are as follows.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Glue_classes">XPCOM glue classes</a></dt><dd class="landingPageList">These "glue" classes are provided to make it easier to use XPCOM from C++ code.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface">XPCOM Interface Reference</a></dt><dd class="landingPageList">This is a reference to the XPCOM interfaces provided by the Mozilla platform.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Reference_by_grouping">XPCOM Interface Reference by grouping</a></dt><dd class="landingPageList">This page lists the current (as of Dec. 01, 2010) list of Mozilla interfaces as listed on <a href="/en/XPCOM_Interface_Reference" title="en/XPCOM_Interface_Reference">the XPCom interface Reference Page</a> Where that page lists items by alphabetical sorting, this page attempts to group them by function. Grouping and category names were made by somewhat arbitrary decision by the author. (I'm fully aware that this will be a great point of discussion and probably will end in tears, but since I'm the first person to apparently take a swing at this, I get first dibs.)</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Primitive">XPCOM primitive</a></dt><dd class="landingPageList">An <b>XPCOM primitive</b> is an XPCOM object that "boxes" a value of a primitive type. All XPCOM primitives are scriptable, and they all implement an XPCOM interface from the table below.</dd><dt class="landingPageList"><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/String_functions">XPCOM string functions</a></dt><dd class="landingPageList">XPCOM provides these low-level string functions to let you work with strings; however, it's often better to use one of the string classes rather than directly using these functions.</dd></dl></div>
    </div><p></p>

<p>Many XPCOM pages return an <code><a href="/en-US/docs/Mozilla/Tech/XPCOM/Reference/Core_functions/nsresult">nsresult</a></code>. Prior to Gecko 19 (Firefox 19 / Thunderbird 19 / SeaMonkey 2.16), this was an integer that simply returned an error code. It is now a strongly typed <code>enum</code> when XPCOM is built using a C++11 compiler. This causes compile-time errors to occur when improper values are returned as nsresult values, thereby making it easier to catch many bugs.</p>