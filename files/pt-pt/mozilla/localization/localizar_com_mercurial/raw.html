<p>In Mozilla, we use the the <a href="../../../../en/Mercurial_basics" rel="internal">Mercurial</a> version control system (Hg) to manage our source code and localizations. Mercurial allows localizers to work locally (on their machines) and then <code style="font-size: 14px;">push</code> (an Hg term) changes to a remote repository, which usually is hosted on the Mozilla servers (<a class="external" href="http://hg.mozilla.org/" title="http://hg.mozilla.org/">hg.mozilla.org</a>). Localizing current versions of Firefox, Thunderbird and SeaMonkey includes working with Mercurial. If the documentation is incomplete or you have questions, please drop by the <a href="irc://irc.mozilla.org/l10n" title="irc://irc.mozilla.org/l10n">#l10n</a> or <a href="irc://irc.mozilla.org/hg" title="irc://irc.mozilla.org/hg">#hg</a> channels on irc.mozilla.org. The <a class="internal" href="/en/Mercurial_FAQ" title="En/Mercurial FAQ">Mercurial FAQ</a> are also worth a read, should you run into trouble.</p>

<p>For the eager and quick, below you'll find instructions on installing and configuring Mercurial, instructions on receiving an Hg account commit priviledges, as well as a few tasks you can complete without account priviledges.</p>

<h2 id="Instalar_Mercurial">Instalar Mercurial</h2>

<p>Follow the instructions below to install Mercurial on your system. Once you've installed Mercurial, we'll walk through the steps to <a href="/en/Mercurial_FAQ#Configuration" title="en/Mercurial FAQ#Configuration">configure</a> it.</p>

<h3 id="Mercurial_no_Linux">Mercurial no Linux</h3>

<p>You can easily install Mercurial from the command line by issuing one of the following commands. Choose the appropriate command for your distribution and make sure to run <em>as root</em>.</p>

<pre># Debian/ubuntu
$ apt-get install mercurial

# Fedora
$ yum install mercurial

# Gentoo
$ emerge mercurial

# Arch Linux
$ pacman -S mercurial

# OpenSolaris
$ pkg install SUNWmercurial
</pre>

<p>Se preferir uma interface gráfica, pode <a href="http://javaforge.com/project/HGE" title="http://javaforge.com/project/HGE">transferir e instalar o MercurialEclips e aqui</a>.</p>

<h4 id="Este_funcionou">Este funcionou?</h4>

<p>Open a Terminal window and enter <code>hg --version</code>. If you see a message about the version of Mercurial (e.g. <code>Mercurial Distributed SCM (version 1.3.1)</code>), you have installed Mercurial successfully!</p>

<h4 id="Mais_detalhes">Mais detalhes</h4>

<p>For more details on installing Hg on Linux systems, refer to the <a class="external" href="http://mercurial.selenic.com/downloads/" title="http://mercurial.selenic.com/downloads/">instructions on Mercurial's Download page</a>.</p>

<h3 id="Mercurial_no_Windows">Mercurial no Windows</h3>

<p>With Windows, you have a couple of install options:</p>

<ul>
 <li>For a <strong>command line interface</strong>, download and install {{ interwiki("wikimo", "MozillaBuild") }} package. This will not only install Hg, but also all the tools required to build Mozilla products on Windows. Trust us, you'll want this eventually.</li>
 <li><a href="/@api/deki/files/3863/=TortoiseHg.png" title="TortoiseHg.png"><img alt="TortoiseHg.png" class="internal rwrap" src="/@api/deki/files/3863/=TortoiseHg.png?size=thumb" style="float: right; height: 115px; width: 160px;"></a>For a <strong>graphical interface</strong>, you may want to <a class="external" href="http://tortoisehg.bitbucket.org/" title="http://tortoisehg.bitbucket.org/">install TortoiseHg</a>, which integrates with your Windows Explorer shell. It also installs the command line utility.</li>
</ul>

<p><a href="/@api/deki/files/3861/=Mercurial_Installer.png" title="Mercurial Installer.png"><img alt="Mercurial Installer.png" class="internal rwrap" src="/@api/deki/files/3861/=Mercurial_Installer.png?size=thumb" style="float: right; height: 125px; width: 160px;"></a>Part of the command line Hg install for Windows involves making sure the <code>hg </code>executable is in the system's <code>%PATH%</code> variable (TortoiseHg doesn't need this step). Use the <code>add_path.exe</code> utility found in <code>C:\mozilla-build\hg</code> to do this.</p>

<pre>PS C:\Users\your_id&gt; cd C:\mozilla-build\hg
PS C:\mozilla-build\hg&gt; .\add_path.exe /result .
</pre>

<p>Note the dot ("<code>.</code>") at the end of the second command, which means <em>the current directory</em>. If the utility modified your <code>%PATH%</code> successfully, a dialog will open saying, "<code><em>%PATH%</em></code><em> has been updated correctly</em>."</p>

<p>Alternatively, you can edit the <code>%PATH%</code> variable manually. In order to do so, right-click on your computer icon, choose <code>Properties &gt; Advanced &gt; Environmental Variables</code>, select <code>PATH </code>and click <code>Edit</code>. If you don't see <code>PATH</code> among the options, you'll have to click <code>Add</code> and edit it within the <strong>Add</strong> dialog. See the screenshot for an example.<a href="/@api/deki/files/3862/=PATH.jpg" title="PATH.jpg"><img alt="PATH.jpg" class="internal rwrap" src="/@api/deki/files/3862/=PATH.jpg?size=thumb" style="float: right; height: 71px; width: 160px;"></a></p>

<h4 id="Este_funcionou_2">Este funcionou?</h4>

<ol>
 <li>Go to <code>Start &gt; Run...</code></li>
 <li>Type <code>cmd.exe </code>and click <code>OK</code>. A new shell window should appear. </li>
 <li>Type <code>hg --version</code> in the new shell window. If you see a message about the version of Mercurial (e.g. <code>Mercurial Distributed SCM (version 1.3.1)</code>), you have installed Mercurial successfully!</li>
</ol>

<h4 id="Mais_detalhes_2" style="font-size: 14px;">Mais detalhes</h4>

<p>For more details on installing Hg on Windows, refer to the <a class="external" href="http://mercurial.selenic.com/downloads/" title="http://mercurial.selenic.com/downloads/">instructions on Mercurial's Download page</a>.</p>

<h3 id="Mercurial_no_Mac_OSX">Mercurial no Mac OSX</h3>

<p>Installing Hg on Mac OSX is super easy. You can install Mercurial via <a class="external" href="http://www.macports.org/" title="http://www.macports.org/">MacPorts</a> through the Terminal, like so:</p>

<p><code>$ sudo port install mercurial</code></p>

<p>You can also install it by downloading the dmg package from the <a href="http://mercurial.selenic.com/wiki/Download#Mac_OS_X" title="http://mercurial.selenic.com/wiki/Download#Mac_OS_X">Hg download page</a>. It has an install dialog that will walk you through the process.</p>

<p>If you prefer a graphical interface, you can <a href="http://javaforge.com/project/HGE" title="http://javaforge.com/project/HGE">download and install MercurialEclipse here</a>.</p>

<h4 id="Este_funcionou_3">Este funcionou?</h4>

<p>Open a Terminal window and type <code>hg --version</code>. If you see a message about the version of Mercurial (e.g. <code>Mercurial Distributed SCM (version 1.3.1)</code>), you have installed Mercurial successfully!</p>

<h4 id="Mais_detalhes_3" style="font-size: 14px;">Mais detalhes</h4>

<p>For more details on installing Hg on Mac OSX, refer to the <a class="external" href="http://mercurial.selenic.com/downloads/" title="http://mercurial.selenic.com/downloads/">instructions on Mercurial's Download page</a>.</p>

<h2 id="Configurar_o_Mercurial">Configurar o Mercurial</h2>

<p>Once you've installed Mercurial, you'll need to configure it before you can use it successfully.</p>

<p>Your Mercurial configuration is contained within a config file which you must create yourself. Your config file is called either <code style="font-size: 14px; color: rgb(51, 51, 51);">~/.hgrc</code> (UNIX systems) or <code style="font-size: 14px; color: rgb(51, 51, 51);">Mercurial.ini</code> (Windows), depending on your operating system.</p>

<p>Your config file should have the following settings:</p>

<pre class="eval">[ui]
username = Your Real Name &lt;<a class="link-mailto" href="mailto:user@example.com" rel="external" title="mailto:user@example.com">user@example.com</a>&gt;
merge = internal:merge

[defaults]
commit = -v

[diff]
git = 1
showfunc = 1
unified = 8</pre>

<p>To configure Hg, follow these steps:</p>

<ol>
 <li>Create a new file in your favorite text editor.</li>
 <li>Copy the settings above and paste them into your new file.</li>
 <li>Save the file as either <code>.hgrc</code> (UNIX systems) or <code>Mercurial.ini</code> (Windows) and save it in either <code>$HOME/</code> or <code>C:\mozilla-build\hg\</code> or <code>C:\Program Files\Mercurial\</code>.</li>
</ol>

<p>Now that you've installed and configured Mercurial, here are a few tasks you can do without Hg commit access priviledges.</p>

<h2 id="Clonar_e_atualizar_os_repositórios">Clonar e atualizar os repositórios</h2>

<p>There are a couple of repostiories that contain en-US source files that most locales will want to deal with.</p>

<ul>
 <li><a class="external" href="https://hg.mozilla.org/mozilla-central/" title="https://hg.mozilla.org/mozilla-central/">mozilla-central</a> contains the files for Firefox Nightly.</li>
 <li><a class="external" href="https://hg.mozilla.org/comm-central/" title="https://hg.mozilla.org/comm-central">comm-central</a> contains the files for SeaMonkey and Thunderbird which are not already part of Firefox.</li>
 <li><a href="https://hg.mozilla.org/l10n-central/" title="https://hg.mozilla.org/l10n-central/">l10n-central</a> contains all of the L10n repos for Firefox Nightly.</li>
</ul>

<div class="note">
<p>When you get the comm-central repository, this will include the mozilla-central repository as well. You can therefore use the one set up for developing Firefox, SeaMonkey and Thunderbird without having to pull mozilla-central a second time.</p>
</div>

<p>Here's how to get (or clone) your en-US source files for the first time:</p>

<ul>
 <li>Run the following command in the command line to get the source en-US files for Firefox:</li>
</ul>

<pre class="eval">hg clone https://hg.mozilla.org/mozilla-central/
</pre>

<p>This will create a clone of the mozilla-central repository in the directory mozilla-central.</p>

<ul>
 <li>Run the following commands in the command line to get the source en-US files for any combination of Firefox, SeaMonkey, Thunderbird:</li>
</ul>

<pre>hg clone https://hg.mozilla.org/comm-central/
cd comm-central
python client.py checkout
</pre>

<p>The first command will create a clone of the comm-central repository. The second command will move you into that directory. The third command will do a clone of mozilla-central, and pull some other hg repositories. The other directories are required for SeaMonkey and Thunderbird.</p>

<ul>
 <li>Cloning your localization repository for the first time is just as easy. For example, to clone your Firefox Nightly L10n repo, run the following command, replacing ab-CD with your locale code:</li>
</ul>

<pre class="eval" style="font-size: 14px;">hg clone https://hg.mozilla.org/l10n-central/ab-CD/</pre>

<h3 id="Atualizar_os_seus_repositórios_locais">Atualizar os seus repositórios locais</h3>

<ul>
 <li>To update your working copy of mozilla-central, go to your local mozilla-central directory and run:</li>
</ul>

<pre class="eval">hg pull -u
</pre>

<p>This will both get new changesets from mozilla-central and apply those changes in your working copy.</p>

<ul>
 <li>To update your working copy of comm-central, go to your comm-central directory and run:</li>
</ul>

<pre>python client.py checkout</pre>

<p>This will both get new changesets from comm-central, mozilla-central and the other appropriate locations and apply those changes in your working copy.</p>

<ul>
 <li>To update your local L10n repo after your first clone, run this command from your local L10n directory:</li>
</ul>

<pre style="font-size: 14px;">hg pull -u</pre>

<h2 id="Criar_correções_(patches)_de_L10n">Criar correções (patches) de L10n</h2>

<p>Another thing you can do with Hg without needing account priviledges is creating L10n patches of your work for someone else to commit to your remote L10n repo on the Mozilla servers. Doing this ensures that your dashboards are always accurate, as they look at your remote repo.</p>

<p>Here's how to create a L10n patch with Hg and the <a href="http://mercurial.selenic.com/wiki/MqExtension" title="http://mercurial.selenic.com/wiki/MqExtension">Mq extension</a>:</p>

<ol>
 <li>Enable Mq by adding <code>hg.ext = </code> to your Mercurial config file (<code>~/.hgrc</code> on Unix-like systems or <code>Mercurial.ini</code> on Windows) under the <code>[extensions]</code> section.</li>
 <li>Open your command line tool and navigate to your L10n directory.</li>
 <li>Inside your L10n directory, init your repo with Mq by running <code>hg init --mq</code>.</li>
 <li>To create a new patch, run <code>hg qnew -m "Your commit message" patch-name.patch</code>. The commit message should take the form of "Bug 123456 - Change this thing to work better by doing something; r=reviewers" if you are to fix a bug.</li>
 <li>Make your change.</li>
 <li>Once you finish making your change, run <code>hg qrefresh</code> to commit your changes to the patch.</li>
 <li>Navigate to your <code>&lt;repository&gt;/.hg/patches</code> to find your <code>.patch</code>.</li>
 <li>You may repeat from step 4 to create another patch. Your patches will be incremental, i.e. new patches are created based on old patches. If you want to commit all the patches to the repository and cleanup the patch queue, run <code>hg qfinish</code>.</li>
</ol>

<p>Please refer to <a href="http://mercurial.selenic.com/wiki/MqTutorial" title="http://mercurial.selenic.com/wiki/MqTutorial">MqTutorial</a> and <a href="http://mercurial.selenic.com/wiki/MqExtension" title="http://mercurial.selenic.com/wiki/MqExtension">Mq documentation</a> for further uses of Mq extension to manage patches.</p>

<h2 id="Privilégios_da_Conta_Mercurial">Privilégios da Conta Mercurial</h2>

<p>Eventually, you or your team leader will need Hg account priviledges. Let's face it, it's just more convenient to commit and push your work to the remote repo yourself, rather than creating patches and asking someone else to push them for you.</p>

<p>To get write access to the l10n hg repositories on the Mozilla server,<a class="external" href="http://www.mozilla.org/hacking/commit-access-policy/" title="http://www.mozilla.org/hacking/commit-access-policy/"> there's a bit of paper work to be done</a>. The localization team owner needs to <a class="link-https" href="https://bugzilla.mozilla.org/enter_bug.cgi?product=mozilla.org&amp;component=Repository%20Account%20Requests&amp;rep_platform=All&amp;op_sys=All&amp;cc=l10n%40mozilla.com&amp;short_desc=l10n%20hg%20account%20for%20John%20Doe%20(ab-CD)" title="https://bugzilla.mozilla.org/enter_bug.cgi?product=mozilla.org&amp;component=Repository%20Account%20Requests&amp;rep_platform=All&amp;op_sys=All&amp;cc=l10n%40mozilla.com&amp;short_desc=l10n%20hg%20account%20for%20John%20Doe%20(ab-CD)">file a bug requesting an hg account</a>. This bug will request level 1 L10n priviledges. You need to follow the instructions regarding the <a class="external" href="http://www.mozilla.org/hacking/committer/" title="http://www.mozilla.org/hacking/committer/">contributor form</a>. Write access to the hg repositories requires a ''voucher'', which, for the owner, will be done based on the review by Mozilla. For peers of a localization, the owner can vouch (once she or he is registered).</p>

<h2 id="Pull_your_locale" name="Pull_your_locale">Enviar alterações para a Mozilla</h2>

<p>Now that you have Hg account privileges, you can send your work to Mozilla all by yourself. Here are the steps to send your L10n work using Mercurial:</p>

<ol>
 <li>Since your L10n work takes place in your own local repository, you should ensure that there are no changes made to the remote repository before committing your work. To do this, <a href="https://developer.mozilla.org/en-US/docs/Localizing_with_Mercurial#Updating_your_local_repos" title="https://developer.mozilla.org/en-US/docs/Localizing_with_Mercurial#Updating_your_local_repos">update your locale, as per the section above</a>.</li>
 <li>After finishing a change or set of changes and checking you have updated to the latest, you should commit by entering this command:</li>
</ol>

<pre class="eval">hg commit -m "your message identifying the change (bug 555)"</pre>

<p>Committing won’t send your changes to Mozilla’s repository, but prepares them for it. The next step will send your changes to your remote repo via <code>push</code>.</p>

<ol start="3">
 <li>To push to mozilla-hosted repositories, you have to have committer access, and you must edit the file <code><em>(your-local-hg-root AKA the directory you pulled your locale into)</em>/.hg/hgrc</code> (note, this is <strong>NOT</strong> your <code>~/.hgrc</code>) to add these lines (replacing ab-CD with your locale code):</li>
</ol>

<pre class="eval">[paths]
default = https://hg.mozilla.org/l10n-central/ab-CD/
default-push = ssh://hg.mozilla.org/l10n-central/ab-CD/
</pre>

<ol start="4">
 <li>You’ll also need to tell ssh which account to use for your pushes, too, by editing <code>~/.ssh/config</code> and adding these lines, where <code style="font-size: 14px; color: rgb(51, 51, 51);">user@host.domain</code> is your account:</li>
</ol>

<pre>Host hg.mozilla.org
User user@host.domain
</pre>

<ol start="5">
 <li>Now you can push your work to the repository (and check the result on the dashboard) by entering this command from your local directory:</li>
</ol>

<pre class="eval">hg push</pre>

<p id="A_.mozconfig">And tah dah! You're done! Congratulations on finishing the tutorial. Take a break and grab a snack, you deserve it</p>