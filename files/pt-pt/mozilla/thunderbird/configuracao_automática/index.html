---
title: Configuração Automática no Thunderbird
slug: Mozilla/Thunderbird/Configuracao_automática
tags:
  - Administração
  - empresa
translation_of: Mozilla/Thunderbird/Autoconfiguration
---
<p>Autor: Ben Bucksch<br>
 Por favor, não altere este documento sem consultar o autor.</p>

<p>Thunderbird 3.1 and later (and 3.0 to some degree) includes mail account autoconfiguration functionality. The goal of autoconfiguration is to make it very easy for users to configure the connection of Thunderbird to their email servers. In many cases, people should be able to download and install Thunderbird, enter their real name, email address and password in the Account Setup Wizard and have a fully functioning mail client and get and send their mail as securely as possible.</p>

<p>Consulte também:</p>

<ul>
 <li>the <a href="https://wiki.mozilla.org/Thunderbird:Autoconfiguration" class="link-https">project page on the Mozilla wiki</a> for background, design, implementation and project details</li>
 <li>for instructions for users, see <a href="http://support.mozillamessaging.com/en-US/kb/Automatic-Account-Configuration" class="external">Automatic Account Configuration</a> on the Thunderbird Knowledge Base.</li>
 <li>the configuration file <a href="/en/Thunderbird/Autoconfiguration/FileFormat/HowTo">description</a> and <a href="https://wiki.mozilla.org/Thunderbird:Autoconfiguration:ConfigFileFormat">definition</a></li>
</ul>

<p>This document describes how Autoconfiguration in Thunderbird works, and what to do to allow mail servers to be autoconfigured.</p>

<h1 id="Mecanismos">Mecanismos</h1>

<p>Thunderbird gets the server settings via different means, each of which is intended for different cases:</p>

<ul>
 <li>ISPDB<br>
  The ISPDB is a central database, currently hosted by Mozilla Messaging, but free to use for any client. It contains settings for the world&apos;s largest ISPs. We hope that the database will soon have enough information to autoconfigure approximately 50% of our user&apos;s email accounts.<br>
  It was added merely because we cannot assume that all big ISPs (including Microsoft) will immediately set up a configuration server for Thunderbird.</li>
 <li>Configuration server at ISP<br>
  ISPs have the option to provide their configuration information themselves directly to users, by setting up a web server at autoconfig.&lt;domain&gt;, which simply returns a static XML file with the configuration, as described below. For more complicated setups, for example when the login name does not appear in the email address, the XML file can also be generated by the ISP. In such complicated cases, this is the only way to allow an automatic setup.</li>
 <li>Configuration file on harddisk<br>
  Administrators may place a configuration file in the Thunderbird installation folder. This is mainly intended for companies who install Thunderbird on their employees&apos; computers and want to enable easy account setup without having to set up a configuration server. This method is not practical for other use cases, because it is difficult to update the configuration file. Therefore, public ISPs should use a configuration server.</li>
 <li>Guessing<br>
  If all other mechanisms failed, Thunderbird tries to guess the configuration, by trying common server names like imap.&lt;domain&gt;, smtp.&lt;domain&gt;, mail.&lt;domain&gt; etc., and, when a mail server answers, checking whether it supports SSL, STARTTLS and encrypted passwords (CRAM-MD5).</li>
 <li>Manual configuration<br>
  If guessing fails the user must manually enter the configuration information. Users may also manually modify the account settings even if configuration information is successfully obtained by the methods described above.</li>
</ul>

<p>All the lookup mechanisms use the email address domain as base for the lookup. For example, for the email address <a href="mailto:fred@example.com" class="moz-txt-link-abbreviated link-mailto">fred@example.com</a> , the lookup is performed as (in this order):</p>

<ol>
 <li><em>tb-install-dir</em>/isp/example.com.xml on the harddisk</li>
 <li>check for autoconfig.example.com</li>
 <li>look up of &quot;example.com&quot; in the ISPDB</li>
 <li>look up &quot;MX example.com&quot; in DNS, and for mx1.mail.hoster.com, look up &quot;hoster.com&quot; in the ISPDB</li>
 <li>try to guess (imap.example.com, smtp.example.com etc.)</li>
</ol>

<p>We may add DNS SRV records as supported mechanism in the future, but we currently do not.</p>

<h1 id="Como_adicionar_suporte_para_o_seu_domínio">Como adicionar suporte para o seu domínio</h1>

<h2 id="Classificação">Classificação</h2>

<p>If you are a big ISP (&gt; 100,000 users) providing email addresses solely under a few domains like &quot;example.com&quot; and &quot;example.de&quot;, you may either submit the configuration to the ISPDB or set up a configuration server.<br>
 <br>
 If you support email aliases and the user&apos;s login name is not part of the email address (for example, users may have <a href="mailto:hero@example.com" class="moz-txt-link-rfc2396E link-mailto">&quot;hero@example.com&quot;</a> as email address, but the IMAP/POP/SMTP login name is neither &quot;hero&quot; nor <a href="mailto:hero@example.com" class="moz-txt-link-rfc2396E link-mailto">&quot;hero@example.com&quot;</a>, but &quot;u67578&quot;), you need to set up a configuration server, which does the email address -&gt; login name lookup.<br>
 <br>
 If you host customer domains, i.e. you are &quot;hoster.com&quot;, but your customers have <a href="mailto:fred@flintstone.com" class="moz-txt-link-rfc2396E link-mailto">&quot;fred@flintstone.com&quot;</a> and <a href="mailto:louis@kent.com" class="moz-txt-link-rfc2396E link-mailto">&quot;louis@kent.com&quot;</a> as domains, with only a few users per domain, you need to set up a configuration server (or rely on DNS MX).<br>
 <br>
 If you are a small company installing Thunderbird on your employees&apos; desktops, you can place a configuration file in the Thunderbird installation folder.</p>

<h2 id="ISPDB">ISPDB</h2>

<p>Database URL is <a href="https://live.mozillamessaging.com/autoconfig/v1.1/" class="moz-txt-link-rfc2396E link-https" title="https://live.mozillamessaging.com/autoconfig/v1.1/">&lt;https://live.mozillamessaging.com/autoconfig/v1.1/&gt;</a>, append domain name, e.g. <a href="https://live.mozillamessaging.com/autoconfig/v1.1/freenet.de" class="moz-txt-link-rfc2396E link-https" title="https://live.mozillamessaging.com/autoconfig/v1.1/freenet.de">&lt;https://live.mozillamessaging.com/autoconfig/v1.1/freenet.de&gt;</a>.<br>
 <br>
 Current process: File a bug in <a href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Webtools&amp;component=ISPDB%20Database%20Entries&amp;op_sys=All&amp;rep_platform=All" class="link-https">Bugzilla</a>, Product &quot;Webtools&quot;, Component &quot;ISPDB Database Entries&quot;, with a configuration file that matches the requirements described below.  The component is actively watched for new bugs (as of November 2015) so there is no need to request review on the file.</p>

<h2 id="Configuração_do_servidor_no_ISP">Configuração do servidor no ISP</h2>

<p>Given the email address <a href="mailto:fred@example.com" class="moz-txt-link-rfc2396E link-mailto">&quot;fred@example.com&quot;</a>, Thunderbird first checks &lt;<span class="external free"><a href="http://autoconfig.example.com/mail/config-v1.xml?emailaddress=fred@example.com" class="moz-txt-link-freetext external">http://autoconfig.example.com/mail/config-v1.1.xml?emailaddress=fred@example.com</a></span>&gt; and then <a href="http://example.com/.well-known/autoconfig/mail/config-v1.1.xml" class="moz-txt-link-rfc2396E external" title="http://example.com/.well-known/autoconfig/mail/config-v1.1.xml">&lt;http://example.com/.well-known/autoconfig/mail/config-v1.1.xml&gt;</a>.</p>

<h3 id="Empresa_pequena">Empresa pequena</h3>

<p>If you are a small company, you can put the XML configuration file on your web server, at URL <a href="http://example.com/.well-known/autoconfig/mail/config-v1.1.xml" class="moz-txt-link-rfc2396E external">&lt;http://example.com/.well-known/autoconfig/mail/config-v1.1.xml&gt;</a>. (This is not yet finalized and subject to change.)</p>

<h3 id="Hospedeiro_do_domínio">Hospedeiro do domínio</h3>

<p>If you are an ISP that hosts domains for your customers - for example, you are hoster.com and your customer registers fancy.com or example.com, and your servers accept and serve the mail for example.com -, you should set up an autoconfig server.</p>

<h4 id="DNS">DNS</h4>

<p>For each customer domain, you add a DNS record (in addition to the existing MX, A www etc. DNS records):<br>
 <code>autoconfig IN A 10.2.3.4</code><br>
 or<br>
 <code>autoconfig IN CNAME autoconfig.hoster.com</code>.<br>
 ... where 10.2.3.4 and autoconfig.hoster.com are IP addresses / hostnames you own.<br>
 This allows Thunderbird to find you as hoster.</p>

<p>To make the Version without an autoconfig DNS Entry work you have to make sure that example.com points to the Webserver you will place the config-v1.1.xml on.</p>

<p>Example: <span style="font-family: courier new,andale mono,monospace; line-height: normal;">example.com A 10.2.3.4</span></p>

<h4 id="Servidor_da_Web">Servidor da Web</h4>

<p>You set up a web server bound to a physical IP address. This may be on the same machine as other web servers, but the web server must be configured to the content to any requested domain.<br>
 <br>
 You must use a virtual host that match all autoconfig.* domains of your customers. In Apache terms, you can use a &quot;ip-based virtual host&quot;. In the Apache configuration files, that means something like: Listen 10.2.3.4:80 (of course, you use a public IP address that you own)</p>

<pre>&lt;VirtualHost 10.2.3.4:80&gt; #Must be the first and only virtual host with this ip!
    DocumentRoot /var/www/autoconfig/
    ServerName autoconfig.hoster.com
    &lt;Directory /var/www/autoconfig&gt;
	Order allow,deny
	allow from all
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;</pre>

<p>Place the configuration file at the URL /mail/config-v1.1.xml on that host.</p>

<p>All config files must be served as <code>Content-Type: text/xml</code> (or <code>application/xml</code>), otherwise the file will be ignored. Also, they must use charset UTF-8 (esp. if there are any non-ASCII-characters).</p>

<p>If you like to use name-based virtual hosts you probably don&apos;t want to setup the autoconfig subdomain for every domain of your customers.<br>
 You can add a Rewriterule in the default virtual host (on debian /etc/apache2/sites-enabled/000-default)  to match all autoconfig.* subdomains:</p>

<pre>&lt;VirtualHost *:80&gt; #Must be the first Virtual host
	ServerAdmin webmaster@hoster.com
	ServerName www
	DocumentRoot /var/www
	RewriteEngine On
	RewriteCond %{HTTP_HOST} ^autoconfig\. [NC]
	RewriteRule ^/(.*)	http://autoconfig.hoster.com/$1 [L,R=301,NE]
        #...
&lt;/VirtualHost&gt;
&lt;VirtualHost *:80&gt;
    DocumentRoot /var/www/autoconfig/
    ServerName autoconfig.hoster.com
    &lt;Directory /var/www/autoconfig&gt;
 	Order allow,deny
	allow from all
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre>

<p>If you use nginx, you can easily add a subdomain to all your Domains, which does the same as above. Either, you can redirect them to a common hostname:</p>

<pre>server {
	listen 10.2.3.4:80; #use your server&apos;s public IP here!
	server_name autoconfig.*;
	return 301 http://autoconfig.hoster.com$request_uri;
}
</pre>

<p>Or serve them directly from a common directory:</p>

<pre>server {
	listen 10.2.3.4:80; #again, use your server&apos;s public IP here!
	server_name autoconfig.*;
	location / {
		root /var/www/autoconfig;
	}
}
</pre>

<p> </p>

<h2 id="Ficheiro_de_configuração">Ficheiro de configuração</h2>

<p>Isto é descrito em <a href="/pt-PT/docs/Mozilla/Thunderbird/Autoconfiguration/FileFormat/Como" title="en/Thunderbird/Autoconfiguration/FileFormat/HowTo">Como criar um ficheiro de configuração</a> e <a href="/pt-PT/docs/Mozilla/Thunderbird/Autoconfiguration/FileFormat/Definicao" title="en/Thunderbird/Autoconfiguration/FileFormat/Definition">definido</a> nas sub páginas.</p>
